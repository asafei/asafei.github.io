<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>afei_ask</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="afei_ask">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="afei_ask">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="afei_ask">
  
    <link rel="alternate" href="/atom.xml" title="afei_ask" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">afei_ask</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-react-router-dom入门到深入" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/02/react-router-dom入门到深入/" class="article-date">
  <time datetime="2020-04-02T15:30:06.000Z" itemprop="datePublished">2020-04-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/04/02/react-router-dom入门到深入/">react-router-dom入门到深入</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="React-router-dom"><a href="#React-router-dom" class="headerlink" title="React-router-dom"></a>React-router-dom</h3><h4 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-router-dom -save-d</span><br></pre></td></tr></table></figure>
<h4 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h4><p>创建A和B两个页面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;div&gt;A&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/B.js</span></span><br><span class="line"><span class="regexp">import React from 'react';</span></span><br><span class="line"><span class="regexp">function B()&#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">    	&lt;div&gt;B&lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建一个路由文件router.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;HashRouter, Route, Switch&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">'./a'</span>;</span><br><span class="line"><span class="keyword">import</span> B <span class="keyword">from</span> <span class="string">'./b'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TestRouter=<span class="function"><span class="params">()</span>=&gt;</span>(</span><br><span class="line">	&lt;HashRouter&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/"</span> component=&#123;A&#125;/&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/b"</span> component=&#123;B&#125;/&gt;</span><br><span class="line">        &lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>HashRouter&gt;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">export</span> &#123;TestRouter&#125;;</span><br></pre></td></tr></table></figure>
<p>最后在组件的渲染页面，渲染该路由即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;TestRouter&#125; <span class="keyword">from</span> <span class="string">'./router/router'</span>;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Router/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>此时在页面输入<code>http://localhost:3000/#/</code>就会看到A页面，输入<code>http://localhost:3000/#/b</code>就会看到B页面。url中的#号目前暂不考虑</p>
<h4 id="三、路由的跳转"><a href="#三、路由的跳转" class="headerlink" title="三、路由的跳转"></a>三、路由的跳转</h4><h5 id="3-1-a标签"><a href="#3-1-a标签" class="headerlink" title="3.1 a标签"></a>3.1 a标签</h5><p>可以通过a标签进行页面的跳转，如下修改A页面就可以通过点击A页面中的A</p>
<p>来实现跳转到B页面了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;div&gt;</span><br><span class="line">        &lt;a href=<span class="string">'#/b'</span> &gt;A&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-2-通过Link标签跳转"><a href="#3-2-通过Link标签跳转" class="headerlink" title="3.2 通过Link标签跳转"></a>3.2 通过Link标签跳转</h5><p>react-router-dom中提供了Link标签也可以提供页面的跳转，Link的底层还是使用的a标签。</p>
<p>如下面修改B页面，就可以实现点击B跳到A页面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//B.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;div&gt;</span><br><span class="line">        &lt;Link to=<span class="string">'#/'</span>&gt;B&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-3-通过函数跳转"><a href="#3-3-通过函数跳转" class="headerlink" title="3.3 通过函数跳转"></a>3.3 通过函数跳转</h5><p>react-router-dom中提供了<code>hashHistory</code>，设置给组件的<code>history</code>属性，然后同过改变<code>this.props.history</code>参数，用来实现页面的跳转.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在router.js文件中给 HashRouter引入history属性</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">import</span> &#123;HashRouter, Route, Switch, hashHistory&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</span><br><span class="line">...</span><br><span class="line">&lt;HashRouter history=&#123;hashHistory&#125;&gt;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">//A.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;div&gt;</span><br><span class="line">        &lt;a href=<span class="string">'#/b'</span> &gt;A&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">        &lt;button onClick=&#123;() =&gt; props.history.push('b')&#125;&gt;test&lt;/</span>button&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这样点击test按钮就可以使用向B页面的跳转了</p>
<p>其中改变<code>this.props.history</code>参数的方法有：</p>
<ul>
<li>push() ：添加新的路由</li>
<li>replace()：替换路由（猜测是替换当前路由，被替换的路由则不能通过goBack返回，防止死循环）</li>
<li>goBack()：返回上一个路由（返回上级页面）</li>
</ul>
<h4 id="四、路由传参"><a href="#四、路由传参" class="headerlink" title="四、路由传参"></a>四、路由传参</h4><h5 id="4-1-通过路由配置传参"><a href="#4-1-通过路由配置传参" class="headerlink" title="4.1 通过路由配置传参"></a>4.1 通过路由配置传参</h5><p>在上面router.js文件中，我们只是配置了路由的绝对路径，有些时候我们在跳转某个路由时还要接收一些参数，该怎么处理呢？简单的可以通过在路由后追加’/:key’，然后再路由对应的组件通过<code>this.props.match.params.key</code>来接收到相应的参数值</p>
<p>如下，我们给B页面传递<code>name</code>参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//router.js</span></span><br><span class="line"><span class="keyword">const</span> TestRouter=<span class="function"><span class="params">()</span>=&gt;</span>(</span><br><span class="line">	&lt;HashRouter&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/"</span> component=&#123;A&#125;/&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/b/:name"</span> component=&#123;B&#125;/&gt;</span><br><span class="line">        &lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>HashRouter&gt;</span><br><span class="line">);</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">//B.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;div&gt;</span><br><span class="line">        	B</span><br><span class="line">        	&lt;p&gt;我接收的参数是&#123;props.match.params.name&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然如果传递多个参数就再追加即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route exact path=<span class="string">"/b/:name/:age"</span> component=&#123;B&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>这样皆可以通过<code>http://localhost:3000/#/b/afei/21</code>来访问到afei和age了，</p>
<p>这种方式虽然可以实现传参，但是稍微少传一个参数就会报错。</p>
<p>如果是使用Link标签如何传参呢，很简单使用query关键 字即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//B.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;div&gt;</span><br><span class="line">        &lt;Link to=&#123;<span class="attr">path</span>:<span class="string">'/a'</span>,<span class="attr">query</span>:&#123;<span class="attr">name</span>:<span class="string">'afei'</span>,<span class="attr">age</span>:<span class="number">19</span>&#125;&#125;&gt;B&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并且总觉得的不如<code>http://localhost:3000/#/b?name=afei&amp;age=19</code>来的方便。（日后补上）</p>
<h5 id="4-2-通过函数隐式传参"><a href="#4-2-通过函数隐式传参" class="headerlink" title="4.2 通过函数隐式传参"></a>4.2 通过函数隐式传参</h5><p>那如果是通过函数跳转是，如何传参呢？很简单,在触发时给history传递对象，然后再对应的页面通过<code>this.props.history.location.state</code>获取即可，如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A.js</span></span><br><span class="line">&lt;button onClick=&#123;() =&gt; props.history.push(</span><br><span class="line">    &#123;</span><br><span class="line">    pathname:<span class="string">'/b'</span>,</span><br><span class="line">    state:&#123;</span><br><span class="line">        name:<span class="string">'afei'</span>,</span><br><span class="line">    	age:<span class="number">18</span></span><br><span class="line">    	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">)&#125;&gt;test&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/B.js</span></span><br><span class="line"><span class="regexp">import React from 'react';</span></span><br><span class="line"><span class="regexp">function B(props)&#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">    	&lt;div&gt;</span></span><br><span class="line"><span class="regexp">        	B</span></span><br><span class="line"><span class="regexp">        	&lt;p&gt;我的名字是&#123;props.history.location.state.name&#125;&lt;/</span>p&gt;</span><br><span class="line">			&lt;p&gt;我的年龄是&#123;props.history.location.state.age&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意上边两种方式传参和接参方式不能混了</p>
<h4 id="五、BrowserRouter和hashRouter"><a href="#五、BrowserRouter和hashRouter" class="headerlink" title="五、BrowserRouter和hashRouter"></a>五、BrowserRouter和hashRouter</h4><p>有一个现象当我们的router.js使用HashRouter时，我们可以通过浏览器地址栏直接键入url来访问任意路由</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//HashRouter</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;HashRouter, Route, Switch&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">'./a'</span>;</span><br><span class="line"><span class="keyword">import</span> B <span class="keyword">from</span> <span class="string">'./b'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> TestRouter=<span class="function"><span class="params">()</span>=&gt;</span>(</span><br><span class="line">	&lt;HashRouter&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/"</span> component=&#123;A&#125;/&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/b"</span> component=&#123;B&#125;/&gt;</span><br><span class="line">        &lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>HashRouter&gt;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">export</span> &#123;TestRouter&#125;;</span><br></pre></td></tr></table></figure>
<p>此时</p>
<ul>
<li>当我们可以输入<code>http://localhost:3000/</code>时，地址栏会自动变为<code>http://localhost:3000/#/</code>进行正常访问；</li>
<li><p>当地址栏输入<code>http://localhost:3000/#/</code>可以正常访问A页面</p>
</li>
<li><p>当地址栏输入<code>http://localhost:3000/#/b</code>可以正常访问B页面</p>
</li>
</ul>
<p>但是当我们的router.js中将HashRouter换成BrowserRouter时，就会出现意外。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">&lt;BrowserRouter&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/"</span> component=&#123;A&#125;/&gt;</span><br><span class="line">            &lt;Route exact path=<span class="string">"/b"</span> component=&#123;B&#125;/&gt;</span><br><span class="line">        &lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>BrowserRouter&gt;</span><br></pre></td></tr></table></figure>
<p>表现为：</p>
<ul>
<li>当我们可以输入<code>http://localhost:3000/</code>时，可以正常访问A页面</li>
<li>当地址栏输入<code>http://localhost:3000/b</code>不能正常访问B页面，报错<code>Cannot GET/b</code></li>
<li>当我们在A页面以<code>&lt;Link to=&quot;b&quot;&gt;B&lt;/Link&gt;</code>的形式，可以正常访问B页面</li>
</ul>
<p>神不神奇，为什么HashRouter可以直接访问路由，而BrowserRouter访问不到？</p>
<p>这是应为BrowserRouter每次改变路由时，会向服务器请求该路由，服务端没有该路径的资源，自然会报错了。当然可以开启一个服务，路由对应的路径下放置资源文件，此错误就会消失。</p>
<p>而使用HashRouter时，会在路径后边添加<code>/#/</code>,并且<code>/#/</code>及后边的内容是不会发送给服务器的，当访问<code>http://localhost:3000/#/b</code>时，其实服务器端收到的依然是<code>http://localhost:3000</code>，<code>/#/</code>及后边的内容</p>
<p>会直接在前端进行处理区分。</p>
<p>但是官方却还是推荐我们使用BrowserRouter，这就和它们内部的机制有关了</p>
<ul>
<li>BrowserRouter使用的是HTML5中的history的api，通过<code>pushState</code>、<code>replaceState</code>、<code>popState</code>来完成UI和URL的同步</li>
<li>HashRouter使用的是URL的hash方式，来完成UI和URL的同步</li>
</ul>
<p>下章细讲</p>
<h4 id="六、history和URL"><a href="#六、history和URL" class="headerlink" title="六、history和URL"></a>六、history和URL</h4><p>下面的内容只做了解</p>
<h5 id="6-1-history"><a href="#6-1-history" class="headerlink" title="6.1 history"></a>6.1 history</h5><p>history接口允许操作浏览器的曾经在标签页或者框架里访问会话历史记录。它有一些自己的属性，这里是说一下比较重要的<code>History.state</code>和<code>History.length</code></p>
<ul>
<li><code>state</code>是一个只读属性，访问该属性会返回一个表示历史堆栈顶部的状态的值。它可以不必等待<code>popstate</code>事件而查看状态的方式</li>
<li><code>length</code>是一个只读属性，表示会话历史中元素的数目，包括当前的加载页。</li>
</ul>
<p>下面来看history中三个比较重要的方法</p>
<ul>
<li>pushState()：按指定的名称和URL（如果提供该参数）将数据push进会话历史栈，这个数据被DOM 进行了不透明处理。可以理解为往历史记录里追加新的页面</li>
<li>replaveState()：按指定的数据，名称和URL(如果提供该参数)，更新历史栈上最新的入口。这个数据被DOM 进行了不透明处理。可以理解更新历史记录里当前页面信息</li>
<li>popState()：很奇怪，没有查到该方法</li>
<li>back()：往上一页，模拟浏览器左上角的撤销功能</li>
<li>forward()：往下一页，模拟浏览器左上角的下一页功能</li>
<li>go()：通过当前页面的相对位置从浏览器历史记录( 会话记录 )加载页面。比如：参数为-1的时候为上一页，参数为1的时候为下一页。参数超过区间范围（length区间）或不合法时不做任何操作</li>
</ul>
<p>总的来说可以将history看作是维护浏览器历史记录的管理器。</p>
<h5 id="6-2-URL"><a href="#6-2-URL" class="headerlink" title="6.2 URL"></a>6.2 URL</h5><p><strong>URL</strong> 接口是一个包含若干静态方法的对象，用来创建 URLs。它的属性主要是实现<em>URLUtils</em> 中定义的属性，包括：</p>
<ul>
<li>href：包含完整URL的字符串</li>
<li>host：包含URL域名+“ : ”+端口号的字符串</li>
<li>Hostname：包含URL域名的字符串</li>
<li>port：包含URL端口号的字符串</li>
<li>pathname：以<code>/</code>起头紧跟URL文件路径的字符串</li>
<li>search：以<code>？</code>起头紧跟URL文件路径的字符串</li>
<li>hash：以<code>#</code>起头紧跟URL文件路径的字符串</li>
<li>username：包含在域名前面指定的用户名字符串</li>
<li>password：包含在域名前面指定的密码字符串</li>
<li><p>origin：只读属性，返回一个包含协议名、域名和端口号的字符串</p>
</li>
<li><p>searchParams：返回一个用来访问当前URL GET请求参数的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/URLSearchParams" target="_blank" rel="noopener"><code>URLSearchParams</code></a> 对象。</p>
</li>
</ul>
<p>URL还有一些静态方法，不再赘述。这里只需要明白所谓的<code>#</code>是URL的hash属性的规范，就跟seacrh的<code>?</code>一样。</p>
<p>参考:</p>
<p><a href="https://www.jianshu.com/p/8954e9fb0c7e" target="_blank" rel="noopener">https://www.jianshu.com/p/8954e9fb0c7e</a></p>
<p><a href="https://reacttraining.com/react-router/web/api/BrowserRouter" target="_blank" rel="noopener">https://reacttraining.com/react-router/web/api/BrowserRouter</a></p>
<p><a href="https://www.cnblogs.com/soyxiaobi/p/11096940.html" target="_blank" rel="noopener">https://www.cnblogs.com/soyxiaobi/p/11096940.html</a></p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/History" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/History</a></p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/URL" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/URL</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/04/02/react-router-dom入门到深入/" data-id="ck8iwvq0j0035nso14r6nlpmd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-React高阶组件笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/02/React高阶组件笔记/" class="article-date">
  <time datetime="2020-04-02T15:25:34.000Z" itemprop="datePublished">2020-04-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/04/02/React高阶组件笔记/">React高阶组件笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、高阶组件的概念"><a href="#一、高阶组件的概念" class="headerlink" title="一、高阶组件的概念"></a>一、高阶组件的概念</h3><ul>
<li>高阶组件就是接收一个组件作为参数并返回一个数组</li>
<li>高阶组件是一个函数，并不是组件</li>
</ul>
<h3 id="二、为什么需要高阶组件"><a href="#二、为什么需要高阶组件" class="headerlink" title="二、为什么需要高阶组件"></a>二、为什么需要高阶组件</h3><ul>
<li>多个组件都需要某个相同的功能，使用高阶组件减少重复实现</li>
</ul>
<h3 id="三、高阶组件示例"><a href="#三、高阶组件示例" class="headerlink" title="三、高阶组件示例"></a>三、高阶组件示例</h3><ul>
<li>react-redux中的connnect</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(Header);</span><br></pre></td></tr></table></figure>
<h3 id="四、编写高阶组件"><a href="#四、编写高阶组件" class="headerlink" title="四、编写高阶组件"></a>四、编写高阶组件</h3><ul>
<li>实现一个普通组件</li>
<li>将普通组件使用函数包裹</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="comment">//接收一个入参，参数就是一个组件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params">WrappedComponent</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">        render()&#123;</span><br><span class="line">            <span class="keyword">return</span> (</span><br><span class="line">            	&lt;div&gt;</span><br><span class="line">                	&lt;WrappedComponent /&gt;</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">            );</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default d;</span></span><br></pre></td></tr></table></figure>
<h3 id="五、使用高阶组件"><a href="#五、使用高阶组件" class="headerlink" title="五、使用高阶组件"></a>五、使用高阶组件</h3><ul>
<li><p>higherOrderComponent(WrappedComponent);</p>
</li>
<li><p>@higherOrderComponent. 装饰器模式</p>
<blockquote>
<p>1、运行命令：react-scripts reject  中途选yes</p>
<p>2、安装依赖：npm install -D babel-preset-stage-2</p>
<p>​            npm install -D babel-preset-react-native-stage-0</p>
<p>3、添加.babelrc的文件</p>
<p>​    {</p>
<p>​        “presets”:[“react-native-stage-0/decorator-support”]</p>
<p>​    }</p>
<p>此时我们的被装饰者可以这么写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line">&gt; <span class="keyword">import</span> d <span class="keyword">from</span> <span class="string">'./D'</span>;</span><br><span class="line">&gt; </span><br><span class="line">&gt; @d</span><br><span class="line">&gt; <span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">&gt;     render()&#123;</span><br><span class="line">&gt;         <span class="keyword">return</span> (</span><br><span class="line">&gt;         	<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">&gt;             	//...</span></span><br><span class="line"><span class="xml">&gt;             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&gt;         );</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
</li>
</ul>
<h3 id="六、高阶组件的应用"><a href="#六、高阶组件的应用" class="headerlink" title="六、高阶组件的应用"></a>六、高阶组件的应用</h3><ul>
<li><p>代理方式的高阶组件</p>
<blockquote>
<p>返回的新组件类直接继承自React.Component类，新组件扮演的角色传入参数组件的一个代理，在新组件的render函数中，将被包裹组件渲染出来，除了高阶组件自己要做的工作，其余功能全都转手给了被包裹的组件</p>
</blockquote>
</li>
<li><p>继承方式的高阶组件</p>
<blockquote>
<p>采用继承关联作为参数的组件和返回组件，加入传入的组件参数是WrappedComponent，那么返回的组件就直接继承自WrappedComponent</p>
</blockquote>
</li>
<li><p>高阶组件显示名</p>
<blockquote>
<p>在使用高阶组件时，有时候不好调试，并不知道最终渲染的是哪一个子组件，这时候就需要使用displayName了，可组件内部可以定义该静态变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">static</span> displayName=<span class="string">`newComponent<span class="subst">$&#123;getDisplayName(WrappedComponent)&#125;</span>`</span>;<span class="comment">//getDisplayName()是在外部自定义的</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
</li>
</ul>
<h4 id="6-1-代理方式的高阶组件"><a href="#6-1-代理方式的高阶组件" class="headerlink" title="6.1 代理方式的高阶组件"></a>6.1 代理方式的高阶组件</h4><ul>
<li>操纵prop.       可以增加、删除属性</li>
<li>抽取状态 </li>
<li>访问ref</li>
<li>包装组件</li>
</ul>
<h3 id="七、实战"><a href="#七、实战" class="headerlink" title="七、实战"></a>七、实战</h3><h4 id="7-1-初始化工程"><a href="#7-1-初始化工程" class="headerlink" title="7.1 初始化工程"></a>7.1 初始化工程</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create-react-app tabbar</span><br><span class="line"><span class="comment">//若未安装create-react-app，可以使用</span></span><br><span class="line">npx create-react-app tabbar</span><br></pre></td></tr></table></figure>
<p>在<code>src</code>文件夹下新建<code>components</code>的文件夹，用来放置组件类；</p>
<p>在<code>components</code>的文件夹下，新建<code>tabbar</code>的文件夹；</p>
<p>然后在<code>tabbar</code>文件夹下新建<code>index.js</code>的文件，作为开发的主文件，同时在<code>tabbar</code>文件夹下新建一个样式文件<code>index.css</code>；</p>
<p>并且在App.js中引入Tarbar组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tarbar</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div className=<span class="string">'tarbar'</span>&gt;</span><br><span class="line">            	<span class="number">123</span></span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/index.css</span></span><br><span class="line"><span class="regexp">.tarbar&#123;</span></span><br><span class="line"><span class="regexp">    height:50px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/App.js</span></span><br><span class="line"><span class="regexp">import React ,&#123;Component&#125; from 'react';</span></span><br><span class="line"><span class="regexp">import Tabbar from './</span>component/tarbar<span class="string">';</span></span><br><span class="line"><span class="string">class Tarbar extends Component&#123;</span></span><br><span class="line"><span class="string">    render()&#123;</span></span><br><span class="line"><span class="string">        return (</span></span><br><span class="line"><span class="string">        	&lt;div className='</span>App<span class="string">'&gt;</span></span><br><span class="line"><span class="string">            	&lt;Tarbar /&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="7-2使用iconfont"><a href="#7-2使用iconfont" class="headerlink" title="7.2使用iconfont"></a>7.2使用iconfont</h4><p>进入阿里巴巴矢量图标库，下载四个我们需要的图标（home、car、category、user）。添加项目-下载到本地-解压，然后将里面iconfont开头的文件拷出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">iconfont.css</span><br><span class="line">iconfont.eot</span><br><span class="line">iconfont.js</span><br><span class="line">iconfont.svg</span><br><span class="line">iconfont.ttf</span><br><span class="line">iconfont.woff</span><br></pre></td></tr></table></figure>
<p>在<code>src</code>文件夹下新建<code>static</code>的文件夹，用来放置所有的静态文件，将上面的iconfont的文件放进来。</p>
<p>然后在App.js文件中引入iconfont</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.js</span></span><br><span class="line"><span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Tabbar <span class="keyword">from</span> <span class="string">'./component/tarbar'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./static/iconfont.css'</span>;<span class="comment">//引入iconfont</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tarbar</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div className=<span class="string">'App'</span>&gt;</span><br><span class="line">            	&lt;Tarbar /&gt;</span><br><span class="line">            	&lt;div className=<span class="string">'iconfont iconfont-home'</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>经完善后，APP.js的文件为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.js</span></span><br><span class="line"><span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Tabbar <span class="keyword">from</span> <span class="string">'./component/tarbar'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./static/iconfont.css'</span>;<span class="comment">//引入iconfont</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tabbar=&#123;</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-home'</span>,<span class="attr">text</span>:<span class="string">'首页'</span>&#125;，</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-fenlei'</span>,<span class="attr">text</span>:<span class="string">'分类'</span>&#125;，</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-gouwuche'</span>,<span class="attr">text</span>:<span class="string">'购物车'</span>&#125;，</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-user'</span>,<span class="attr">text</span>:<span class="string">'我的'</span>&#125;，</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tarbar</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div className=<span class="string">'tabbar'</span>&gt;</span><br><span class="line">            	&lt;div className=<span class="string">'tabbar-content'</span>&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        tabbar.map(<span class="function">(<span class="params">v,i</span>)=&gt;</span>&#123;</span><br><span class="line">                            &lt;div key=&#123;i&#125; className=<span class="string">'tabbar-item'</span>&gt;</span><br><span class="line">                                &lt;div className=&#123;<span class="string">'iconfont '</span>+v.img&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">                                &lt;div&gt;&#123;v.text&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                            &lt;/</span>div&gt;</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">    			&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来index.css文件中添加样式文件</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="selector-class">.iconfont</span>&#123;</span><br><span class="line">    font-size:28px !important;//!important强制生效</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tarbar</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">position</span>:absolute;</span><br><span class="line">    <span class="attribute">bottom</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">5px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabbar-content</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tabbar-item</span>&#123;</span><br><span class="line">    flex:1;//每个元素的区间是均分的</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7-4-添加事件"><a href="#7-4-添加事件" class="headerlink" title="7.4 添加事件"></a>7.4 添加事件</h4><p>需要给tabbar-item添加点击切换事件，图标响应不同颜色。思路：通过点击事件-改变state-实时更新样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Tabbar</span></span><br><span class="line">...</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tarbar</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state=&#123;</span><br><span class="line">            index:<span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    itemChange=<span class="function">(<span class="params">i</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">index</span>:i&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div className=<span class="string">'tabbar'</span>&gt;</span><br><span class="line">            	&lt;div className=<span class="string">'tabbar-content'</span>&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        tabbar.map(<span class="function">(<span class="params">v,i</span>)=&gt;</span>&#123;</span><br><span class="line">                            &lt;div key=&#123;i&#125; className=&#123;<span class="string">'tabbar-item'</span>+ <span class="keyword">this</span>.state.index===i?<span class="string">'active:'</span><span class="string">' &#125; onClick=&#123;()=&gt;this.itemChange(i)&#125;&gt;</span></span><br><span class="line"><span class="string">                                &lt;div className=&#123;'</span>iconfont <span class="string">'+v.img&#125;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                                &lt;div&gt;&#123;v.text&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                            &lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &#125;);</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">    			&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//在index.css中给active添加样式</span></span><br><span class="line"><span class="string">    .active&#123;</span></span><br><span class="line"><span class="string">        color:red;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="7-5-添加路由"><a href="#7-5-添加路由" class="headerlink" title="7.5 添加路由"></a>7.5 添加路由</h4><p>安装包</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install -S react-router-dom</span><br></pre></td></tr></table></figure>
<p>在src 目录下新建文件<code>router.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;BrowserRouter,Route,Switch&#125; <span class="keyword">from</span> <span class="string">'react-router-dom '</span>;</span><br><span class="line"><span class="comment">//下面四个页面在src目录的pages的页面</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">"./pages/home"</span>;</span><br><span class="line"><span class="keyword">import</span> Category <span class="keyword">from</span> <span class="string">"./pages/category"</span>;</span><br><span class="line"><span class="keyword">import</span> Car <span class="keyword">from</span> <span class="string">"./pages/car"</span>;</span><br><span class="line"><span class="keyword">import</span> User <span class="keyword">from</span> <span class="string">"./pages/user"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;(</span><br><span class="line">	&lt;BrowserRouter&gt;</span><br><span class="line">    	&lt;Switch&gt;</span><br><span class="line">    		&lt;Route path=<span class="string">'/home'</span> component=&#123;Home&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">			&lt;Route path=<span class="string">'/category'</span> component=&#123;Category&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">			&lt;Route path=<span class="string">'/car'</span> component=&#123;Car&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">			&lt;Route path=<span class="string">'/user'</span> component=&#123;User&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">    	&lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>BrowserRouter&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>然后在App.js中将router.js导入即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.js</span></span><br><span class="line"><span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Tabbar <span class="keyword">from</span> <span class="string">'./component/tarbar'</span>;</span><br><span class="line"><span class="keyword">import</span> RouterMap <span class="keyword">from</span> <span class="string">'./router'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tarbar</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div className=<span class="string">'App'</span>&gt;</span><br><span class="line">            	&lt;RouterMap /&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这样当我们在浏览器输入<code>localhost:3030/home</code>时就显示的Home页面 </p>
<h4 id="7-6-Tabbar路由的切换"><a href="#7-6-Tabbar路由的切换" class="headerlink" title="7.6 Tabbar路由的切换"></a>7.6 Tabbar路由的切换</h4><p>接下来我们需要在Home、Car、Category、User中引入Tabbar</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Tabbar <span class="keyword">from</span> <span class="string">'./component/tarbar'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;Tabbar /&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>为了方便，将Home等组件内容用一张图片代替</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React ,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Tabbar <span class="keyword">from</span> <span class="string">'./component/tarbar'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;img className=<span class="string">'bg'</span> src=&#123;<span class="built_in">require</span>(<span class="string">'../static/imgs/home.png'</span>)&#125; /&gt;</span><br><span class="line">            	&lt;Tabbar /&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default Home;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/在APP.css中添加样式</span></span><br><span class="line"><span class="regexp">    .bg&#123;</span></span><br><span class="line"><span class="regexp">        width:100%;</span></span><br><span class="line"><span class="regexp">        height:100%;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br></pre></td></tr></table></figure>
<p>此时我们点击下面四个按钮，只是按钮 变红，实际上我们想让我们的路由改变，展示不同的页面；</p>
<p>我们需要修改Tabbar各item的点击事件，可以先将数据写进tabbar数据中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tabbar=&#123;</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-home'</span>,<span class="attr">text</span>:<span class="string">'首页'</span>,<span class="attr">link</span>:<span class="string">'/home'</span>&#125;，</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-fenlei'</span>,<span class="attr">text</span>:<span class="string">'分类'</span>,<span class="attr">link</span>:<span class="string">'/category'</span>&#125;，</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-gouwuche'</span>,<span class="attr">text</span>:<span class="string">'购物车'</span>,<span class="attr">link</span>:<span class="string">'/car'</span>&#125;，</span><br><span class="line">    &#123;<span class="attr">img</span>:<span class="string">'icon-user'</span>,<span class="attr">text</span>:<span class="string">'我的'</span>,<span class="attr">link</span>:<span class="string">'/user'</span>&#125;，</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样在跳转的时候我们就知道是哪一个路由了，为了简单也不可以不用点击事件，用link标签来做；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Link&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</span><br><span class="line"></span><br><span class="line">			&lt;div className=<span class="string">'tabbar-content'</span>&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        tabbar.map(<span class="function">(<span class="params">v,i</span>)=&gt;</span>&#123;</span><br><span class="line">                            &lt;Link to=&#123;v.link&#125; key=&#123;i&#125; className=&#123;<span class="string">'tabbar-item'</span>+ <span class="keyword">this</span>.state.index===i?<span class="string">'active:'</span><span class="string">' &#125;&gt;</span></span><br><span class="line"><span class="string">                                &lt;div className=&#123;'</span>iconfont <span class="string">'+v.img&#125;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                                &lt;div&gt;&#123;v.text&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                            &lt;/Link&gt;</span></span><br><span class="line"><span class="string">                        &#125;);</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">    			&lt;/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>这是link标签又默认样式，需要去掉默认样式，</p>
<p>在App.css中给a标签编写样式</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,<span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>,<span class="selector-tag">a</span><span class="selector-pseudo">:link</span>,<span class="selector-tag">a</span><span class="selector-pseudo">:active</span>&#123;</span><br><span class="line">    text-decoration:none;//去掉下划线</span><br><span class="line">    <span class="selector-tag">color</span>:<span class="selector-id">#333</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后还需要给tabbar添加背景颜色，并且发现在点击不同选项时颜色不改变了。这是因为之前我们是根据数字来判断选项是否更改颜色，现在由于在不同页面中没有数字的概念，所以active是不生效的。可以通过获取当前的url来概念颜色</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Tabbar</span></span><br><span class="line"><span class="keyword">import</span> &#123;Link&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</span><br><span class="line">...</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tarbar</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state=&#123;</span><br><span class="line">            index:<span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    itemChange=<span class="function">(<span class="params">i</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;<span class="attr">index</span>:i&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">const</span> url=<span class="built_in">window</span>.location.href;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">        	&lt;div className=<span class="string">'tabbar'</span>&gt;</span><br><span class="line">            	&lt;div className=<span class="string">'tabbar-content'</span>&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        tabbar.map(<span class="function">(<span class="params">v,i</span>)=&gt;</span>&#123;</span><br><span class="line">                            &lt;Link to=&#123;v.link&#125; key=&#123;i&#125; className=&#123;<span class="string">'tabbar-item'</span>+ (url.indexOf(v.link)&gt;<span class="number">-1</span>)?<span class="string">'active:'</span><span class="string">' &#125;&gt;</span></span><br><span class="line"><span class="string">                                &lt;div className=&#123;'</span>iconfont <span class="string">'+v.img&#125;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                                &lt;div&gt;&#123;v.text&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                            &lt;/Link&gt;</span></span><br><span class="line"><span class="string">                        &#125;);</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">    			&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这时可以给选项添加正确的class，但是class并未生效，active的作用被覆盖了，需要使用!important 来强制生效</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//在index.css中给active添加样式</span><br><span class="line">    <span class="selector-class">.active</span>&#123;</span><br><span class="line">        <span class="attribute">color</span>:red <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p> 此时还会发现另一个问题，我们的tabbar会遮挡Home、Car等页面，该如何处理呢，</p>
<p>可以给Home等组件的的背景css添加margin-bottom，值设为tabbar的高度</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//在APP.css中添加样式</span><br><span class="line"><span class="selector-class">.bg</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">100%</span>;</span><br><span class="line">    //height:100;//需要把这个属性删除，以实现内容的自动滚动</span><br><span class="line">    <span class="selector-tag">margin-bottom</span><span class="selector-pseudo">:50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是这时又发现我们的tabbar随着Home等组件上下滚动了，这不是我们想要的结果，查看tarbar的布局，position:absolute，我门想要tabbar相对于视口来布局的，将position改为fixed即可</p>
<h4 id="7-7-高阶组件改写Tabbar"><a href="#7-7-高阶组件改写Tabbar" class="headerlink" title="7.7 高阶组件改写Tabbar"></a>7.7 高阶组件改写Tabbar</h4><p>上面我们已经把所有功能实现了，但是对于Home、Car、Category、User存在大量重复性的代码，这就可以使用高阶组件进行提取。</p>
<p>很简单，遵循两个步骤就可以了</p>
<ul>
<li>实现一个普通组件</li>
<li>将普通组件使用函数包裹</li>
</ul>
<p>在index.js中找到Tabbar，使用函数将其包裹起来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">const Tabbar=(WrappedComponent)=&gt; class Tabbar extends Component&#123;</span><br><span class="line">    ...</span><br><span class="line">    render()&#123;</span><br><span class="line">        const url=window.location.href;</span><br><span class="line">        reutrn (</span><br><span class="line">        	&lt;div className=&apos;tabbar-container&apos;&gt;</span><br><span class="line">        		//注意必须将WrappedComponent在该组件渲染</span><br><span class="line">        		&lt;div className=&apos;tabbar-children&apos;&gt;</span><br><span class="line">        			&lt;WrappedComponent /&gt;</span><br><span class="line">        		&lt;/div&gt;</span><br><span class="line">        		&lt;div className=&apos;tabbar</span><br><span class="line">        			&lt;div className=&apos;tabbar-content&apos;&gt;</span><br><span class="line">        			//...</span><br><span class="line">        			&lt;/div&gt;</span><br><span class="line">        		div&gt;</span><br><span class="line">        	&lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//将下面的内容放在上边</span><br><span class="line">//class Tabbar extends Component&#123;&#125;</span><br><span class="line"></span><br><span class="line">//在tabbar的css文件index.css中给tabbar-children设置样式,就可以把App.css文件中的.bg去掉了。</span><br><span class="line">.tabbar-children&#123;</span><br><span class="line">    margin:bottom:50px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在使用时，需要改变一下了，在Home.js中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import React ,&#123;Component&#125; from &apos;react&apos;;</span><br><span class="line">import Tabbar from &apos;./component/tarbar&apos;;</span><br><span class="line"></span><br><span class="line">class Home extends Component&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        return (</span><br><span class="line">        	&lt;div&gt;</span><br><span class="line">            	&lt;img className=&apos;bg&apos; src=&#123;require(&apos;../static/imgs/home.png&apos;)&#125; /&gt;</span><br><span class="line">            	~~&lt;Tabbar /&gt;~~</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Tabbar(Home);//输出的时候，用函数更改即可</span><br></pre></td></tr></table></figure>
<p>link可以出发路由的改变，路由改变之后需要APP去监听做何改变</p>
<p>注意：此文为慕课网视频笔记<br><a href="https://www.imooc.com/learn/1075" target="_blank" rel="noopener">https://www.imooc.com/learn/1075</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/04/02/React高阶组件笔记/" data-id="ck8iwvpzz002pnso18a38kq59" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-js中的EventLoop" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/09/js中的EventLoop/" class="article-date">
  <time datetime="2020-01-08T16:24:21.000Z" itemprop="datePublished">2020-01-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/09/js中的EventLoop/">js中的EventLoop</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="一、由promise和setTimeout引出的问题"><a href="#一、由promise和setTimeout引出的问题" class="headerlink" title="一、由promise和setTimeout引出的问题"></a>一、由promise和setTimeout引出的问题</h4><p>面试中最尴尬的情况大概就是当对方抛出问题时，你却不知从何说起。当问起promise和setTimeout时接下来很大程度上都会问到执行顺序，引出js的EventLoop的话题。</p>
<h4 id="二、什么是EventLoop"><a href="#二、什么是EventLoop" class="headerlink" title="二、什么是EventLoop"></a>二、什么是EventLoop</h4><p>​    JavaScript语言的一大特点就是单线程，这已经成了这门语言的核心特征，将来也不会改变。为了利用多核CPU的计算能力，HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质。</p>
<p>​    js中任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 所有的同步任务会在主线程中依次执行，而异步任务会被挂起；</span><br><span class="line">* 当被挂起的异步任务有了运行结果，回调函数就会被添加在任务队列中，该任务队列等待被主线程下次执行；</span><br><span class="line">* 当主线程内当然的同步任务被执行完之后，就会获取任务队列中任务，依次同步执行；</span><br><span class="line">* 依次往复，每当主线程中的任务被执行完后，都会去重新获取任务队列中的任务，这就是js的EventLoop</span><br></pre></td></tr></table></figure>
<p>当然上面说的是最简单的模型，当任务队列中还存在异步任务时，会发生什么呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 当主线程执行一个新的任务队列时，回依次执行里面的同步任务，</span><br><span class="line">* 若碰到异步任务，会将它挂起，待异步任务有了运行结果，回调函数会被添加到新的任务队列</span><br><span class="line">* 新的任务对象，等待被主线程下次获取，从而执行。</span><br></pre></td></tr></table></figure>
<p>到这里就可以回答一个初级的面试问题了，当使用setTimeout时延时指定的时间后，函数会不会立即执行？</p>
<p>答案是不会立即执行，因为setTimeout延迟指定时间后，只是将函数放入任务队列中，主线程首先得先执行完当前的所有同步任务后，才能去获取新的任务队列中的任务，然后依次执行任务队列中的任务。</p>
<p>当然，事情远不如此简单。异步跟异步也是有区分的。</p>
<h4 id="三、宏任务（macro-task）和微任务（micro-task）"><a href="#三、宏任务（macro-task）和微任务（micro-task）" class="headerlink" title="三、宏任务（macro-task）和微任务（micro-task）"></a>三、宏任务（macro-task）和微任务（micro-task）</h4><p>宏任务一般包括：setTimeout，setInterval</p>
<p>微任务一般包括：Promise（then方法的执行）、process.nextTick</p>
<p>区别在哪呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 假设所有的异步任务都有了运行结果，它们的回调被放在了两个任务队列中：宏任务队列和微任务队列</span><br><span class="line">* 当主线程执行完毕后，首先执行微任务队列中的任务，然后执行红任务队列中的任务</span><br><span class="line">* 如果在微任务队列中，有新的微任务，则该微任务队列执行完毕后，会立即执行新的微任务队列，然后再执行宏任务队列</span><br><span class="line">* 当执行宏任务队列时，同样若存在新的微任务，也会在本宏任务队列执行完后立即执行微任务队列；若存在新的宏任务时，新的宏任务会被挂起然后放在新的宏任务队列中，等待主线程的下次轮询。</span><br></pre></td></tr></table></figure>
<p>上面说的比较拗口，可以换一种说法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 所有宏任务有了运行结果，回调会被存放了任务队列中；</span><br><span class="line">* 所有的微任务有了运行结果，回调会被理解添加到当前主线程的执行序列中，</span><br><span class="line">* 这样当主线程执行到最后，都会继续执行所有微任务的回调，然后获取新的任务队列进行轮询</span><br></pre></td></tr></table></figure>
<p>更进阶的面试题就是，说出下面的代码的输出：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'1'</span>);</span><br><span class="line">&#125;,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">    process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'3'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>正确答案是：2-5-3-4-1</p>
<p>网上有更多的练习题，可以自己去看看。本文讲到这里</p>
<h4 id="四、其它"><a href="#四、其它" class="headerlink" title="四、其它"></a>四、其它</h4><p>宏任务还有<a href="http://nodejs.org/docs/latest/api/timers.html#timers_setimmediate_callback_arg" target="_blank" rel="noopener">setImmediate</a>，node的事件轮询也有一些差别，这里不再详述，可以参考下面的文档。</p>
<p>参考：</p>
<p><a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="noopener"><a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2014/10/event-loop.html</a></a></p>
<p><a href="https://blog.csdn.net/qq_41805715/article/details/84849280" target="_blank" rel="noopener"><a href="https://blog.csdn.net/qq_41805715/article/details/84849280" target="_blank" rel="noopener">https://blog.csdn.net/qq_41805715/article/details/84849280</a></a><br><a href="https://blog.csdn.net/u014298440/article/details/88430838" target="_blank" rel="noopener">https://blog.csdn.net/u014298440/article/details/88430838</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/09/js中的EventLoop/" data-id="ck8iwvpz9001pnso1amtuzkos" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-WebAssembly初体验" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/07/WebAssembly初体验/" class="article-date">
  <time datetime="2020-01-07T15:02:21.000Z" itemprop="datePublished">2020-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/07/WebAssembly初体验/">WebAssembly初体验</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、编译wasm"><a href="#一、编译wasm" class="headerlink" title="一、编译wasm"></a>一、编译wasm</h3><h4 id="1-1-准备环境"><a href="#1-1-准备环境" class="headerlink" title="1.1 准备环境"></a>1.1 准备环境</h4><ul>
<li><p>安装git</p>
</li>
<li><p>安装python</p>
</li>
<li><p>准备Emscripten SDK</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/emscripten-core/emsdk.git</span><br><span class="line">$ cd emsdk</span><br><span class="line">$ ./emsdk install latest</span><br><span class="line">$ ./emsdk activate latest</span><br><span class="line"></span><br><span class="line">$ source ./emsdk_env.sh --build=Release  //本命令行窗口可以直接使用emcc命令</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="1-2-编辑wasm文件"><a href="#1-2-编辑wasm文件" class="headerlink" title="1.2 编辑wasm文件"></a>1.2 编辑wasm文件</h4><ul>
<li><p>编写math.c文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minus</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a-b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a*b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过emsdk生成math.wasm</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注意emcc命令，需要事先source ./emsdk_env.sh --build=Release</span></span><br><span class="line">$ emcc math.c -Os -s WASM=<span class="number">1</span> -s SIDE_MODULE=<span class="number">1</span> -o math.wasm</span><br></pre></td></tr></table></figure>
</li>
<li><p>这样我们的<code>math.wasm</code>文件就生成好了</p>
</li>
</ul>
<h3 id="二、js引入wasm"><a href="#二、js引入wasm" class="headerlink" title="二、js引入wasm"></a>二、js引入wasm</h3><h4 id="2-1-初始化一个工程目录"><a href="#2-1-初始化一个工程目录" class="headerlink" title="2.1 初始化一个工程目录"></a>2.1 初始化一个工程目录</h4><p>略，注意webpack的版本必须是4及以上,</p>
<h4 id="2-2-引入loader和fetch"><a href="#2-2-引入loader和fetch" class="headerlink" title="2.2 引入loader和fetch"></a>2.2 引入loader和fetch</h4>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install wasm-loader --save-dev</span><br><span class="line">npm install node-fetch  --save-dev</span><br></pre></td></tr></table></figure>
<h4 id="2-3-编写引入函数和测试函数"><a href="#2-3-编写引入函数和测试函数" class="headerlink" title="2.3 编写引入函数和测试函数"></a>2.3 编写引入函数和测试函数</h4>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getExportFunction = <span class="keyword">async</span> (url) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> env = &#123;</span><br><span class="line">      memoryBase: <span class="number">0</span>,</span><br><span class="line">      tableBase: <span class="number">0</span>,</span><br><span class="line">      memory: <span class="keyword">new</span> WebAssembly.Memory(&#123;</span><br><span class="line">        initial: <span class="number">256</span></span><br><span class="line">      &#125;),</span><br><span class="line">      table: <span class="keyword">new</span> WebAssembly.Table(&#123;</span><br><span class="line">        initial: <span class="number">2</span>,</span><br><span class="line">        element: <span class="string">'anyfunc'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> instance = <span class="keyword">await</span> fetch(url).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> response.arrayBuffer();</span><br><span class="line">    &#125;).then(<span class="function">(<span class="params">bytes</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> WebAssembly.instantiate(bytes, &#123;<span class="attr">env</span>: env&#125;)</span><br><span class="line">    &#125;).then(<span class="function">(<span class="params">instance</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> instance.instance.exports;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> test = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wasmUrl = <span class="string">'http://localhost:3000/math.wasm'</span>;</span><br><span class="line">    <span class="keyword">const</span> &#123; add,minus,multiply &#125; = <span class="keyword">await</span> getExportFunction(wasmUrl);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'200+100='</span>,add(<span class="number">200</span>,<span class="number">100</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'200-100='</span>,minus(<span class="number">200</span>,<span class="number">100</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'200*100='</span>,multiply(<span class="number">200</span>,<span class="number">100</span>));</span><br><span class="line">    alert(<span class="string">'打开控制台查看'</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试执行</span></span><br><span class="line">test();</span><br></pre></td></tr></table></figure>
<p>打开控制台就能看到下面的内容了</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">200</span>+<span class="number">100</span>= <span class="number">300</span></span><br><span class="line"><span class="number">200</span><span class="number">-100</span>= <span class="number">100</span></span><br><span class="line"><span class="number">200</span>*<span class="number">100</span>= <span class="number">20000</span></span><br></pre></td></tr></table></figure>
<h4 id="2-4-其它"><a href="#2-4-其它" class="headerlink" title="2.4 其它"></a>2.4 其它</h4><p>上述的方法是将wasm作为一个外部的静态资源文件加载；</p>
<p>若要降wasm作为内部文件加载，仅仅需要通过配置webpack即可；</p>
<p>思考，能不能载工程源码中直接编写c或c++代码呢，然后统一编译。</p>
<p>参考：</p>
<p><a href="https://webassembly.org/getting-started/developers-guide/" target="_blank" rel="noopener">https://webassembly.org/getting-started/developers-guide/</a></p>
<p><a href="https://segmentfault.com/a/1190000008402872" target="_blank" rel="noopener">https://segmentfault.com/a/1190000008402872</a></p>
<p><a href="https://www.cnblogs.com/detectiveHLH/p/9881626.html" target="_blank" rel="noopener">https://www.cnblogs.com/detectiveHLH/p/9881626.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/01/07/WebAssembly初体验/" data-id="ck8iwvpyh000hnso1pw954jka" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebAssembly/">WebAssembly</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-webgl2基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/24/webgl2基础/" class="article-date">
  <time datetime="2019-12-24T14:46:42.000Z" itemprop="datePublished">2019-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/24/webgl2基础/">webgl2基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>翻译自<a href="https://webgl2fundamentals.org/webgl/lessons/webgl-fundamentals.html" target="_blank" rel="noopener">https://webgl2fundamentals.org/webgl/lessons/webgl-fundamentals.html</a></p>
<p>这些文章是讲解WebGL2的，如果你对WebGL1.0感兴趣，<a href="https://webglfundamentals.org/" target="_blank" rel="noopener">点击这</a>。WebGL2完全兼容WebGL1，也就是说一旦你开启WebGL2，它会像以往的方式来工作。</p>
<p>WebGL通常被认为是一种3D的apis。人们常说“我要使用WebGL来完成炫酷的3D效果”。实际上WebGL只是一个光栅化引擎。它基于你提供的代码来绘制点、线和三角面。想让WebGL来完成炫酷的任务就要看你掌控点线三角面运作的能力了。</p>
<p>WebGL在计算机的GPU中运行。所以你需要提供可以在GPU中运行的代码。这样的代码有两种函数形式。这两种函数被称为<strong>顶点着色器（vertex shader）</strong>和<strong>片元着色器（fragment shader）</strong>，它们的书写格式严格遵循一种类C/C++的名的<a href="https://webgl2fundamentals.org/webgl/lessons/webgl-shaders-and-glsl.html" target="_blank" rel="noopener">GLSL</a>的语言。这两个着色器成对出现，被称为一个<strong>程序(program)</strong></p>
<p>顶点着色器的任务是计算顶点的位置。函数可以做基于这些位置的输出（包含点、线、三角面的基元），然后WebGL就可以对这些基元进行光栅化处理。当进行光栅化处理时，就会调用片元着色器了，片元着色器的任务是计算当前绘制的每一个基元的像素颜色值。</p>
<p>几乎整个WebGL的API都是用来设置这两个着色器状态的。任何需要绘制的对象都需要设置一系列的状态，然后通过函数在GPU中执行这对着色器，通过<code>gl.drawArrays</code>和<code>gl.drawElements</code>函数执行。</p>
<p>任何这些函数可以访问的到的数据都必须提供给GPU。着色器有四种方式来接收数据：</p>
<ol>
<li><p>Attributes(属性),Buffers(缓冲区)和Vertex Arrays(顶点数组)</p>
<p>Buffers(缓冲区)是需要上传给GPU的二进制数据的数组。通常Buffers(缓冲区)包含信息：位置、法线，纹理坐标，顶点颜色等，尽管你有权传递任意数据进去。</p>
<p>Attributes(属性)用来指定如何从Buffers(缓冲区)中提取数据，并且提供给顶点着色器。例如你可以向缓冲区中添加32位浮点数的位置数据，你需要告诉一个指定的Attributes(属性)包括：哪一个缓冲区来提取数据、它要提取的数据是什么类型、在缓存区中从偏移量多少的位置开始提取数据、从一个位置到下一个位置有多少个字节。</p>
<p>Buffers(缓冲区)不是随机访问的。相反，顶点着色器需要指定没执行的次数。每一次执行时，都需要从指定的Buffers(缓冲区)提取下一个值分配给一个Attributes(属性)。</p>
<p>Attributes(属性)的状态，会被buffers用到的，以及如何从这些buffers中提取数据，被搜集在一个顶点数组对象中（VAO），</p>
</li>
<li><p>Uniforms</p>
<p>在你执行你的着色器程序之前，Uniforms是有效的全局变量。</p>
</li>
<li><p>Textures（纹理）</p>
<p>纹理是数据数组，你可以在你的着色器程序中随机访问。最常见的传递给纹理的对象是image数据，但是纹理只是数据，可以包含除颜色之外的其它数据。</p>
</li>
<li><p>Varyings</p>
<p>Varyings是顶点着色器向片元着色器传递数据的一种方式。根据要渲染的内容（点、线或三角面），当执行片元着色器时，通过顶点着色器给Varying设置的值会执行内插值计算。</p>
</li>
</ol>
<h2 id="WebGL-Hello-World"><a href="#WebGL-Hello-World" class="headerlink" title="WebGL Hello World"></a>WebGL Hello World</h2><p>WebGL只关心两个事情：裁剪空间坐标和颜色。作为一个WebGL程序员,你的工作就是给WebGL提供这两个东西。这些工作通过提供两个着色器来完成，顶点着色器负责提供裁剪空间坐标，片元着色器负责提供颜色。</p>
<p>裁剪空间坐标通常介于（-1,1）的区间，不管canvas的尺寸多大。下面是一个简单的WebGL的例子，以简单的形式展示WebGL。</p>
<p>以顶点着色器开始</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#version 300 es</span><br><span class="line"></span><br><span class="line"><span class="comment">//一个attribute是一个顶点着色器的输入</span></span><br><span class="line"><span class="comment">//它会从buffer中接收数据</span></span><br><span class="line"><span class="keyword">in</span> vec4 a_position;</span><br><span class="line"></span><br><span class="line"><span class="comment">//所有的着色器，都有一个main函数</span></span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">    gl_position=a_position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当执行的时候，如果整个都是使用JavaScript编写的，而不是GLSL，你需要考虑这样书写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> positionBuffer=[</span><br><span class="line">    <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">  	<span class="number">0</span>,<span class="number">0.5</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">  	<span class="number">0.7</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> attributes=&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> gl_Psition;</span><br><span class="line"></span><br><span class="line">drawArrays(..., offset, count)&#123;</span><br><span class="line">  <span class="keyword">var</span>  stride=<span class="number">4</span>;</span><br><span class="line">  <span class="keyword">var</span>  size=<span class="number">4</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;count;++i)&#123;</span><br><span class="line">    <span class="comment">//从positionBuffer中复制4个值给a_position attribute</span></span><br><span class="line">    attributes.a_position=positionBuffer.slice((offset+<span class="number">1</span>)*stide,size);</span><br><span class="line">    runVertexShader();</span><br><span class="line">    ...</span><br><span class="line">    doSomethingWith_gl_Position();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上并没有那么简单，因为<code>positionBuffer</code>需要转换成二进制数据（如下所示），所以实际从buffer中获取数据的计算会有一些不同，但是希望通过这样能让你了解到顶点着色器是如何执行的。</p>
<p>下面需要一个片元着色器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#version 300es</span><br><span class="line"><span class="comment">//片元着色器没有默认的精度，所以我们需要指定一个。medium是很好的默认值</span></span><br><span class="line">precision mediump float;</span><br><span class="line"></span><br><span class="line"><span class="comment">//需要给片元着色器声明一个输出</span></span><br><span class="line">out.vec4 outColor;</span><br><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  	<span class="comment">//将输出设置成紫色</span></span><br><span class="line">    outColor=vec4(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0.5</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上边声明<code>outColor</code>作为片元着色器的输出，将<code>outColor</code>设置为<code>1,0,0.5,1</code>，1表示红色，0表示绿色，0.5表示蓝色，1表示透明度。在WebGL中颜色介于(0,1)之间。</p>
<p>现在已经写好了两个着色器函数，接下来可以使用WebGL执行了</p>
<p>首先需要HTML的canvas元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"c"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在JavaScript中如下面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas=<span class="built_in">document</span>.getElementById(<span class="string">"c"</span>);</span><br></pre></td></tr></table></figure>
<p>现在可以创建一个WebGL2的渲染背景了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gl=canvas.getContext(<span class="string">"webgl2"</span>);</span><br><span class="line"><span class="keyword">if</span>(!gl)&#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">  	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在需要编译这些着色器了，将它们提供给GPU。所以首先我们需要将它们转为字符串。可以以任何正常的方式创建GLSL字符串。可以通过拼接字符串，可以使用、AJAX下载它们，通过将它们放在非JavaScript标签中，或者以如下多行模板的方式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vertexShaderSource=<span class="string">'#version 300 es</span></span><br><span class="line"><span class="string">in vec4 a_position;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">void main()&#123;</span></span><br><span class="line"><span class="string">    gl_Position=a_position;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fragmentShaderSource=<span class="string">'#version 300 es</span></span><br><span class="line"><span class="string">precision mediump float;</span></span><br><span class="line"><span class="string">out vec4 outColor;</span></span><br><span class="line"><span class="string">void main()&#123;</span></span><br><span class="line"><span class="string">    outColor=vec4(1,0,0.5,1);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">'</span>;</span><br></pre></td></tr></table></figure>
<p>实际上，大多数3D引擎使用各种各样的模板快速生成GLSL着色器。本网站上的例子都没有复杂到在运行时生生GLSL。</p>
<blockquote>
<p>注意：<code>#verison 300 es</code>必须是着色器的首行。它之前不允许有任何命令或空格。<code>#verison 300 es</code>告诉WebGL2你要使用WebGL2的名为GLSL ES3.00的着色器语言。如果你不在首行放置它，着色器语言会默认使用WebGL 1.0的GLSL ES 1.00语言，它们之间有很大的不同，缺少很多特性。</p>
</blockquote>
<p>下面需要一个函数来创建一个着色器，上传GLSL源码，并且编译着色器。注意饿哦并没有编写任何评论因为函数的命名清晰的展示了发生了什么</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createShader</span>(<span class="params">gl, type, source</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> shader=gl.createShader(type);</span><br><span class="line">  	gl.shaderSource(shader,source);</span><br><span class="line">  	gl.compileShader(shader);</span><br><span class="line">  	<span class="keyword">var</span> success=gl.getShaderParameter(shader,gl.COMPILE_STATUS);</span><br><span class="line">  	<span class="keyword">if</span>(success)&#123;</span><br><span class="line">        <span class="keyword">return</span> shader;</span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="built_in">console</span>.log(gl.getShaderInfoLog(shader));</span><br><span class="line">  	gl.deleteShader(shader);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在可以调用函数创建第二个着色器了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vertexShader = createShader(gl,gl.VERTEX_SHADER, vertexShaderSource);</span><br><span class="line"><span class="keyword">var</span> fragmentShader=createShader(gl,gl.FRAGMENT_SHADER,fragmentShaderSource);</span><br></pre></td></tr></table></figure>
<p>然后将这两个着色器连接到程序（program）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createProgram</span>(<span class="params">gl,vertexShader,fragmentShader</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> program=gl.createProgram();</span><br><span class="line">  	gl.attachShader(program,vertexShader);</span><br><span class="line">  	gl.attachShader(program,fragmentShader);</span><br><span class="line">  	gl.linkProgram(program);</span><br><span class="line">  	<span class="keyword">var</span>  success=gl.getProgramParameter(program,gl.LINK_STATUS);</span><br><span class="line">  	<span class="keyword">if</span>(success)&#123;</span><br><span class="line">        <span class="keyword">return</span> program;</span><br><span class="line">    &#125;</span><br><span class="line">  	<span class="built_in">console</span>.log(gl.getProgramInfoLog(program));</span><br><span class="line">  	gl.deleteProgram(program);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并且调用它</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> program=createProgram(gl,vertexShader,fragmentShader);</span><br></pre></td></tr></table></figure>
<p>现在我们在GPU中创建一个GLSL程序，并且需要给它提供数据。大部分的WebGL API都是涉及到给供给给GLSL程序提供的数据设置状态。在这个例子中给GLSL 程序提供的输入只有<code>a_position</code>，它是一个attribute。首先要做的是给我们创建的程序找到attribute的位置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vav positionAttributeLocation=gl.getAttributeLocation(program,<span class="string">"a_position"</span>);</span><br></pre></td></tr></table></figure>
<p>找到attribute的位置（唯一的位置）是在初始化阶段要完成的事情，而不是在渲染阶段。</p>
<p>Attribute需要从buffers中获取数据，所以需要创建一个buffer</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> positionBuffer=gl.createBuffer();</span><br></pre></td></tr></table></figure>
<p>WebGL允许我们操纵许多全局绑定点中的WebGL资源。可以将绑定点看做是WebGL内部的去哪局变量。首先给绑定点绑定资源，然后所有的其它函数通过绑定点来绑定这些资源。所以我们绑定位置buffer</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gl.bindBuffer(gl.ARRAY_BUFFER,positionBuffer);</span><br></pre></td></tr></table></figure>
<p>现在可以通过绑定点将数据提供给buffer了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> positions=[</span><br><span class="line">    <span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">  	<span class="number">0</span>,<span class="number">0.5</span>,</span><br><span class="line">  	<span class="number">0.7</span>,<span class="number">0</span>,</span><br><span class="line">];</span><br><span class="line">gl.bufferData(gl.ARRAY_BUFFER,<span class="keyword">new</span> <span class="built_in">Float32Array</span>(positions),gl.STATIC_DRAW);</span><br></pre></td></tr></table></figure>
<p>在这里做了很多事情，首先我们有一个<code>positions</code>的JavaScript数组。WebGL需要强类型的数据，所以通过<code>new Float32Array(positions);</code>创建一个新的32位浮点型点数据数组，并且从<code>positions</code>拷贝数据。通过<code>gl.bufferData</code>将数据拷贝到GPU的<code>positionBuffer</code>中。它使用了位置buffer，因为我们通过绑定点将它绑定到了<code>ARRAY_BUFFER</code>。</p>
<p>最后一个参数<code>gl.STATIC_DRAW</code>是对WebGL的一个提示，提示如何使用数据。WebGL可以通过有这些提示来优化一些事情。<code>gl.STATIC_DRAW</code>告诉WebGL我们不太可能会改变这些数据。</p>
<p>现在，我们已经将需要告诉attribute如何和提取数据的数据放进了buffer中。我们需要通过调用一个顶点数组来创建一个attribute状态的集合。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vao=gl.createVertexArray();</span><br></pre></td></tr></table></figure>
<p>并且需要让它成为当前的顶点数组，所以所有的attribute设置会应用在那个attribute状态集上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gl.bindVertexArray(vao);</span><br></pre></td></tr></table></figure>
<p>接下来在顶点数组中设置attribute。首先我们需要开启attribute，这告诉WebGL我们想要从buffer中提取数据。如果我们没有开启attribute那么attribute就会是一个常量值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gl.enableVertexAttribArray(positionAttributeLocation);</span><br></pre></td></tr></table></figure>
<p>然后我们需要指定如何将数据提取出来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> size=<span class="number">4</span>;</span><br><span class="line"><span class="keyword">var</span> type=gl.FLOAT;</span><br><span class="line"><span class="keyword">var</span> normalize=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> stride=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> offset=<span class="number">0</span>;</span><br><span class="line">gl.vertexAttribPointer(positionAttributeLocation,size,type,normalize,stride,offset);</span><br></pre></td></tr></table></figure>
<p><code>gl.vertexAttribPointer</code>的作用是将当前的<code>ARRAY_BUFFER</code>绑定给attribute。也就是说现在attribute绑定给了<code>positionBuffer</code>。这意味着我们可以绑定其它东西给<code>ARRAY_BUFFER</code>绑定点。attribute会集训使用<code>positionBuffer</code></p>
<p>注意从我们的GLSL 顶点着色器视图的点，<code>a_position</code>attrubute是一个<code>vec4</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span> vec4 a_position;</span><br></pre></td></tr></table></figure>
<p><code>vec4</code>是一个4个浮点值。在JavaScript中你可以把它看做是<code>a_position={x:0,y:0,z:0,w:0}</code>。在设置<code>size=2</code>之前，attribute默认是<code>0,0,0,1</code>所以这个attribute就会从我们的buffer中获取前两个值（x和y）。z和w分别是是默认的0和1。</p>
<p>在绘制之前，需要重置canvas的尺寸来匹配展示尺寸。canvas们就像图像一样拥有两个尺寸。像素的数量通常位于它的内部，和它的展示尺寸是相分离的。CSS决定了canvas的展示尺寸。你应该优先选择使用css改变canvas的尺寸，因为这是最便利的方法。</p>
<p>为了让canvas的内部像素数量和展示尺寸相匹配。我使用了一个<a href="https://webgl2fundamentals.org/webgl/lessons/webgl-resizing-the-canvas.html" target="_blank" rel="noopener">辅助函数</a>。</p>
<p>几乎所有的例子的canvas的尺寸都是400*300像素，它会在自己的窗口上运行。如果位于iframe内部，那么它就会拉伸填充整个可用区域，就像位于这个页面之上一样。通过让CSS控制尺寸，然后调整匹配，可以轻松的处理这两种情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webglUtils.resizeCanvasToDisplaySize(gl.canvas);</span><br></pre></td></tr></table></figure>
<p>我们需要告诉WebGL如何进行剪裁空间值的转换，需要设置<code>gl_Position</code>返还给像素，通常被称为屏幕空间。为了做到它，可以调用<code>gl.viewport</code>并且给它传递canvas的当前尺寸。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gl.viewport(<span class="number">0</span>,<span class="number">0</span>,gl.canvas.width,gl.canvas.height);</span><br></pre></td></tr></table></figure>
<p>它告诉WebGL将（-1，1）的剪裁空间映射到（0，gl.canvas.width）给x轴，（0,gl.canvas.height）给y轴</p>
<p>我们清空画布。<code>0,0,0,0</code>分别代表红、绿、蓝、透明度。所以在这个例子中，我们让画布透明</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gl.clearColor(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,);</span><br><span class="line">gl.clear(gl.COLOR_BUFFER_BIT);</span><br></pre></td></tr></table></figure>
<p>接下来我们需要告诉WebGL执行哪一个着色器程序</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gl.useProgram(program);</span><br></pre></td></tr></table></figure>
<p>然后我们需要告诉它需要用到哪一个buffers集，并且如何从这些buffers中提取数据给attributes</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gl.bindVertexArray(vao);</span><br></pre></td></tr></table></figure>
<p>最后需要请求WebGL来执行GLSL程序</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> primitiveType=gl.TRIANGLES;</span><br><span class="line"><span class="keyword">var</span> offset=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> count=<span class="number">3</span>;</span><br><span class="line">gl.drawArrays(primitiveType,offset,count);</span><br></pre></td></tr></table></figure>
<p>因为count是3，所以会执行顶点着色器3次。第一次中顶点着色器attribute的<code>a_position.x</code>和<code>a_position.y</code>会被设置成positionBuffer的前两个值；第二次中<code>a_position.xy</code>会别设置成随后的两个值；最后一次中会别设置成最后两个值。</p>
<p>因为我们将<code>primitiveType</code>设置为了<code>gl.TRIANGLES</code>，每次我们的顶点着色器都执行三次，WebGL会基于我们设置给<code>gl.Position</code>de 三个值来绘制三角形。无论canvas的尺寸是多少，在剪裁空间中的这些值在每个方向上都是（-1,1）的区间。 </p>
<p>由于顶点着色器只是简单的将positionBuffer中的值拷贝到<code>gl_Position</code>，三角形会在剪裁空间坐标中绘制。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">0.5</span>,</span><br><span class="line"><span class="number">0.7</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>如果canvas的尺寸正好是400*300，从剪裁空间向屏幕坐标的转化会如下：</p>
<table>
<thead>
<tr>
<th>clip space</th>
<th></th>
<th>screen space</th>
</tr>
</thead>
<tbody>
<tr>
<td>0,0</td>
<td>—&gt;</td>
<td>200,150</td>
</tr>
<tr>
<td>0,0.5</td>
<td>—&gt;</td>
<td>200,225</td>
</tr>
<tr>
<td>0.7,0</td>
<td>—&gt;</td>
<td>340,150</td>
</tr>
</tbody>
</table>
<p>WebGL现在就回渲染这个三角形面了。对于每一个要绘制的像素，WebGL都会调用片元着色器。我们的片元着色器仅仅设置了<code>outColor</code>为<code>1,0,0.5,1</code>。由于Canvas在每个通道都是8位的，意味着WebGL可以将<code>[255,0,127,255]</code>写进canvas、</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/24/webgl2基础/" data-id="ck8iwvq0q003fnso1x60ad0z2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webgl/">webgl</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-low-graphics-mode解决方法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/24/low-graphics-mode解决方法/" class="article-date">
  <time datetime="2019-12-24T14:43:12.000Z" itemprop="datePublished">2019-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/24/low-graphics-mode解决方法/">low-graphics mode解决方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>虚拟机运行ubuntu系统时，有时候会出现<code>The system is running in low-graphics mode</code>而进不了系统。怎么办呢？<br><strong>1、命令行</strong><br>如果你要做的工作不用图形化界面，可以<code>Ctrl</code> + <code>Alt</code> + <code>F1 || F2 || F3 || F4 || F5 || F6</code> 使用命令行登录。<br><strong>2、其它</strong><br>但是命令行内不可以运行可视化的软件，想要恢复图形化界面怎么办呢？<br>上网上收了一下，有很多解决方法，好多都需要敲命令。其实不需要，出现问题的原因是由于显卡的不匹配，只需要把虚拟机的显卡虚拟化一下即可，在<code>虚拟机设置</code>-<code>硬件</code>-<code>处理器</code>-<code>虚拟化引擎</code>中勾选<code>虚拟化Intel VT-x/EPT 或 AMD-V/RVI(V)</code>即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/24/low-graphics-mode解决方法/" data-id="ck8iwvpz8001mnso1irqdfpi6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Ubuntu固定ip和软件愿" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/24/Ubuntu固定ip和软件愿/" class="article-date">
  <time datetime="2019-12-24T14:41:39.000Z" itemprop="datePublished">2019-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/24/Ubuntu固定ip和软件愿/">Ubuntu固定ip和软件愿</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一、固定ip"><a href="#一、固定ip" class="headerlink" title="一、固定ip"></a>一、固定ip</h2><h3 id="1-1-设置静态ip"><a href="#1-1-设置静态ip" class="headerlink" title="1.1 设置静态ip"></a>1.1 设置静态ip</h3><p>在<code>compute-allsetting-network</code>中选择<code>wired</code>在右下角<code>options</code>中选择<code>IPv4 Setting</code>中</p>
<ul>
<li>Method中选择Manual；</li>
<li>Address中点击右侧add按钮，在里面添加Address、Netmask、Geteway；</li>
<li>DNS servers中添加相应的地址。<br>其中dns servers的地址可以在任意一台电脑上cmd中输入<code>ipconfig -all</code>的本地连接中查看，可以有多个。<br>可以参考：<a href="https://jingyan.baidu.com/article/b7001fe18f85fe0e7282ddaf.html" target="_blank" rel="noopener">ubuntu静态IP教程</a></li>
</ul>
<h3 id="1-2-关闭防火墙"><a href="#1-2-关闭防火墙" class="headerlink" title="1.2 关闭防火墙"></a>1.2 关闭防火墙</h3><p>如果是虚拟机的话，首先将网络连接方式设为<code>桥接模式(B)：直接连接物理网络</code>，并且勾选<code>复制物理网络连接状态(p)</code>。<br>接下来就需要命令行了，首先进入管理员模式，</p>
<blockquote>
<ol>
<li>关闭防火墙：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ufw disable</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<blockquote>
<ol start="2">
<li>开启防火墙<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ufw enable</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<p>一般这样就可以了，可以ping一下其它地址试一试，不行的话就重启一下系统。</p>
<h2 id="二、更换软件源"><a href="#二、更换软件源" class="headerlink" title="二、更换软件源"></a>二、更换软件源</h2><p>软件源文件位于<code>/etc/apt/sources.list</code>,<br>2.1 最好先做一下备份<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/apt</span><br><span class="line"></span><br><span class="line">cp sources.list sources.list.bak</span><br></pre></td></tr></table></figure></p>
<p>2.1 然后编辑sources.list<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi sources.list sources.list</span><br></pre></td></tr></table></figure></p>
<p>2.3 然后替换里面的地址，可以使用批量替换的命令<br><code>:%s#旧字符#新字符#g</code><br>其中g表示全部替换.<br>2.4 最后更新一下软件源：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/24/Ubuntu固定ip和软件愿/" data-id="ck8iwvpyf000fnso1640j2g6i" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-浏览器跨域" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/24/浏览器跨域/" class="article-date">
  <time datetime="2019-12-24T14:39:38.000Z" itemprop="datePublished">2019-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/24/浏览器跨域/">浏览器跨域</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="常见的跨域问题"><a href="#常见的跨域问题" class="headerlink" title="常见的跨域问题"></a>常见的跨域问题</h2><hr>
<p>今天在测试提出以一个问题，具体情形不说了，就是报错出现了这么个问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cross origin requests are only supported <span class="keyword">for</span> protocol schemes: http, data, chrome, chrome-extension, https, chrome-extension-resource.</span><br></pre></td></tr></table></figure>
<p>一眼看出就是跨域问题，说也奇怪，每次发送请求都是直接报错，但是请求还是可以正常发送成功，就是不能执行正确的回调函数了，如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> successHandler=<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">	callback(res);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> errorHandler = <span class="function"><span class="keyword">function</span>(<span class="params">errorInfo</span>) </span>&#123;</span><br><span class="line">	alert(errorInfo);</span><br><span class="line">&#125;;</span><br><span class="line">HGIS.Utils.send(routeNetAnlyseURL.shortestPathPoints,param,<span class="string">"POST"</span>,<span class="string">"json"</span>,successHandler,errorHandler);</span><br></pre></td></tr></table></figure>
<p>具体情形就是：每次发送请求HGIS.Utils.send的请求，它就立即直接回调<code>errorHandler</code>返回了，但是通过监听Network中该请求，当处理<code>errorHandler</code>时，该网络请求为阻塞状态，当点击alert中的确定按钮后console中提示上面的跨域错误信息，但是网络请求居然可以请求成功，并且返回正确的结果。不过这个正确的结果没有走我的<code>successHandler</code>函数。</p>
<p>出现跨域问题可以理解，毕竟我的html是离线文件。疑惑的是之前测试的时候就没有问题，可以正常访问，为啥现在出现这个问题了呢，说是跨域，可明明可以访问的到，为啥就不按我设定的流程走呢？</p>
<p>寻找陈老师帮忙，首先确定这个跨域是浏览器拦截的，相当与在网络请求没有发出时就没浏览器给提前处理了，直接进入错误处理流程。</p>
<p>如何让浏览器可以进行跨域的请求的，通过百度<a href="https://www.cnblogs.com/micua/p/chrome-file-protocol-support-ajax.html" target="_blank" rel="noopener">https://www.cnblogs.com/micua/p/chrome-file-protocol-support-ajax.html</a>找到一个方法。</p>
<blockquote>
<ul>
<li>在桌面建立一个chrome的快捷方式</li>
<li>右键该快捷方式，点击属性</li>
<li>在<code>属性-快捷方式-目标</code>框中后天添加<code>--allow-file-access-from-files</code>，注意该字符串之前要有一个空格键，最终的结果可能是<code>&quot;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe&quot; --allow-file-access-from-files</code>；</li>
<li>然后关闭所有的chrome浏览器，再双击该快捷方式打开浏览器</li>
<li>最后将离线html文件拖入浏览器即可</li>
</ul>
</blockquote>
<p>问题解决了，可以为啥会出现这么问题呢，为啥上个月的时候不用有这些设置就可以正常访问呢？</p>
<p>原因是浏览器版本的缘故，原来由于某些原因，我本地的chrome被更新到最新的版本了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Google Chrome 已是最新版本</span><br><span class="line"></span><br><span class="line">版本 65.0.3325.181（正式版本） （64 位）</span><br></pre></td></tr></table></figure>
<p>，而chrome最新版本增强了对网络请求的安全限制</p>
<p>最后查看chrome的安装位置，发现确实是在一周前的时候我的浏览器被更新了</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/24/浏览器跨域/" data-id="ck8iwvpzi0026nso139hi0irh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-git-rebase" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/24/git-rebase/" class="article-date">
  <time datetime="2019-12-24T14:35:01.000Z" itemprop="datePublished">2019-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/24/git-rebase/">git rebase</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="git-rebase命令"><a href="#git-rebase命令" class="headerlink" title="git rebase命令"></a>git rebase命令</h2><h4 id="一、rebase的作用"><a href="#一、rebase的作用" class="headerlink" title="一、rebase的作用"></a>一、rebase的作用</h4><p>先看例子，假设我们的操作如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、master分支已有文件master.txt；</span><br><span class="line"><span class="number">2</span>、从master拉取分支B，并创建文件b1.txt,add-commit;</span><br><span class="line"><span class="number">3</span>、从master拉取分支C，并创建文件c1.txt,add-commit;</span><br><span class="line"><span class="number">4</span>、切换分支B，并创建文件b2.txt,add-commit;</span><br><span class="line"><span class="number">5</span>、切换分支C，并创建文件c2.txt,add-commit;</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>、在分支C，合并master分支，然后将结果合并到master；</span><br><span class="line"><span class="number">7</span>、在分支B，合并master分支，然后将结果合并到master；</span><br></pre></td></tr></table></figure>
<p>此时结果怎么样呢？会发现分支B和分支C的提交，相互交叉，按照DATE排序的，如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">commit 17efaf6eeb99ecf9e6af5e78781279ae2e88af86 (HEAD -&gt; master, B)</span><br><span class="line">Merge: e791fb5 4d25aef</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 12:06:34 2019 +0800</span><br><span class="line"></span><br><span class="line">    Merge branch 'master' into B</span><br><span class="line"></span><br><span class="line">commit 4d25aef5fdadd54bf68ab6a6cd0f83ade7a46fe7 (C)</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:56:24 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]C添加文档2</span><br><span class="line"></span><br><span class="line">commit e791fb50580a2eaecac426df07bec10fb3d59ddc</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:55:43 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]B添加文件2</span><br><span class="line"></span><br><span class="line">commit 1567f12c0739fa898a89348422038507ab2cfd01</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:54:44 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]C添加文件1</span><br><span class="line"></span><br><span class="line">commit cecc88eca0f9b8d37d2f92fd99250cbb5b0da7e7</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:53:38 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]B添加文件1</span><br><span class="line"></span><br><span class="line">commit 8207c1f12cc1430208e2273d9429c04675afddbc</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:52:44 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]master添加文件1</span><br></pre></td></tr></table></figure>
<p>如果我们不想让B和C的commit交叉，该怎么做呢，就可以使用rebase命令了，只需要修改第6、7步即可</p>
<p><del>7、在分支B，合并master分支，然后将结果合并到master；</del></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>、在分支B， rebase master分支，然后将结果合并到master；</span><br></pre></td></tr></table></figure>
<p>此时我们再看一下log，就会返现日志是将C的commit完成之后，然后再有commitB中的提交</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">commit 552d2ba40803fc9ab013b6571efc2cda58f71236 (HEAD -&gt; master, B)</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:55:43 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]B添加文件2</span><br><span class="line"></span><br><span class="line">commit 07686a4be8a2ba5fb94810f1f23fdf96478a4193</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:53:38 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]B添加文件1</span><br><span class="line"></span><br><span class="line">commit 4d25aef5fdadd54bf68ab6a6cd0f83ade7a46fe7 (C)</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:56:24 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]C添加文档2</span><br><span class="line"></span><br><span class="line">commit 1567f12c0739fa898a89348422038507ab2cfd01</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:54:44 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]C添加文件1</span><br><span class="line"></span><br><span class="line">commit 8207c1f12cc1430208e2273d9429c04675afddbc</span><br><span class="line">Author: yahui.yang &lt;yahui.yang@ecarx.com.cn&gt;</span><br><span class="line">Date:   Thu Oct 10 11:52:44 2019 +0800</span><br><span class="line"></span><br><span class="line">    [add]master添加文件1</span><br></pre></td></tr></table></figure>
<p>什么原因呢？rebase命令会把分支B中的commit取消掉，将它们保存为补丁（patch），然后将分支B更新为master中最新的内容，最后将补丁应用到分支B中。</p>
<h4 id="二、冲突的解决"><a href="#二、冲突的解决" class="headerlink" title="二、冲突的解决"></a>二、冲突的解决</h4><p>在merge过程中如果出现的冲突，一般需要add并且commit进行处理。</p>
<p>但是在rebase过程中若出现冲突，解决完冲突后并不需要add和commit，只需要执行</p>
<p><code>git  rebase --continue</code>即可，</p>
<h4 id="三、rebase的取消"><a href="#三、rebase的取消" class="headerlink" title="三、rebase的取消"></a>三、rebase的取消</h4><p>在任何时候都可以使用命令<code>git rebase --abort</code>来终止rebase的动作，并且分支会回到rebase之前的状态</p>
<p>参考：<a href="http://gitbook.liuhui998.com/4_2.html" target="_blank" rel="noopener">http://gitbook.liuhui998.com/4_2.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/24/git-rebase/" data-id="ck8iwvpz1001dnso1cjk50cil" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sublime的使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/24/sublime的使用/" class="article-date">
  <time datetime="2019-12-24T14:28:21.000Z" itemprop="datePublished">2019-12-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/24/sublime的使用/">sublime的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="sublime插件的安装使用"><a href="#sublime插件的安装使用" class="headerlink" title="sublime插件的安装使用"></a>sublime插件的安装使用</h4><p><a href="https://blog.csdn.net/wxl1555/article/details/69941451/" target="_blank" rel="noopener">参考</a></p>
<h5 id="1-直接安装"><a href="#1-直接安装" class="headerlink" title="1.直接安装"></a>1.直接安装</h5><p>安装Sublime text 3插件很方便，可以直接下载安装包解压缩到Packages目录（菜单-&gt;preferences-&gt;Browse Packages）。</p>
<h5 id="2-使用Package-Control组件安装"><a href="#2-使用Package-Control组件安装" class="headerlink" title="2.使用Package Control组件安装"></a>2.使用Package Control组件安装</h5><p>也可以安装package control组件，然后直接在线安装：</p>
<p>按Ctrl+ `(此符号为tab按键上面的按键) 调出console（注：避免热键冲突）<br>粘贴以下代码到命令行并回车：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request,os; pf = <span class="string">'Package Control.sublime-package'</span>; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), <span class="string">'wb'</span>).write(urllib.request.urlopen( <span class="string">'http://sublime.wbond.net/'</span> + pf.replace(<span class="string">' '</span>,<span class="string">'%20'</span>)).read())</span><br></pre></td></tr></table></figure>
<p>按回车键，会看到下面出现东西在左右摆动，说明正在下载。</p>
<h5 id="3-下载完成之后重启Sublime-Text-3。"><a href="#3-下载完成之后重启Sublime-Text-3。" class="headerlink" title="3. 下载完成之后重启Sublime Text 3。"></a>3. 下载完成之后重启Sublime Text 3。</h5><h5 id="4-如果在Perferences-gt-中看到package-control这一项，则安装成功。"><a href="#4-如果在Perferences-gt-中看到package-control这一项，则安装成功。" class="headerlink" title="4. 如果在Perferences-&gt;中看到package control这一项，则安装成功。"></a>4. 如果在Perferences-&gt;中看到package control这一项，则安装成功。</h5><h5 id="5-用Package-Control安装插件的方法："><a href="#5-用Package-Control安装插件的方法：" class="headerlink" title="5.用Package Control安装插件的方法："></a>5.用Package Control安装插件的方法：</h5><ul>
<li>按下Ctrl+Shift+P调出命令面板</li>
<li>输入install 调出 Install Package 选项并回车，</li>
<li>然后在列表中选中要安装的插件。</li>
</ul>
<p>其它：</p>
<h5 id="JSFormat-JS代码格式化插件。"><a href="#JSFormat-JS代码格式化插件。" class="headerlink" title="JSFormat  JS代码格式化插件。"></a>JSFormat  JS代码格式化插件。</h5><p>使用方法：使用快捷键ctrl+alt+f</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/24/sublime的使用/" data-id="ck8iwvpzd001wnso1h7v7lx6j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sublime/">sublime</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GIS/">GIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gradle/">Gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebAssembly/">WebAssembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/">sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webgl/">webgl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/GIS/" style="font-size: 11.67px;">GIS</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/JavaScript/" style="font-size: 16.67px;">JavaScript</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/React/" style="font-size: 18.33px;">React</a> <a href="/tags/SpringBoot/" style="font-size: 11.67px;">SpringBoot</a> <a href="/tags/WebAssembly/" style="font-size: 10px;">WebAssembly</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 13.33px;">java</a> <a href="/tags/linux/" style="font-size: 11.67px;">linux</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/sublime/" style="font-size: 10px;">sublime</a> <a href="/tags/tomcat/" style="font-size: 11.67px;">tomcat</a> <a href="/tags/webgl/" style="font-size: 15px;">webgl</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/04/02/react-router-dom入门到深入/">react-router-dom入门到深入</a>
          </li>
        
          <li>
            <a href="/2020/04/02/React高阶组件笔记/">React高阶组件笔记</a>
          </li>
        
          <li>
            <a href="/2020/01/09/js中的EventLoop/">js中的EventLoop</a>
          </li>
        
          <li>
            <a href="/2020/01/07/WebAssembly初体验/">WebAssembly初体验</a>
          </li>
        
          <li>
            <a href="/2019/12/24/webgl2基础/">webgl2基础</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 杨亚辉<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>