<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>react实战2 | afei_ask</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一、修改搜索框1.1、修改搜索框文字颜色和间距当在搜索框填写的内容过长时，间距就不够了，并且输入的文字颜色有点深。我们首先调整一下文字颜色，在common/header/style.js中修改 12345678910111213141516171819export const NavSearch=styled.input.attrs(&amp;#123;	placeholder:&apos;搜索&apos;&amp;#125;)`">
<meta name="keywords" content="React">
<meta property="og:type" content="article">
<meta property="og:title" content="react实战2">
<meta property="og:url" content="http://yoursite.com/2018/10/18/react实战2/index.html">
<meta property="og:site_name" content="afei_ask">
<meta property="og:description" content="一、修改搜索框1.1、修改搜索框文字颜色和间距当在搜索框填写的内容过长时，间距就不够了，并且输入的文字颜色有点深。我们首先调整一下文字颜色，在common/header/style.js中修改 12345678910111213141516171819export const NavSearch=styled.input.attrs(&amp;#123;	placeholder:&apos;搜索&apos;&amp;#125;)`">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-12-24T13:40:49.461Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="react实战2">
<meta name="twitter:description" content="一、修改搜索框1.1、修改搜索框文字颜色和间距当在搜索框填写的内容过长时，间距就不够了，并且输入的文字颜色有点深。我们首先调整一下文字颜色，在common/header/style.js中修改 12345678910111213141516171819export const NavSearch=styled.input.attrs(&amp;#123;	placeholder:&apos;搜索&apos;&amp;#125;)`">
  
    <link rel="alternate" href="/atom.xml" title="afei_ask" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">afei_ask</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-react实战2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/18/react实战2/" class="article-date">
  <time datetime="2018-10-18T14:21:56.000Z" itemprop="datePublished">2018-10-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      react实战2
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、修改搜索框"><a href="#一、修改搜索框" class="headerlink" title="一、修改搜索框"></a>一、修改搜索框</h3><h4 id="1-1、修改搜索框文字颜色和间距"><a href="#1-1、修改搜索框文字颜色和间距" class="headerlink" title="1.1、修改搜索框文字颜色和间距"></a>1.1、修改搜索框文字颜色和间距</h4><p>当在搜索框填写的内容过长时，间距就不够了，并且输入的文字颜色有点深。我们首先调整一下文字颜色，在<code>common/header/style.js</code>中修改</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> NavSearch=styled.input.attrs(&#123;</span><br><span class="line">	placeholder:<span class="string">'搜索'</span></span><br><span class="line">&#125;)<span class="string">`</span></span><br><span class="line"><span class="string">	width:160px;</span></span><br><span class="line"><span class="string">	height:38px;</span></span><br><span class="line"><span class="string">		padding:0 30px 0 20px;</span></span><br><span class="line"><span class="string">	box-sizing:border-box;</span></span><br><span class="line"><span class="string">	border:none;</span></span><br><span class="line"><span class="string">	outline:none;</span></span><br><span class="line"><span class="string">	margin-top:9px;</span></span><br><span class="line"><span class="string">	margin-left:20px;</span></span><br><span class="line"><span class="string">	border-radius:19px;</span></span><br><span class="line"><span class="string">	background:#eee;</span></span><br><span class="line"><span class="string">	font-size:14px;</span></span><br><span class="line"><span class="string">		color:#666;</span></span><br><span class="line"><span class="string">	&amp;::placeholder&#123;</span></span><br><span class="line"><span class="string">		color:#999;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="1-2、修改搜索框鼠标动画"><a href="#1-2、修改搜索框鼠标动画" class="headerlink" title="1.2、修改搜索框鼠标动画"></a>1.2、修改搜索框鼠标动画</h4><p>下面我们来添加一下鼠标的移入移出效果，搜过框的宽度锁着鼠标的变化会自动的变化。当聚焦的时候，搜索框就会变长。</p>
<p>react不建议我们直接操作dom，所以我们可以通过定义数据来实现，首先我们在<code>common/header/index.js</code>中添加constructor函数，并在里面定义state；并且在NavSearch标签中添加className={this.state.focused},</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state=&#123;</span><br><span class="line">        focused:<span class="literal">false</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&lt;SearchWrapper&gt;</span><br><span class="line">	&lt;NavSearch className=&#123;<span class="keyword">this</span>.state.focused ? <span class="string">'focused'</span>:<span class="string">''</span>&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">NavSearch</span>&gt;</span></span></span><br><span class="line">	&lt;i className='iconfont'&gt;&amp;#xe6dd;&lt;/i&gt;</span><br><span class="line">&lt;<span class="regexp">/SearchWrapper&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后我们在<code>common/header/style.js</code>中添加focused的样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> NavSearch=styled.input.attrs(&#123;</span><br><span class="line">	placeholder:<span class="string">'搜索'</span></span><br><span class="line">&#125;)<span class="string">`</span></span><br><span class="line"><span class="string">	width:160px;</span></span><br><span class="line"><span class="string">	height:38px;</span></span><br><span class="line"><span class="string">	padding:0 35px 0 20px;</span></span><br><span class="line"><span class="string">	box-sizing:border-box;</span></span><br><span class="line"><span class="string">	border:none;</span></span><br><span class="line"><span class="string">	outline:none;</span></span><br><span class="line"><span class="string">	margin-top:9px;</span></span><br><span class="line"><span class="string">	margin-left:20px;</span></span><br><span class="line"><span class="string">	border-radius:19px;</span></span><br><span class="line"><span class="string">	background:#eee;</span></span><br><span class="line"><span class="string">	font-size:14px;</span></span><br><span class="line"><span class="string">	color:#666;</span></span><br><span class="line"><span class="string">	&amp;::placeholder&#123;</span></span><br><span class="line"><span class="string">		color:#999;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">        &amp;.focused &#123;</span></span><br><span class="line"><span class="string">            width:200px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>并且注意当搜索框变长时，右边搜索按钮背景色也发生了变化，此时需要修改<code>common/header/index.js</code>中的i标签中添加新的className，并且在<code>common/header/style.js</code>中SearchWrapper标签的样式中设置iconfont搜索按钮的背景颜色</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;SearchWrapper&gt;</span><br><span class="line">&lt;NavSearch className=&#123;<span class="keyword">this</span>.state.focused ? <span class="string">'focused'</span>:<span class="string">''</span>&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">NavSearch</span>&gt;</span></span></span><br><span class="line">&lt;i className='iconfont'&gt;&amp;#xe6dd;&lt;/i&gt;</span><br><span class="line">&lt;<span class="regexp">/SearchWrapper&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/改为</span></span><br><span class="line"><span class="regexp">&lt;SearchWrapper&gt;</span></span><br><span class="line"><span class="regexp">&lt;NavSearch className=&#123;this.state.focused ? 'focused':''&#125;&gt;&lt;/</span>NavSearch&gt;</span><br><span class="line">&lt;i className=&#123;this.state.focused ? 'focused iconfont':'iconfont'&#125;&gt;&amp;#xe6dd;&lt;/i&gt;</span><br><span class="line">&lt;<span class="regexp">/SearchWrapper&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchWrapper=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float:left;</span></span><br><span class="line"><span class="string">	position:relative;</span></span><br><span class="line"><span class="string">	.iconfont &#123;</span></span><br><span class="line"><span class="string">		position:absolute;</span></span><br><span class="line"><span class="string">		right:5px;</span></span><br><span class="line"><span class="string">		bottom:5px;</span></span><br><span class="line"><span class="string">		width:30px;</span></span><br><span class="line"><span class="string">		line-height:30px;</span></span><br><span class="line"><span class="string">		border-radius:15px;</span></span><br><span class="line"><span class="string">		text-align:center;</span></span><br><span class="line"><span class="string">        &amp;.focused&#123;</span></span><br><span class="line"><span class="string">			background:#777;</span></span><br><span class="line"><span class="string">			color: #fff;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="1-3、实现搜索框事件绑定"><a href="#1-3、实现搜索框事件绑定" class="headerlink" title="1.3、实现搜索框事件绑定"></a>1.3、实现搜索框事件绑定</h4><p>接下来实现，通过事件来实现长短切换，首先focused默认时false，然后在NavSearch标签中添加onFocus属性，在constructor实现对this的绑定，然后就可以添加handleInputFocus函数了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">	<span class="keyword">super</span>(props);</span><br><span class="line">	<span class="keyword">this</span>.state=&#123;</span><br><span class="line">		focused:<span class="literal">false</span>,</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">this</span>.handleInputFocus=<span class="keyword">this</span>.handleInputFocus.bind(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&lt;NavSearch </span><br><span class="line">	className=&#123;<span class="keyword">this</span>.state.focused ? <span class="string">'focused'</span>:<span class="string">''</span>&#125;</span><br><span class="line">	onFocus=&#123;<span class="keyword">this</span>.handleInputFocus&#125;&gt;</span><br><span class="line">&lt;<span class="regexp">/NavSearch&gt;</span></span><br><span class="line"><span class="regexp">...</span></span><br><span class="line"><span class="regexp">handleInputFocus()&#123;</span></span><br><span class="line"><span class="regexp">    this.setState(&#123;</span></span><br><span class="line"><span class="regexp">    	focused:true</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这时就实现了当搜索框聚焦时，就会变长，并且搜索按钮背景色变暗。可以失焦时，却没有变短，这很好办，只需添加onBlur属性即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">constructor(props)&#123;</span><br><span class="line">	<span class="keyword">super</span>(props);</span><br><span class="line">	<span class="keyword">this</span>.state=&#123;</span><br><span class="line">		focused:<span class="keyword">false</span>,</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">this</span>.handleInputFocus=<span class="keyword">this</span>.handleInputFocus.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleInputBlur=<span class="keyword">this</span>.handleInputBlur.bind(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&lt;NavSearch </span><br><span class="line">	className=&#123;<span class="keyword">this</span>.state.focused ? <span class="string">'focused'</span>:<span class="string">''</span>&#125;</span><br><span class="line">	onFocus=&#123;<span class="keyword">this</span>.handleInputFocus&#125;</span><br><span class="line">	onBlur=&#123;<span class="keyword">this</span>.handleInputBlur&#125;&gt;</span><br><span class="line">&lt;/NavSearch&gt;</span><br><span class="line">...</span><br><span class="line">handleInputFocus()&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">    	focused:<span class="keyword">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">handleInputBlur()&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">    	focused:<span class="keyword">false</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时就实现了聚焦和失焦的效果，但是此时还没有动画的效果，下面添加动画。</p>
<h4 id="1-4、添加动画变长变短"><a href="#1-4、添加动画变长变短" class="headerlink" title="1.4、添加动画变长变短"></a>1.4、添加动画变长变短</h4><p>首先在控制台，进入jianshu项目，安装react-transition-group的插件，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-transition-group --save</span><br></pre></td></tr></table></figure>
<p>然后在<code>common/header/index.js</code>中引入CSSTransition，然后用CSSTransition将NavSearch包裹起来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; CSSTransition &#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span>;</span><br><span class="line">。。。</span><br><span class="line">&lt;CSSTransition</span><br><span class="line">	<span class="keyword">in</span>=&#123;<span class="keyword">this</span>.state.focused&#125; <span class="comment">//入场动画</span></span><br><span class="line">	timeout=&#123;<span class="number">200</span>&#125; <span class="comment">//动画时长</span></span><br><span class="line">	classNames=<span class="string">"slide"</span></span><br><span class="line">	&gt;</span><br><span class="line">    &lt;NavSearch </span><br><span class="line">        className=&#123;<span class="keyword">this</span>.state.focused ? <span class="string">'focused'</span>:<span class="string">''</span>&#125;</span><br><span class="line">        onFocus=&#123;<span class="keyword">this</span>.handleInputFocus&#125;</span><br><span class="line">        onBlur=&#123;<span class="keyword">this</span>.handleInputBlur&#125;&gt;</span><br><span class="line">    &lt;<span class="regexp">/NavSearch&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>CSSTransition&gt;</span><br></pre></td></tr></table></figure>
<p>此时就会在外层挂载几个样式，然后找到SearchWrapper标签的样式，在<code>common/header/style.js</code>中SearchWrapper标签的样式中设置slide-enter和slide-enter-active设置展开效果，通过slide-exit和slide-exit-active设置缩回效果</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchWrapper=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float:left;</span></span><br><span class="line"><span class="string">	position:relative;</span></span><br><span class="line"><span class="string">    .slide-enter &#123;</span></span><br><span class="line"><span class="string">		width:160px;</span></span><br><span class="line"><span class="string">		transition:all .2s ease-out;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    .slide-enter-active &#123;</span></span><br><span class="line"><span class="string">		width:240px;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">	.slide-exit &#123;</span></span><br><span class="line"><span class="string">		width:240px;</span></span><br><span class="line"><span class="string">		transition:all .2s ease-out;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    .slide-exit-active &#123;</span></span><br><span class="line"><span class="string">		width:160px;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">	.iconfont &#123;</span></span><br><span class="line"><span class="string">		position:absolute;</span></span><br><span class="line"><span class="string">		right:5px;</span></span><br><span class="line"><span class="string">		bottom:5px;</span></span><br><span class="line"><span class="string">		width:30px;</span></span><br><span class="line"><span class="string">		line-height:30px;</span></span><br><span class="line"><span class="string">		border-radius:15px;</span></span><br><span class="line"><span class="string">		text-align:center;</span></span><br><span class="line"><span class="string">		&amp;.focused&#123;</span></span><br><span class="line"><span class="string">			background:#777;</span></span><br><span class="line"><span class="string">			color: #fff;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h3 id="二、使用React-Redux管理数据"><a href="#二、使用React-Redux管理数据" class="headerlink" title="二、使用React-Redux管理数据"></a>二、使用React-Redux管理数据</h3><p>首先我们看CSSTransition标签，它会给内部的NavSearch标签自动添加样式，这些样式在它外层样式（SearchWrapper）中定义，包含slide-enter和slide-enter-active、slide-exit和slide-exit-active。而实际中，应该将这些样式写在NavSearch标签上。</p>
<p>首先我们将SearchWrapper样式中的slide-enter和slide-enter-active、slide-exit和slide-exit-active样式剪切到NavSearch样式中，注意在前面添加<code>&amp;</code>表示同级样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> NavSearch=styled.input.attrs(&#123;</span><br><span class="line">	placeholder:<span class="string">'搜索'</span></span><br><span class="line">&#125;)<span class="string">`</span></span><br><span class="line"><span class="string">	width:160px;</span></span><br><span class="line"><span class="string">	height:38px;</span></span><br><span class="line"><span class="string">	padding:0 35px 0 20px;</span></span><br><span class="line"><span class="string">	box-sizing:border-box;</span></span><br><span class="line"><span class="string">	border:none;</span></span><br><span class="line"><span class="string">	outline:none;</span></span><br><span class="line"><span class="string">	margin-top:9px;</span></span><br><span class="line"><span class="string">	margin-left:20px;</span></span><br><span class="line"><span class="string">	border-radius:19px;</span></span><br><span class="line"><span class="string">	background:#eee;</span></span><br><span class="line"><span class="string">	font-size:14px;</span></span><br><span class="line"><span class="string">	color:#666;</span></span><br><span class="line"><span class="string">	&amp;::placeholder&#123;</span></span><br><span class="line"><span class="string">		color:#999;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	&amp;.focused &#123;</span></span><br><span class="line"><span class="string">        width:240px;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">	&amp;.slide-enter &#123;</span></span><br><span class="line"><span class="string">		width:160px;</span></span><br><span class="line"><span class="string">		transition:all .2s ease-out;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &amp;.slide-enter-active &#123;</span></span><br><span class="line"><span class="string">		width:240px;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">	&amp;.slide-exit &#123;</span></span><br><span class="line"><span class="string">		width:240px;</span></span><br><span class="line"><span class="string">		transition:all .2s ease-out;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &amp;.slide-exit-active &#123;</span></span><br><span class="line"><span class="string">		width:160px;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>这里用到了state来管理数据，如果是小型项目这么写没问题，但是大型项目时需要使用redux来管理数据。为了便于维护，所有的数据尽量放在redux中</p>
<h4 id="2-1-安装使用redux"><a href="#2-1-安装使用redux" class="headerlink" title="2.1 安装使用redux"></a>2.1 安装使用redux</h4><p>首先在jianshu目录先安装redus和react-redux</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//安装redux数据框架</span></span><br><span class="line">npm install --save redux</span><br><span class="line"><span class="comment">//方便在react中使用redux</span></span><br><span class="line">npm install --save react-redux</span><br></pre></td></tr></table></figure>
<p>然后在src目录下创建一个store的文件夹，在store文件夹下创建一个index.js的文件；并且创建一个reducer(<code>src/store/reducer.js</code>)给它</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store=createStore(reducer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时就创建好了store，就需要往store中存数据和取数据 。</p>
<h4 id="2-2-使用store存取数据"><a href="#2-2-使用store存取数据" class="headerlink" title="2.2 使用store存取数据"></a>2.2 使用store存取数据</h4><p>打开<code>src/App.js</code>,引入store，并且从react-redux中引入Provider，然后在reder</p>
<p>函数句将Header标签用Provider包裹起来，设置store属性，表示Provider把store中的数据都提供给了它内部的组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> Header <span class="keyword">from</span> <span class="string">'./common/header/index.js'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">      		&lt;Header /&gt;</span><br><span class="line">      	&lt;<span class="regexp">/Provider&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p>然后在<code>src/common/header/index.js</code>文件中，做一下数据的连接，首先从react-redux引入connect，并且利用connect进行输出</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React , &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line">。。。</span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(Header);</span><br></pre></td></tr></table></figure>
<p>然后就可以清理<code>src/common/header/index.js</code>文件中的数据了，删除里面的数据定义</p>
<p><del>this.state={<br>    focused:false,<br>};</del></p>
<p>在<code>src/store/index.js</code>文件中定义默认的state，包含focus</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=&#123;</span><br><span class="line">	focused:<span class="literal">false</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就把focused的数据放在了redux的仓库里。接着就应该将仓库里的focused映射到props中去，可以在mapStateToProps中操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        focused:state.focused</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时就可以将<code>src/common/header/index.js</code>中涉及focus的数据，改为this.props.focused了。</p>
<p>这时也可以把之前的handle函数全部删除了，因为不直接操作state了。修改onFocus和onBlur，并在mapDispatchToProps中创建相应的action，然后做分发</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;NavSearch </span><br><span class="line">	className=&#123;<span class="keyword">this</span>.props.focused ? <span class="string">'focused'</span>:<span class="string">''</span>&#125;</span><br><span class="line">	onFocus=&#123;<span class="keyword">this</span>.props.handleInputFocus&#125;</span><br><span class="line">	onBlur=&#123;<span class="keyword">this</span>.props.handleInputBlur&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">NavSearch</span>&gt;</span></span></span><br><span class="line">。。。</span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		handleInputFocus()&#123;</span><br><span class="line">			<span class="keyword">const</span> action=&#123;</span><br><span class="line">				type:<span class="string">'search_focus'</span></span><br><span class="line">			&#125;;</span><br><span class="line">			dispatch(action);</span><br><span class="line">		&#125;,</span><br><span class="line">		handleInputBlur()&#123;</span><br><span class="line">			<span class="keyword">const</span> action=&#123;</span><br><span class="line">				type:<span class="string">'search_blur'</span></span><br><span class="line">			&#125;;</span><br><span class="line">			dispatch(action);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在<code>src/store/reducer.js</code>中对action类型进行判断，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=&#123;</span><br><span class="line">	focused:<span class="literal">false</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">if</span>(action.type===<span class="string">'search_focus'</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			focused:<span class="literal">true</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(action.type===<span class="string">'search_blur'</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			focused:<span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时，我们的页面又有聚焦和失焦功能了。 </p>
<p>此时我们也就没必要使用构造函数了，header组件就变成了无状态组件，可以将它变成无状态组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav , NavItem , NavSearch, Addition,Button,SearchWrapper&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CSSTransition &#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Header= <span class="function">(<span class="params">props</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (</span><br><span class="line">			&lt;HeaderWrapper&gt;</span><br><span class="line">				&lt;Logo href=<span class="string">'/'</span>/&gt;</span><br><span class="line">				&lt;Nav&gt;</span><br><span class="line">				    &lt;NavItem className=<span class="string">'left active'</span>&gt;首页&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">				    &lt;NavItem className='left'&gt;下载App&lt;/</span>NavItem&gt;</span><br><span class="line">				    &lt;NavItem className=<span class="string">'right'</span>&gt;登陆&lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">				    &lt;NavItem className='right'&gt;</span></span><br><span class="line"><span class="regexp">				    	&lt;i className='iconfont'&gt;&amp;#xe636;&lt;/i</span>&gt;</span><br><span class="line">				    &lt;<span class="regexp">/NavItem&gt;</span></span><br><span class="line"><span class="regexp">				    &lt;SearchWrapper&gt;</span></span><br><span class="line"><span class="regexp">				    	&lt;CSSTransition</span></span><br><span class="line"><span class="regexp">							in=&#123; props.focused &#125;</span></span><br><span class="line"><span class="regexp">							timeout=&#123;200&#125;</span></span><br><span class="line"><span class="regexp">							classNames="slide"</span></span><br><span class="line"><span class="regexp">							&gt;</span></span><br><span class="line"><span class="regexp">						    &lt;NavSearch </span></span><br><span class="line"><span class="regexp">						    	className=&#123;props.focused ? 'focused':''&#125;</span></span><br><span class="line"><span class="regexp">						    	onFocus=&#123;props.handleInputFocus&#125;</span></span><br><span class="line"><span class="regexp">						    	onBlur=&#123;props.handleInputBlur&#125;&gt;&lt;/</span>NavSearch&gt;</span><br><span class="line">					    &lt;<span class="regexp">/CSSTransition&gt;</span></span><br><span class="line"><span class="regexp">					    &lt;i className=&#123;props.focused ? 'focused iconfont':'iconfont'&#125;&gt;&amp;#xe6dd;&lt;/i</span>&gt;</span><br><span class="line">				    &lt;<span class="regexp">/SearchWrapper&gt;</span></span><br><span class="line"><span class="regexp">				&lt;/</span>Nav&gt;</span><br><span class="line">				&lt;Addition&gt;</span><br><span class="line">					&lt;Button className=<span class="string">'writting'</span>&gt;</span><br><span class="line">						&lt;i className='iconfont'&gt;&amp;#xe60e;&lt;/i&gt;</span><br><span class="line">						写文章</span><br><span class="line">					&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">					&lt;Button className='reg'&gt;注册&lt;/</span>Button&gt;</span><br><span class="line">				&lt;<span class="regexp">/Addition&gt;</span></span><br><span class="line"><span class="regexp">			&lt;/</span>HeaderWrapper&gt;</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		focused:state.focused</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		handleInputFocus()&#123;</span><br><span class="line">			<span class="keyword">const</span> action=&#123;</span><br><span class="line">				type:<span class="string">'search_focus'</span></span><br><span class="line">			&#125;;</span><br><span class="line">			dispatch(action);</span><br><span class="line">		&#125;,</span><br><span class="line">		handleInputBlur()&#123;</span><br><span class="line">			<span class="keyword">const</span> action=&#123;</span><br><span class="line">				type:<span class="string">'search_blur'</span></span><br><span class="line">			&#125;;</span><br><span class="line">			dispatch(action);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps,mapDispatchToProps)(Header);</span><br></pre></td></tr></table></figure>
<p>这时我们还不能使用redux开发者工具，怎么办呢，使用<strong>redux-devtools-extension</strong>,这时需哟啊对store对什么处理呢？从redux中引入compose，然后使用composeEnhancers增强功能即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, compose &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;</span><br><span class="line"><span class="keyword">const</span> store=createStore(reducer,composeEnhancers());</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<p>####2.3 reducer分类 </p>
<p>reducer可以看作管理员手册，但是当手册管理内容增多时，怎么办呢？可以对手册作个分类，这样图书馆管理员再次查找手册时，就可以先找分类，然后再找内容。redux就可以将一个reducer拆分成很多小的reducer。</p>
<p>因为focused就是header的数据，我们可以在<code>src/common/header/</code>下创建文件夹store，并在里面创建reducer.js的文件，然后将<code>src/store/reducer</code>中的数据剪切到<code>src/common/header/store/reducer.js</code>之中。</p>
<p>这时<code>src/store/reducer</code>已经为空，项目也会报错，相当于把<code>src/store/reducer</code>中的笔记本拆分出去了，这里如何将拆分出去的笔记本整合起来呢？Redux提供了combineReducers使用，它可以将很多小的reducer合并成大的reducer，可以在<code>src/store/reducer</code>中如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> headerReducer <span class="keyword">from</span> <span class="string">'../common/header/store/reducer.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers(&#123;</span><br><span class="line">	header:headerReducer</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>此时页面也恢复正常了，通过<strong>redux-devtools-extension</strong>工具可以看到focused位于了header下，而不再是顶层。但是这时搜索框的动画却没了，怎么回事呢</p>
<p>因为我们在<code>src/common/header/index.js</code>中的mapStateToProps是直接使用state 下的focused，这里需要将它们改造成state.header.focused</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		focused:state.header.focused</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时我们的页面就恢复正常了</p>
<h4 id="2-3-总结1"><a href="#2-3-总结1" class="headerlink" title="2.3 总结1"></a>2.3 总结1</h4><p>我们可以对每一部分，创建自己的reducer，然后在总的reducer中引入各个部分的reducer，并利用redex的combineReducers来创建一个总的reducer，并输出</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> headerReducer <span class="keyword">from</span> <span class="string">'../common/header/store/reducer.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer=combineReducers(&#123;</span><br><span class="line">	header:headerReducer</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer;</span><br></pre></td></tr></table></figure>
<p>这里还有一个可优化的地方，我们看到在引入headerReducer时路径非常长，我们可以在<code>src/common/header/store</code>下新建一个index.js的文件，然后在里面引入自己的reducer，并且输出；然后我们在总的reducer文件中就可以直接引用该<code>src/common/header/store</code>就可以，它会自动寻找该路径下的index.js文件；为了避免命名冲突可以使用as关键字。</p>
<p><code>src/common/header/store/index.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; reducer &#125;;</span><br></pre></td></tr></table></figure>
<p><code>src/store/index.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line">~~<span class="keyword">import</span> headerReducer <span class="keyword">from</span> <span class="string">'../common/header/store/reducer.js'</span>;~~</span><br><span class="line"><span class="keyword">import</span> &#123; reducer <span class="keyword">as</span> headerReducer &#125; <span class="keyword">from</span> <span class="string">'../common/header/store'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers(&#123;</span><br><span class="line">	header:headerReducer</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="2-4-使用actionCreator创建action"><a href="#2-4-使用actionCreator创建action" class="headerlink" title="2.4 使用actionCreator创建action"></a>2.4 使用actionCreator创建action</h4><p>这里还要注意，创建action时尽量不要使用字符串，我们使用actionCreator来通过常量创建action。</p>
<p>我们在<code>src/common/header/store/</code>下创建一个名为<code>actionCreators.js</code>的文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> searchFocus=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:<span class="string">'search_focus'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> searchBlur=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:<span class="string">'search_blur'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然后在<code>src/common/header/index.js</code>中引入该creator，然后修改mapDispatchToProps中相应ation的创建</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'./store/actionCreators'</span>;</span><br><span class="line">。。。</span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		handleInputFocus()&#123;</span><br><span class="line">			<span class="keyword">const</span> action=actionCreators.searchFocus();</span><br><span class="line">			dispatch(action);</span><br><span class="line">		&#125;,</span><br><span class="line">		handleInputBlur()&#123;</span><br><span class="line">			<span class="keyword">const</span> action=actionCreators.searchBlur();</span><br><span class="line">			dispatch(action);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更进一步，将<code>src/common/header/store/actionCreator.js</code>中的type用常量给替换掉。在</p>
<p><code>src/common/header/store/</code>下创建一个constants.js的文件；并且在<code>src/common/header/store/actionCreator.js</code>和在<code>src/common/header/store/reducer.js</code>文件中 中引用该常量；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SEARCH_FOCUS=<span class="string">'header/SEARCH_FOCUS'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SEARCH_BLUR=<span class="string">'header/SEARCH_BLUR'</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> constants <span class="keyword">from</span> <span class="string">'./constants.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> searchFocus=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:constants.SEARCH_FOCUS</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> searchBlur=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:constants.SEARCH_BLUR</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> constants <span class="keyword">from</span> <span class="string">'./constants.js'</span>;</span><br><span class="line"><span class="keyword">const</span> defaultState=&#123;</span><br><span class="line">	focused:<span class="literal">false</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">if</span>(action.type===constants.SEARCH_FOCUS)&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			focused:<span class="literal">true</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(action.type===constants.SEARCH_BLUR)&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			focused:<span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意，这里我们在<code>src/common/header/index.js</code>中引用了<code>src/common/header/store/actionCreator.js</code>文件中的内容，而我们希望store下只有一个出口文件，而不是一个一个引入store下具体的文件，我们在<code>src/common/header/store/index.js</code>中作统一处理,这样这个index文件就引入了store文件夹下的所有内容，在外部只需引入这一个index文件即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer.js'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actionCreators <span class="keyword">from</span> <span class="string">'./actionCreators.js'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> constants <span class="keyword">from</span> <span class="string">'./constants.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; reducer , actionCreators , constants&#125;;</span><br></pre></td></tr></table></figure>
<p>这时也需要将<code>src/common/header/index.js</code>中引入的creator换一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~~import * as actionCreators from &apos;./store/actionCreators&apos;;~~</span><br><span class="line">improt &#123;actionCreators&#125; from &apos;./store/index.js&apos;;</span><br></pre></td></tr></table></figure>
<h4 id="2-5-总结2"><a href="#2-5-总结2" class="headerlink" title="2.5 总结2"></a>2.5 总结2</h4><p>这时，store文件夹下的内容就非常清晰了，将所有输出都通过index.js作统一处理，外部只需要引用index.js文件就可以。</p>
<h4 id="2-6-使用immutable来管理store中的数据"><a href="#2-6-使用immutable来管理store中的数据" class="headerlink" title="2.6 使用immutable来管理store中的数据"></a>2.6 使用immutable来管理store中的数据</h4><p>reducer只能获取state中的数据，而不能改变原始state中的数据，而时创建一个新的state返回。这样很容易出错，immutable就是解决这个问题。</p>
<p>immutable就是不可变更的，如果将state设成immutable，那么这个state就是不可改变的，这样reducer就不会出现问题 ，</p>
<p>首先安装immutable.js，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install immutable</span><br><span class="line"><span class="comment">//或</span></span><br><span class="line">yarn add immutable</span><br></pre></td></tr></table></figure>
<p>接下来就需要将state变成immutable对象了，来到<code>src/common/header/store/reducer.js</code>,引入immutable中的fromJS，他可以帮助我们把一个js对象转化为一个immutable对象，然后就可以将defaultState转化为immutable对象了 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromJS &#125; <span class="keyword">from</span> <span class="string">'immutable'</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> defaultState=fromJS(&#123;</span><br><span class="line">    focused:<span class="literal">false</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然后打开<code>src/common/header/index.js</code>文件，修改里面mapStateToProps方法中的数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        ~~focused:state.header.focused~~</span><br><span class="line">        focused:state.header.get(<span class="string">'focused '</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是此时，点击搜索框还是会报错，这是由于这时在reducer中返回的是普通对象，需要使用immutable的set方法来做更改，immutable对象set方法会结合之前immutable对象的值和设置的值返回一个全新的对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">if</span>(action.type===constants.SEARCH_FOCUS)&#123;</span><br><span class="line">		<span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(action.type===constants.SEARCH_BLUR)&#123;</span><br><span class="line">		<span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">false</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就可以避免不小心更改state的错误了。</p>
<h4 id="2-7-使用redux-immutable统一数据格式"><a href="#2-7-使用redux-immutable统一数据格式" class="headerlink" title="2.7 使用redux-immutable统一数据格式"></a>2.7 使用redux-immutable统一数据格式</h4><p>我们注意看一下 focused:state.header.get(‘focused ‘)这个代码，state是一个js对象，而state.header是一个immutable对象，所以要调用focused的时候需要xian 调用.再调用.get()。这种混在的方式不是很好。</p>
<p>我们可以考虑将state变成immutable对象，也就是对<code>src/store/reduce.js</code>，这时我们需要依赖一个第三方的模块，redux-immutable，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install redux-immutable</span><br></pre></td></tr></table></figure>
<p>之前我们redux从redux中来，赖在我们修改它从redux-immutable中来</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~~<span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;~~</span><br><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux-immutable'</span>;</span><br></pre></td></tr></table></figure>
<p>但是此时页面会报错，我们需要改变一下<code>src/common/header/index.js</code>，里面的state方法就不能用.了，需要用get()方法了，这样整个对数据的操作就统一了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        focused:state.get(<span class="string">'header'</span>).get(<span class="string">'focused '</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>immutable中还有很多写法，比如可以将<code>focused:state.get(&#39;header&#39;).get(&#39;focused &#39;)</code>用getIn方法改写<code>focused:state.getIn([&#39;header&#39;,&#39;focused&#39;])</code>，数组表示取header下面的focused项。</p>
<h3 id="三、热门搜索布局"><a href="#三、热门搜索布局" class="headerlink" title="三、热门搜索布局"></a>三、热门搜索布局</h3><p>当我们鼠标聚焦在搜索框时，会弹出热门搜索框，，接下来我们做搜索部分的热门搜索的布局。</p>
<h4 id="3-1-添加SearchInfo"><a href="#3-1-添加SearchInfo" class="headerlink" title="3.1 添加SearchInfo"></a>3.1 添加SearchInfo</h4><p>首先我们需要在<code>src/common/header/index.js</code>中添加一个SearchInfo组件，并且在style中添加这个组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav , NavItem , NavSearch, Addition,Button,SearchWrapper,SearchInfo&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">...</span><br><span class="line">				&lt;SearchWrapper&gt;</span><br><span class="line">				    	&lt;CSSTransition</span><br><span class="line">							<span class="keyword">in</span>=&#123; props.focused &#125;</span><br><span class="line">							timeout=&#123;<span class="number">200</span>&#125;</span><br><span class="line">							classNames=<span class="string">"slide"</span></span><br><span class="line">							&gt;</span><br><span class="line">						    &lt;NavSearch </span><br><span class="line">						    	className=&#123;props.focused ? <span class="string">'focused'</span>:<span class="string">''</span>&#125;</span><br><span class="line">						    	onFocus=&#123;props.handleInputFocus&#125;</span><br><span class="line">						    	onBlur=&#123;props.handleInputBlur&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">NavSearch</span>&gt;</span></span></span><br><span class="line">					    &lt;<span class="regexp">/CSSTransition&gt;</span></span><br><span class="line"><span class="regexp">					    &lt;i className=&#123;props.focused ? 'focused iconfont':'iconfont'&#125;&gt;&amp;#xe6dd;&lt;/i</span>&gt;</span><br><span class="line">				    	&lt;SearchInfo&gt;<span class="xml"><span class="tag">&lt;/<span class="name">SearchInfo</span>&gt;</span></span></span><br><span class="line">				    &lt;<span class="regexp">/SearchWrapper&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后打开<code>src/common/header/style.js</code>中编写SearchInfo</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfo=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	position:absolute;</span></span><br><span class="line"><span class="string">	left:0;</span></span><br><span class="line"><span class="string">	top:50px;</span></span><br><span class="line"><span class="string">	width:240px;</span></span><br><span class="line"><span class="string">	height:100px;</span></span><br><span class="line"><span class="string">	padding:0 20px;</span></span><br><span class="line"><span class="string">	background:green;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>然后设置阴影，从简书官网获取，添加阴影，就可以去掉background了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfo=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	position:absolute;</span></span><br><span class="line"><span class="string">	left:0;</span></span><br><span class="line"><span class="string">	top:50px;</span></span><br><span class="line"><span class="string">	width:240px;</span></span><br><span class="line"><span class="string">	height:100px;</span></span><br><span class="line"><span class="string">	padding:0 20px;</span></span><br><span class="line"><span class="string">	box-shadow: 0 0 8px rgba(0,0,0,.2);</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-2-添加SearchInfoTitle"><a href="#3-2-添加SearchInfoTitle" class="headerlink" title="3.2 添加SearchInfoTitle"></a>3.2 添加SearchInfoTitle</h4><p>然后在SearchInfo里面添加新标签SearchInfoTitle了</p>
<p>首先在<code>src/common/header/index.js</code>SearchInfo组件内添加SearchInfoTitle，并且引入SearchInfoTitle，然后在style中定义该title</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav , NavItem , NavSearch, Addition,Button,SearchWrapper,SearchInfo,SearchInfoTitle&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">。。。</span><br><span class="line">&lt;SearchInfo&gt;</span><br><span class="line">	&lt;SearchInfoTitle&gt;热门搜索&lt;<span class="regexp">/SearchInfoTitle&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>SearchInfo&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfoTitle=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	margin-top:20px;</span></span><br><span class="line"><span class="string">	margin-bottom:15px;</span></span><br><span class="line"><span class="string">	line-height:20px;</span></span><br><span class="line"><span class="string">	font-size:14px;</span></span><br><span class="line"><span class="string">	color: #969696;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-3-添加写换一批"><a href="#3-3-添加写换一批" class="headerlink" title="3.3 添加写换一批"></a>3.3 添加写换一批</h4><p>我们在SearchInfoTitle中添加组件SearchInfoSwitch组件，同样引入并定义该样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav , NavItem , NavSearch, Addition,Button,SearchWrapper,SearchInfo,SearchInfoTitle, SearchInfoSwitch&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">。。。</span><br><span class="line">&lt;SearchInfo&gt;</span><br><span class="line">	&lt;SearchInfoTitle&gt;热门搜索</span><br><span class="line">	&lt;SearchInfoSwitch&gt;换一批&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>SearchInfoTitle&gt;</span><br><span class="line">&lt;<span class="regexp">/SearchInfo&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfoSwitch=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float: right;</span></span><br><span class="line"><span class="string">    font-size: 13px;</span></span><br><span class="line"><span class="string">    color: #969696;</span></span><br><span class="line"><span class="string">    background-color: transparent;</span></span><br><span class="line"><span class="string">    border-width: 0;</span></span><br><span class="line"><span class="string">    padding: 0;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-4-添加提示内容"><a href="#3-4-添加提示内容" class="headerlink" title="3.4 添加提示内容"></a>3.4 添加提示内容</h4><p>然后在SearchInfoTitle下方添加一个div，并且在里面添加组件SearchInfoItem，同样引入并创建该样式，它是一个a标签</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav , NavItem , NavSearch, Addition,Button,SearchWrapper,SearchInfo,SearchInfoTitle, SearchInfoSwitch, SearchInfoItem&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">。。。</span><br><span class="line">&lt;SearchInfo&gt;</span><br><span class="line">	&lt;SearchInfoTitle&gt;热门搜索</span><br><span class="line">	&lt;SearchInfoSwitch&gt;换一批&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>SearchInfoTitle&gt;</span><br><span class="line">	&lt;div&gt;</span><br><span class="line">		&lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">		&lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">		&lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">		&lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">		&lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">		&lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>SearchInfo&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfoItem=styled.a<span class="string">`</span></span><br><span class="line"><span class="string">	display:block;</span></span><br><span class="line"><span class="string">	float:left;</span></span><br><span class="line"><span class="string">	line-height:20px;</span></span><br><span class="line"><span class="string">	padding:0 5px;</span></span><br><span class="line"><span class="string">	margin-right:10px;</span></span><br><span class="line"><span class="string">	margin-bottom:15px;</span></span><br><span class="line"><span class="string">	font-size:12px;</span></span><br><span class="line"><span class="string">	border:1px solid #ddd;</span></span><br><span class="line"><span class="string">	color:#333;</span></span><br><span class="line"><span class="string">	border-radius:3px;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-5-添加SearchInfoList"><a href="#3-5-添加SearchInfoList" class="headerlink" title="3.5 添加SearchInfoList"></a>3.5 添加SearchInfoList</h4><p>这时发现item越界了，这时由于在外层SearchInfo中把高度写死了，去掉下面的height就可以了。这时就可以了 。</p>
<p>这时我们将外层的div改为SearchInfoList，引入并创建该样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HeaderWrapper , Logo , Nav , NavItem , NavSearch, Addition,Button,SearchWrapper,SearchInfo,SearchInfoTitle, SearchInfoSwitch, SearchInfoItem, SearchInfoList&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span>;</span><br><span class="line">。。。</span><br><span class="line">&lt;SearchInfo&gt;</span><br><span class="line">	&lt;SearchInfoTitle&gt;热门搜索</span><br><span class="line">	&lt;SearchInfoSwitch&gt;换一批&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>SearchInfoTitle&gt;</span><br><span class="line">	&lt;SearchInfoList&gt;</span><br><span class="line">		&lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">		&lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">		&lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">		&lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">		&lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">		&lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">    &lt;<span class="regexp">/SearchInfoList&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>SearchInfo&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfoList=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	overflow:hidden;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-6-聚焦显示失焦隐藏"><a href="#3-6-聚焦显示失焦隐藏" class="headerlink" title="3.6 聚焦显示失焦隐藏"></a>3.6 聚焦显示失焦隐藏</h4><p>我们在<code>src/common/header/index.js</code>中声明一个方法，getListArea，接受一个参数，参数是真就返回列表，参数为假就不返回列表，然后在之前SearchInfo标签处添加该方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getListArea=<span class="function">(<span class="params">show</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(show)&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;SearchInfo&gt;</span><br><span class="line">                &lt;SearchInfoTitle&gt;热门搜索</span><br><span class="line">                &lt;SearchInfoSwitch&gt;换一批&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>SearchInfoTitle&gt;</span><br><span class="line">                &lt;SearchInfoList&gt;</span><br><span class="line">                    &lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">                    &lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">                    &lt;SearchInfoItem&gt;教育&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;SearchInfoItem&gt;教育&lt;/</span>SearchInfoItem&gt;</span><br><span class="line">                &lt;<span class="regexp">/SearchInfoList&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>SearchInfo&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">。。。</span><br><span class="line">				&lt;SearchWrapper&gt;</span><br><span class="line">				    	&lt;CSSTransition</span><br><span class="line">							。。。</span><br><span class="line">					    &lt;<span class="regexp">/CSSTransition&gt;</span></span><br><span class="line"><span class="regexp">					    &lt;i className=&#123;props.focused ? 'focused iconfont':'iconfont'&#125;&gt;&amp;#xe6dd;&lt;/i</span>&gt;</span><br><span class="line">				    	&#123;getListArea(props.focused)&#125;</span><br><span class="line">				    &lt;<span class="regexp">/SearchWrapper&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样热门搜索框就做好了。</p>
<h4 id="3-7-再次换一批"><a href="#3-7-再次换一批" class="headerlink" title="3.7 再次换一批"></a>3.7 再次换一批</h4><p>header会越来约庞大，如果还用无状态组件的话会特别麻烦，需要将它换成一个常规的Component组件，继承自component，在render函数中直接返回就可以;</p>
<p>这里面也没有props这个参数了，需要将它们全部转为this.props；</p>
<p>同时需要将getListArea方法，添加到累内部，在调用的地方换为this.getListArea</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...</span><br></pre></td></tr></table></figure>
<p>当我们第一次聚焦input框的时候，会发送ajax请求，获取热门搜索关键字，再次聚焦的时候不会发送请求，而是直接使用之前的关键字。</p>
<p>所以在header的reducer中不仅要保存focus的数据，还要保存热门关键字数组list，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=fromJS(&#123;</span><br><span class="line">	focused:<span class="literal">false</span>，</span><br><span class="line">	list:[]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>而发送ajax请求，我们统一放在redux-thunk中去处理，首先安装redux-thunk</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install redux-thunk</span><br></pre></td></tr></table></figure>
<p>它应该在创建store时被使用，我们是在<code>src/index.js</code>中创建的store，在里面引入并使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, compose , applyMiddleware&#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;</span><br><span class="line"><span class="keyword">const</span> store=createStore(reducer,composeEnhancers(</span><br><span class="line">		applyMiddleware(thunk)</span><br><span class="line">	));</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<p>然后就可以在action中做异步操作了，来到<code>src/common/header/index.js</code>文件，在mapDispatchToProps方法中派发一个action，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		handleInputFocus()&#123;</span><br><span class="line">			dispatch(actionCreators.getList());</span><br><span class="line">			dispatch(actionCreators.searchFocus());</span><br><span class="line">		&#125;,</span><br><span class="line">		handleInputBlur()&#123;</span><br><span class="line">			dispatch(actionCreators.searchBlur());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并且在actionCreators.js文件中添加一个函数，之前时返回一个对象，现在不返回对象了而是返回一个函数，在这个函数中发出一个一步请求，这就可以使用一个第三方模块axios了，首先安装</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getList=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">		axios.get(<span class="string">'api/headerList.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;<span class="comment">//成功</span></span><br><span class="line"></span><br><span class="line">		&#125;).catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;<span class="comment">//失败</span></span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">"error"</span>);</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时很明显不会获取到数据，因为我们没有这个后台接口，这时我们可以利用create-react来模拟数据，首先在public目录下创建一个文件夹api，在里面创建一个问价headList.json，在里面随意添加几个文字，这时在浏览器中输入localhost:3000/api/headerList.json，就可以访问你写入的内容了。通过这个特性我们可以写一些假数据</p>
<p>在json文件中添加：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">'success'</span>:ture,</span><br><span class="line">	<span class="string">"data"</span>:[<span class="string">"行距杯2018征文"</span>,<span class="string">"区块链"</span>,<span class="string">"小程序"</span>,<span class="string">"vue"</span>,<span class="string">"毕业"</span>,<span class="string">"PHP"</span>,<span class="string">"故事"</span>,<span class="string">"flutter"</span>,<span class="string">"理财"</span>,<span class="string">"美食"</span>,<span class="string">"投稿"</span>,<span class="string">"手帐"</span>,<span class="string">"书法"</span>,<span class="string">"PPT"</span>,<span class="string">"穿搭"</span>,<span class="string">"打碗碗花"</span>,<span class="string">"简书"</span>,<span class="string">"姥姥的澎湖湾"</span>,<span class="string">"设计"</span>,<span class="string">"创业"</span>,<span class="string">"交友"</span>,<span class="string">"籽盐"</span>,<span class="string">"教育"</span>,<span class="string">"思维导图"</span>,<span class="string">"疯哥哥"</span>,<span class="string">"梅西"</span>,<span class="string">"时间管理"</span>,<span class="string">"golang"</span>,<span class="string">"连载"</span>,<span class="string">"自律"</span>,<span class="string">"职场"</span>,<span class="string">"考研"</span>,<span class="string">"慢世人"</span>,<span class="string">"悦欣"</span>,<span class="string">"一纸vr"</span>,<span class="string">"spring"</span>,<span class="string">"eos"</span>,<span class="string">"足球"</span>,<span class="string">"程序员"</span>,<span class="string">"林露含"</span>,<span class="string">"彩铅"</span>,<span class="string">"金融"</span>,<span class="string">"木风杂谈"</span>,<span class="string">"日更"</span>,<span class="string">"成长"</span>,<span class="string">"外婆是方言"</span>,<span class="string">"docker"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时我们就能在请求成功之后派发action了，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.get(&apos;api/headerList.json&apos;).then((res)=&gt;&#123;//成功</span><br><span class="line">	const data=res.data;</span><br><span class="line">	const action=&#123;</span><br><span class="line">        type:&apos;change_list&apos;,</span><br><span class="line">        data:data.data</span><br><span class="line">	&#125;</span><br><span class="line">	dispatch(action);</span><br><span class="line">&#125;).catch(()=&gt;&#123;//失败</span><br><span class="line">    console.log(&quot;error&quot;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>由于请求本身就是在actionCreators.js文件中的，所以可以这么改：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> changeList=<span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">    type:constants.CHANGE_LIST,</span><br><span class="line">    data</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">axios.get(<span class="string">'api/headerList.json'</span>).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;<span class="comment">//成功</span></span><br><span class="line">	<span class="keyword">const</span> data=res.data;</span><br><span class="line">	dispatch(changeList(data));</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;<span class="comment">//失败</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"error"</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>接下来就可以去<code>src/common/header/store/reducer.js</code>中继续写代码了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.type===constants.CHANGE_LIST)&#123;</span><br><span class="line">		<span class="keyword">return</span> state.set(<span class="string">'list'</span>,action.data);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>注意这么写肯定是有问题的，因为我们在defaultState是一个immutable对象，里面的list也是一个immutable对象，而action.data是一个普通的js数组，可定会出错的。解决方法很简单，只需要在actionCreators.js中将data变成一个immutable对象就可以了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;fromJS&#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</span><br><span class="line"><span class="keyword">const</span> changeList=<span class="function">(<span class="params">data</span>)=&gt;</span>(&#123;</span><br><span class="line">    type: constants.CHANGE_LIST,</span><br><span class="line">    data: fromJS(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>然后就可以在<code>src/common/header/index.js</code>中取数据了</p>
<p>在mapStateToProps方法中补充list属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		focused:state.get(<span class="string">'header'</span>).get(<span class="string">'focused'</span>),</span><br><span class="line">		list:state.getIn([<span class="string">'header'</span>,<span class="string">'list'</span>])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后修改getListArea，首先将参数去掉直接在方法内部调用this.props.focused，然后将SearchInfoList内部写一个循环表达式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">getListArea()&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.props.focused)&#123;</span><br><span class="line">	    	<span class="keyword">return</span> (</span><br><span class="line">		        &lt;SearchInfo&gt;</span><br><span class="line">		            &lt;SearchInfoTitle&gt;热门搜索</span><br><span class="line">		            &lt;SearchInfoSwitch&gt;换一批&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br><span class="line"><span class="regexp">		            &lt;/</span>SearchInfoTitle&gt;</span><br><span class="line">		            &lt;SearchInfoList&gt;</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">this</span>.props.list.map(<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</span><br><span class="line">                            	<span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">SearchInfoItem</span> <span class="attr">key</span>=<span class="string">&#123;item&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">SearchInfoItem</span>&gt;</span></span></span><br><span class="line">                        	&#125;)</span><br><span class="line">                        &#125;</span><br><span class="line">		            &lt;<span class="regexp">/SearchInfoList&gt;</span></span><br><span class="line"><span class="regexp">		        &lt;/</span>SearchInfo&gt;</span><br><span class="line">	        )</span><br><span class="line">	    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">&#123; <span class="keyword">this</span>.getListArea() &#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-8-简化代码"><a href="#3-8-简化代码" class="headerlink" title="3.8 简化代码"></a>3.8 简化代码</h4><p>（1）</p>
<p>这时我们的<code>src/common/header/store/actionCreators.js</code>中大部分内容需要暴漏出去，但是像changeList的方法不用暴漏出去。像这种不暴漏的方法建议要么都放在顶部要么都放在底部；</p>
<p>（2）</p>
<p>在<code>src/common/header/index.js</code>中，导出都用this.props.list或this.props.focused，其实可以精简一下，在getListArea方法中添加入戏内容，这样就无需每次都使用this.props.XXX了，就可以直接使用focused和list了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">getListArea()&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;focused,list&#125;=<span class="keyword">this</span>.props;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同理在render方法中我们可以使用，来简化</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">render()&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;focused,handlerInputFocused,handlerInputBlur&#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（3）</p>
<p>在<code>src/common/header/store/reducer.js</code>文件中，大量的使用了if语句，可以使用switch语句来做替换</p>
<h4 id="3-9-实现换一批功能"><a href="#3-9-实现换一批功能" class="headerlink" title="3.9 实现换一批功能"></a>3.9 实现换一批功能</h4><h6 id="3-9-1给提示框分页"><a href="#3-9-1给提示框分页" class="headerlink" title="3.9.1给提示框分页"></a>3.9.1给提示框分页</h6><p>我们热门索搜提示显示了所有的内容，而简书官网每次只显示十个内容。我们先在<code>src/common/header/store/reducer.js</code>文件中给defaultStatus添加page和totalPage两个属性，表示当前页码和总页数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=fromJS(&#123;</span><br><span class="line">	focused:<span class="literal">false</span>,</span><br><span class="line">	list:[],</span><br><span class="line">	page:<span class="number">1</span>,</span><br><span class="line">	totalPage:<span class="number">1</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然后在<code>src/common/header/store/actionCreators.js</code>文件中给changeList方法，补充totalPage属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> changeList=<span class="function">(<span class="params">data</span>)=&gt;</span>(&#123;</span><br><span class="line">    type: constants.CHANGE_LIST,</span><br><span class="line">    data: fromJS(data),</span><br><span class="line">    totalPage:<span class="built_in">Math</span>.ceil(data.length/<span class="number">10</span>),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这样当取完列表项数据时，就可以知道总页数了；action会被派发给reducer，需要在<code>src/common/header/store/reducer.js</code>中对CHANGE_LIST方法不仅哟啊改变list，而且还要改变totalPage内容</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">switch</span>(action.type)&#123;</span><br><span class="line">		<span class="keyword">case</span> constants.SEARCH_FOCUS:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">true</span>);</span><br><span class="line">		<span class="keyword">case</span> constants.SEARCH_BLUR:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">false</span>);</span><br><span class="line">		<span class="keyword">case</span> constants.CHANGE_LIST:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'list'</span>,action.data).set(<span class="string">"totalPage"</span>,action.totalPage);</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">return</span> state;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在<code>src/common/header/index.js</code>拿到page页码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		focused:state.get(<span class="string">'header'</span>).get(<span class="string">'focused'</span>),</span><br><span class="line">		list:state.getIn([<span class="string">'header'</span>,<span class="string">'list'</span>]),</span><br><span class="line">		page:state.getIn([<span class="string">'header'</span>,<span class="string">'page'</span>]),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在getListArea中使用page，来创建10个item，放置在相应位置。注意list由于是immutable对象不能直接使用下标，需要将它转化为js对象才能使用下标形式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">getListArea()&#123;</span><br><span class="line">		<span class="keyword">const</span> &#123;focused,list,page&#125;=<span class="keyword">this</span>.props;</span><br><span class="line">		<span class="keyword">const</span> newList=list.toJS();</span><br><span class="line">		<span class="keyword">const</span> pageList=[];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> i = (page<span class="number">-1</span>)*<span class="number">10</span>; i &lt;page*<span class="number">10</span>; i++) &#123;</span><br><span class="line">			pageList.push(</span><br><span class="line">				&lt;SearchInfoItem key=&#123;newList[i]&#125;&gt;&#123;newList[i]&#125;&lt;<span class="regexp">/SearchInfoItem&gt;</span></span><br><span class="line"><span class="regexp">			);</span></span><br><span class="line"><span class="regexp">		&#125;</span></span><br><span class="line"><span class="regexp">		if(focused)&#123;</span></span><br><span class="line"><span class="regexp">	    	return (</span></span><br><span class="line"><span class="regexp">		        &lt;SearchInfo&gt;</span></span><br><span class="line"><span class="regexp">		            &lt;SearchInfoTitle&gt;热门搜索</span></span><br><span class="line"><span class="regexp">		            	&lt;SearchInfoSwitch&gt;换一批&lt;/</span>SearchInfoSwitch&gt;</span><br><span class="line">		            &lt;<span class="regexp">/SearchInfoTitle&gt;</span></span><br><span class="line"><span class="regexp">		            &lt;SearchInfoList&gt;</span></span><br><span class="line"><span class="regexp">		                &#123;</span></span><br><span class="line"><span class="regexp">                            pageList</span></span><br><span class="line"><span class="regexp">                        &#125;</span></span><br><span class="line"><span class="regexp">		            &lt;/</span>SearchInfoList&gt;</span><br><span class="line">		        &lt;<span class="regexp">/SearchInfo&gt;</span></span><br><span class="line"><span class="regexp">	        )</span></span><br><span class="line"><span class="regexp">	    &#125;else&#123;</span></span><br><span class="line"><span class="regexp">	        return null;</span></span><br><span class="line"><span class="regexp">	    &#125;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br></pre></td></tr></table></figure>
<p>此时我们的热门索搜提示就展示10条内容了。</p>
<h6 id="3-9-1实现换一批换页"><a href="#3-9-1实现换一批换页" class="headerlink" title="3.9.1实现换一批换页"></a>3.9.1实现换一批换页</h6><p>此时我们点击换一批，发现提示框直接消失了；简书官网则不是这样的，只有在鼠标移出搜索框时才隐藏。所有提示框不仅仅是依赖focused来隐藏的，我们需要额外监听一个属性，鼠标是否在提示框内mouseIn，首先给<code>src/common/header/store/reducer.js</code>添加mouseIn属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> defaultState=fromJS(&#123;</span><br><span class="line">	focused:<span class="literal">false</span>,</span><br><span class="line">	list:[],</span><br><span class="line">	mouseIn:<span class="literal">false</span>,</span><br><span class="line">	page:<span class="number">1</span>,</span><br><span class="line">	totalPage:<span class="number">1</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>给constants添加MOUSE_IN和MOUSE_OUT常量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> MOUSE_IN=<span class="string">"header/MOUSE_IN"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> MOUSE_OUT=<span class="string">"header/MOUSE_OUT"</span>;</span><br></pre></td></tr></table></figure>
<p>给SearchInfo添加onMouseEnter和onMouseLeave;在mapStateToProps中引入mouseIn；在mapDispatchToProps中添加handlerMouseEnter,handlerMouseLeave操作；在actionCreators中创建mouseEnter和mouseLeave事件；在reducer中处理这两个事件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;focused,list,page,handlerMouseEnter,handlerMouseLeave&#125;=<span class="keyword">this</span>.props;</span><br><span class="line">....</span><br><span class="line">&lt;SearchInfo</span><br><span class="line">	onMouseEnter=&#123;handlerMouseEnter&#125;</span><br><span class="line">	onMouseLeave=&#123;handlerMouseLeave&#125;</span><br><span class="line">&gt;</span><br><span class="line">....</span><br><span class="line"><span class="keyword">const</span> mapStateToProps=<span class="function">(<span class="params">state</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		focused:state.get(<span class="string">'header'</span>).get(<span class="string">'focused'</span>),</span><br><span class="line">		list:state.getIn([<span class="string">'header'</span>,<span class="string">'list'</span>]),</span><br><span class="line">		page:state.getIn([<span class="string">'header'</span>,<span class="string">'page'</span>]),</span><br><span class="line">		mouseIn:state.getIn([<span class="string">'header'</span>,<span class="string">'mouseIn'</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		handleInputFocus()&#123;</span><br><span class="line">			dispatch(actionCreators.getList());</span><br><span class="line">			dispatch(actionCreators.searchFocus());</span><br><span class="line">		&#125;,</span><br><span class="line">		handleInputBlur()&#123;</span><br><span class="line">			dispatch(actionCreators.searchBlur());</span><br><span class="line">		&#125;,</span><br><span class="line">		handlerMouseEnter()&#123;</span><br><span class="line">			dispatch(actionCreators.mouseEnter());</span><br><span class="line">		&#125;,</span><br><span class="line">		handlerMouseLeave()&#123;</span><br><span class="line">			dispatch(actionCreators.mouseLeave());</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mouseEnter=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:constants.MOUSE_IN</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mouseLeave=<span class="function"><span class="params">()</span>=&gt;</span>(&#123;</span><br><span class="line">    type:constants.MOUSE_OUT</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=defaultState,action)=&gt;&#123;</span><br><span class="line">	<span class="keyword">switch</span>(action.type)&#123;</span><br><span class="line">		<span class="keyword">case</span> constants.SEARCH_FOCUS:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">true</span>);</span><br><span class="line">		<span class="keyword">case</span> constants.SEARCH_BLUR:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'focused'</span>,<span class="literal">false</span>);</span><br><span class="line">		<span class="keyword">case</span> constants.CHANGE_LIST:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'list'</span>,action.data).set(<span class="string">"totalPage"</span>,action.totalPage);</span><br><span class="line">		<span class="keyword">case</span> constants.MOUSE_IN:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'mouseIn'</span>,<span class="literal">true</span>);</span><br><span class="line">		<span class="keyword">case</span> constants.MOUSE_OUT:</span><br><span class="line">			<span class="keyword">return</span> state.set(<span class="string">'mouseIn'</span>,<span class="literal">false</span>);</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">return</span> state;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后就可以对getListArea方法，foucese的判断再添加一个mouseIn了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(focused || mouseIn)&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来就可以实现点击事件了 给SearchInfoSwitch添加点击事件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;SearchInfoSwitch onClick=&#123;()=&gt;handlerChangePage(page,totalPage)&#125;&gt;换一批&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br></pre></td></tr></table></figure>
<p>其余略，同上</p>
<h6 id="3-9-3-给immutable对象修改多个属性"><a href="#3-9-3-给immutable对象修改多个属性" class="headerlink" title="3.9.3 给immutable对象修改多个属性"></a>3.9.3 给immutable对象修改多个属性</h6><p>如果给immutable修改多个属性，连续使用set会和长，这时可以使用merge代替</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">state.set(<span class="string">'list'</span>,action.data).set(<span class="string">"totalPage"</span>,action.totalPage);</span><br><span class="line"><span class="comment">//改为</span></span><br><span class="line">state.merge(&#123;</span><br><span class="line">    list:action.data,</span><br><span class="line">    totalPage:action.totalPage,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="3-10-实现刷新旋转按钮"><a href="#3-10-实现刷新旋转按钮" class="headerlink" title="3.10 实现刷新旋转按钮"></a>3.10 实现刷新旋转按钮</h4><h6 id="3-10-1-添加iconfont"><a href="#3-10-1-添加iconfont" class="headerlink" title="3.10.1 添加iconfont"></a>3.10.1 添加iconfont</h6><p>首先去<a href="www.iconfont.cn">iconfont</a>将spin按钮Tina 驾到购物车，然后将jianshu项目下的iconfont重新下载到本地。将iconfont.eot、</p>
<p>iconfont.svg、iconfont.ttf、iconfont.woff文件拷贝到我们的<code>src/statics/iconfont/</code>下，然后打开我们的iconfont.js文件，将我们解压缩文件中的iconfont.css文件将里面的内容复制到iconfont.js中，将<code>@font-face</code>中的内容替换掉，其他的不用变。</p>
<p>这样我们项目中的iconfont就替换成了最新的，对老的功能不会有影响。</p>
<p>打开<code>src/common/header/index.js</code>，在SearchInfoSwitch标签内部添加一个i 标签，写入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;SearchInfoSwitch onClick=&#123;()=&gt;handlerChangePage(page,totalPage)&#125;&gt;</span><br><span class="line">	&lt;i className='iconfont'&gt;&amp;#xe851;&lt;/i&gt;</span><br><span class="line">	换一批</span><br><span class="line">&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br></pre></td></tr></table></figure>
<p>此时看一些页面，发现改图标出现在了我们提示框的右下角，这时由于它跟上边的放大镜按钮的“靠右居下”的布局影响了，我们在<code>src/common/header/style.js</code>中可以看到SearchWrapper中所有的iconfont都是“绝对定位，居右居下”的样式修饰。我们可以把这个iconfont的样式换名为zoom，首先给放大镜的i标签中添加一个zoom属性</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;i className=&#123;focused ? 'focused iconfont zoom':'iconfont zoom'&#125;&gt;&amp;#xe6dd;&lt;/i&gt;</span><br></pre></td></tr></table></figure>
<p>然后将SearchWrapper中所有的iconfont换成zoom</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchWrapper=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float:left;</span></span><br><span class="line"><span class="string">	position:relative;</span></span><br><span class="line"><span class="string">	.zoom &#123;</span></span><br><span class="line"><span class="string">		position:absolute;</span></span><br><span class="line"><span class="string">		right:5px;</span></span><br><span class="line"><span class="string">		bottom:5px;</span></span><br><span class="line"><span class="string">		width:30px;</span></span><br><span class="line"><span class="string">		line-height:30px;</span></span><br><span class="line"><span class="string">		border-radius:15px;</span></span><br><span class="line"><span class="string">		text-align:center;</span></span><br><span class="line"><span class="string">		&amp;.focused&#123;</span></span><br><span class="line"><span class="string">			background:#777;</span></span><br><span class="line"><span class="string">			color: #fff;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>这时在看我们的刷新图标，就位于“换一批”左边了。然后我们就可以给我们的刷新图标添加一个spin的样式，在SearchInfoSwitch样式中书写改样式</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;i className='iconfont spin'&gt;&amp;#xe851;&lt;/i&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfoSwitch=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float: right;</span></span><br><span class="line"><span class="string">    font-size: 13px;</span></span><br><span class="line"><span class="string">    color: #969696;</span></span><br><span class="line"><span class="string">    background-color: transparent;</span></span><br><span class="line"><span class="string">    border-width: 0;</span></span><br><span class="line"><span class="string">    padding: 0;</span></span><br><span class="line"><span class="string">    .spin &#123;</span></span><br><span class="line"><span class="string">    	font-size:12px;</span></span><br><span class="line"><span class="string">    	margin-right:2px;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<h6 id="3-10-2-点击换一换实现图标旋转"><a href="#3-10-2-点击换一换实现图标旋转" class="headerlink" title="3.10.2 点击换一换实现图标旋转"></a>3.10.2 点击换一换实现图标旋转</h6><p>我们给spin样式一个transition动画，设置动画时间200ms，动画类型是ease-in，设置旋转角度，和旋转中心</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SearchInfoSwitch=styled.div<span class="string">`</span></span><br><span class="line"><span class="string">	float: right;</span></span><br><span class="line"><span class="string">    font-size: 13px;</span></span><br><span class="line"><span class="string">    color: #969696;</span></span><br><span class="line"><span class="string">    background-color: transparent;</span></span><br><span class="line"><span class="string">    border-width: 0;</span></span><br><span class="line"><span class="string">    padding: 0;</span></span><br><span class="line"><span class="string">    .spin &#123;</span></span><br><span class="line"><span class="string">    	display:block;</span></span><br><span class="line"><span class="string">    	float:left;</span></span><br><span class="line"><span class="string">    	font-size:12px;</span></span><br><span class="line"><span class="string">    	margin-right:2px;</span></span><br><span class="line"><span class="string">    	transition:all .2s ease-in;</span></span><br><span class="line"><span class="string">    	transform:rotate(0deg);</span></span><br><span class="line"><span class="string">    	transform-origin:center,center;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>所以当换一批被点击时，只需要让i 标签rotate的值发生变化，加360度就可以了。ref属性可以获取i 标签的真实节点给它放置一个函数;当我们的SearchInfoSwitch被点击时，会触动handlerChangePage方法，我们可以把this.spinIcon也传进去，然后就可以在handlerChangePage方法获取spin对应的dom了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;SearchInfoSwitch onClick=&#123;()=&gt;handlerChangePage(page,totalPage, <span class="keyword">this</span>.spinIcon)&#125;&gt;</span><br><span class="line">	&lt;i ref=&#123;(icon)=&gt;&#123;this.spinIcon=icon&#125;&#125; className='iconfont spin'&gt;&amp;#xe851;&lt;/i&gt;</span><br><span class="line">	换一批</span><br><span class="line">&lt;<span class="regexp">/SearchInfoSwitch&gt;</span></span><br><span class="line"><span class="regexp">。。。</span></span><br><span class="line"><span class="regexp">const mapDispatchToProps=(dispatch)=&gt;&#123;</span></span><br><span class="line"><span class="regexp">	return &#123;</span></span><br><span class="line"><span class="regexp">		...</span></span><br><span class="line"><span class="regexp">		handlerChangePage(page,totalPage,spin)&#123;</span></span><br><span class="line"><span class="regexp">			spin.style.transform="rotate(360deg)";</span></span><br><span class="line"><span class="regexp">			if(page&lt;totalPage)&#123;</span></span><br><span class="line"><span class="regexp">				dispatch(actionCreators.changePage(page+1));</span></span><br><span class="line"><span class="regexp">			&#125;else&#123;</span></span><br><span class="line"><span class="regexp">				dispatch(actionCreators.changePage(1));</span></span><br><span class="line"><span class="regexp">			&#125;</span></span><br><span class="line"><span class="regexp">		&#125;,</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这时点击换一批就有旋转效果了，不过当再次点击时就不再旋转了。有无rotate一直时360不再发生变化了。所以我们需要先看它之前的角度，然后在原油角度的基础上增加360</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">handlerChangePage(page,totalPage,spin)&#123;</span><br><span class="line">			<span class="keyword">let</span> originAngle=spin.style.transform.replace(<span class="regexp">/[^0-9]/ig</span>,<span class="string">''</span>);</span><br><span class="line">			<span class="keyword">if</span>(originAngle)&#123;</span><br><span class="line">				originAngle=<span class="built_in">parseInt</span>(originAngle,<span class="number">10</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				originAngle=<span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			spin.style.transform=<span class="string">"rotate("</span> + (originAngle+<span class="number">360</span>) + <span class="string">"deg)"</span>;</span><br><span class="line">			<span class="keyword">if</span>(page&lt;totalPage)&#123;</span><br><span class="line">				dispatch(actionCreators.changePage(page+<span class="number">1</span>));</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				dispatch(actionCreators.changePage(<span class="number">1</span>));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br></pre></td></tr></table></figure>
<h3 id="四、规避不必要的ajax请求"><a href="#四、规避不必要的ajax请求" class="headerlink" title="四、规避不必要的ajax请求"></a>四、规避不必要的ajax请求</h3><p>之前我们的代码，会在每次给搜索框聚焦时发送ajax请求，其实改请求获取一次就足够了。我门可以给handleInputFocus方法传递一个list的参数，当list大小为0时才发送请求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">render()&#123;</span><br><span class="line">		<span class="keyword">const</span> &#123;focused,handleInputFocus,handleInputBlur,list&#125;=<span class="keyword">this</span>.props;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">            ...</span><br><span class="line">			onFocus=&#123;()=&gt;handleInputFocus(list)&#125;	    	</span><br><span class="line">		)</span><br><span class="line">&#125;</span><br><span class="line">。。。</span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps=<span class="function">(<span class="params">dispatch</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		handleInputFocus(list)&#123;</span><br><span class="line">			(list.size===<span class="number">0</span>) &amp;&amp; dispatch(actionCreators.getList());</span><br><span class="line">			dispatch(actionCreators.searchFocus());</span><br><span class="line">		&#125;,</span><br><span class="line">		。。。。</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在就解决问题了。</p>
<p>接下来我们解决一个小问题，当鼠标放在SearchInfoSwitch时变成小手的样式，给SearchInfoSwitch的样式设置一个样式cursor的样式等于pointer就可以了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/18/react实战2/" data-id="ck55it3nt003mcglrb7flzrwx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/11/05/React实战3/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          React实战3
        
      </div>
    </a>
  
  
    <a href="/2018/10/18/react实战1/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">react实战1</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GIS/">GIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gradle/">Gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebAssembly/">WebAssembly</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/">sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webgl/">webgl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/GIS/" style="font-size: 11.67px;">GIS</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/JavaScript/" style="font-size: 16.67px;">JavaScript</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/React/" style="font-size: 18.33px;">React</a> <a href="/tags/SpringBoot/" style="font-size: 11.67px;">SpringBoot</a> <a href="/tags/WebAssembly/" style="font-size: 10px;">WebAssembly</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/java/" style="font-size: 13.33px;">java</a> <a href="/tags/linux/" style="font-size: 11.67px;">linux</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/sublime/" style="font-size: 10px;">sublime</a> <a href="/tags/tomcat/" style="font-size: 11.67px;">tomcat</a> <a href="/tags/webgl/" style="font-size: 15px;">webgl</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/09/js中的EventLoop/">js中的EventLoop</a>
          </li>
        
          <li>
            <a href="/2020/01/07/WebAssembly初体验/">WebAssembly初体验</a>
          </li>
        
          <li>
            <a href="/2019/12/24/webgl2基础/">webgl2基础</a>
          </li>
        
          <li>
            <a href="/2019/12/24/low-graphics-mode解决方法/">low-graphics mode解决方法</a>
          </li>
        
          <li>
            <a href="/2019/12/24/Ubuntu固定ip和软件愿/">Ubuntu固定ip和软件愿</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 杨亚辉<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>